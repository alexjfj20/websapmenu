"use strict";(self["webpackChunkwebsap"]=self["webpackChunkwebsap"]||[]).push([[987],{573:function(e,a,s){s.d(a,{A:function(){return q}});var t=s(6768),o=s(5130),r=s(4232);const l={class:"users-container"},n={class:"users-controls"},i={class:"search-container"},c={class:"filters"},u=["value"],d={class:"actions"},v={key:0,class:"loading-container"},m={key:1,class:"error-container"},p={class:"error-message"},k={key:2,class:"empty-state"},g={key:3,class:"users-table-container"},y={class:"users-table"},f={class:"roles-list"},L={class:"action-buttons"},h=["onClick"],b=["onClick"],E=["onClick"],w=["onClick"],C={class:"modal-container"},S={class:"modal-header"},D={class:"modal-body"},U={key:0,class:"alert alert-danger mb-3"},I={class:"form-group"},A={class:"form-group"},R=["disabled"],_={class:"form-group"},x={class:"form-group"},F={for:"password"},X=["required"],M={class:"form-group"},T={class:"roles-checkboxes"},P=["id","value"],K=["for"],N={key:0,class:"form-group"},$={class:"form-buttons"},z={type:"submit",class:"save-btn"};function O(e,a,s,O,Q,H){return(0,t.uX)(),(0,t.CE)("div",l,[a[37]||(a[37]=(0,t.Lk)("h2",{class:"section-title"},"Gestión de Usuarios",-1)),(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>O.searchTerm=e),placeholder:"Buscar usuario...",class:"search-input",onInput:a[1]||(a[1]=(...e)=>O.handleSearchInput&&O.handleSearchInput(...e))},null,544),[[o.Jo,O.searchTerm]])]),(0,t.Lk)("div",c,[(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>O.roleFilter=e),onChange:a[3]||(a[3]=(...e)=>O.fetchUsers&&O.fetchUsers(...e)),class:"filter-select"},[a[19]||(a[19]=(0,t.Lk)("option",{value:""},"Todos los roles",-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(O.roles,(e=>((0,t.uX)(),(0,t.CE)("option",{key:e.id,value:e.nombre},(0,r.v_)(e.nombre),9,u)))),128))],544),[[o.u1,O.roleFilter]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>O.statusFilter=e),onChange:a[5]||(a[5]=(...e)=>O.fetchUsers&&O.fetchUsers(...e)),class:"filter-select"},a[20]||(a[20]=[(0,t.Lk)("option",{value:""},"Todos los estados",-1),(0,t.Lk)("option",{value:"activo"},"Activos",-1),(0,t.Lk)("option",{value:"inactivo"},"Inactivos",-1)]),544),[[o.u1,O.statusFilter]])]),(0,t.Lk)("div",d,[(0,t.Lk)("button",{onClick:a[6]||(a[6]=(...e)=>O.showCreateForm&&O.showCreateForm(...e)),class:"create-user-btn"},a[21]||(a[21]=[(0,t.Lk)("span",{class:"btn-icon"},"➕",-1),(0,t.eW)(" Nuevo Usuario ")]))])]),O.loading?((0,t.uX)(),(0,t.CE)("div",v,a[22]||(a[22]=[(0,t.Lk)("div",{class:"spinner"},null,-1),(0,t.Lk)("p",null,"Cargando usuarios...",-1)]))):O.error?((0,t.uX)(),(0,t.CE)("div",m,[(0,t.Lk)("p",p,(0,r.v_)(O.error),1),(0,t.Lk)("button",{onClick:a[7]||(a[7]=(...e)=>O.fetchUsers&&O.fetchUsers(...e)),class:"retry-btn"},"Reintentar")])):0===O.users.length?((0,t.uX)(),(0,t.CE)("div",k,[a[23]||(a[23]=(0,t.Lk)("div",{class:"empty-icon"},"👥",-1)),a[24]||(a[24]=(0,t.Lk)("p",{class:"empty-title"},"No se encontraron usuarios",-1)),a[25]||(a[25]=(0,t.Lk)("p",{class:"empty-description"},"No hay usuarios que coincidan con los criterios de búsqueda",-1)),(0,t.Lk)("button",{onClick:a[8]||(a[8]=(...e)=>O.resetFilters&&O.resetFilters(...e)),class:"reset-filters-btn"},"Limpiar filtros")])):((0,t.uX)(),(0,t.CE)("div",g,[(0,t.Lk)("table",y,[a[30]||(a[30]=(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"Nombre"),(0,t.Lk)("th",null,"Email"),(0,t.Lk)("th",null,"Teléfono"),(0,t.Lk)("th",null,"Rol"),(0,t.Lk)("th",null,"Estado"),(0,t.Lk)("th",null,"Fecha de registro"),(0,t.Lk)("th",null,"Acciones")])],-1)),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(O.users,(e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.id,class:(0,r.C4)({"inactive-user":"inactivo"===e.estado})},[(0,t.Lk)("td",null,(0,r.v_)(e.nombre),1),(0,t.Lk)("td",null,(0,r.v_)(e.email),1),(0,t.Lk)("td",null,(0,r.v_)(e.telefono||"-"),1),(0,t.Lk)("td",null,[(0,t.Lk)("div",f,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.roles,((e,a)=>((0,t.uX)(),(0,t.CE)("span",{key:a,class:(0,r.C4)(["role-badge",{"admin-role":"Administrador"===e,"superadmin-role":"Superadministrador"===e}])},(0,r.v_)(e),3)))),128))])]),(0,t.Lk)("td",null,[(0,t.Lk)("span",{class:(0,r.C4)(["status-badge","activo"===e.estado?"active-status":"inactive-status"])},(0,r.v_)("activo"===e.estado?"Activo":"Inactivo"),3)]),(0,t.Lk)("td",null,(0,r.v_)(O.formatDate(e.fecha_creacion)),1),(0,t.Lk)("td",null,[(0,t.Lk)("div",L,[(0,t.Lk)("button",{onClick:a=>O.editUser(e),class:"edit-btn",title:"Editar"},a[26]||(a[26]=[(0,t.Lk)("span",{class:"btn-icon"},"✏️",-1)]),8,h),"activo"===e.estado?((0,t.uX)(),(0,t.CE)("button",{key:0,onClick:a=>O.deactivateUser(e),class:"deactivate-btn",title:"Desactivar"},a[27]||(a[27]=[(0,t.Lk)("span",{class:"btn-icon"},"🔴",-1)]),8,b)):((0,t.uX)(),(0,t.CE)("button",{key:1,onClick:a=>O.activateUser(e),class:"activate-btn",title:"Activar"},a[28]||(a[28]=[(0,t.Lk)("span",{class:"btn-icon"},"🟢",-1)]),8,E)),(0,t.Lk)("button",{onClick:a=>O.deleteUser(e),class:"delete-btn",title:"Eliminar"},a[29]||(a[29]=[(0,t.Lk)("span",{class:"btn-icon"},"❌",-1)]),8,w)])])],2)))),128))])])])),O.showModal?((0,t.uX)(),(0,t.CE)("div",{key:4,class:"modal-overlay",onClick:a[18]||(a[18]=(0,o.D$)(((...e)=>O.closeModal&&O.closeModal(...e)),["self"]))},[(0,t.Lk)("div",C,[(0,t.Lk)("div",S,[(0,t.Lk)("h3",null,(0,r.v_)(O.isEditing?"Editar Usuario":"Crear Nuevo Usuario"),1),(0,t.Lk)("button",{onClick:a[9]||(a[9]=(...e)=>O.closeModal&&O.closeModal(...e)),class:"close-btn"},"×")]),(0,t.Lk)("div",D,[O.error?((0,t.uX)(),(0,t.CE)("div",U,(0,r.v_)(O.error),1)):(0,t.Q3)("",!0),(0,t.Lk)("form",{onSubmit:a[17]||(a[17]=(0,o.D$)(((...e)=>O.saveUser&&O.saveUser(...e)),["prevent"])),class:"user-form"},[(0,t.Lk)("div",I,[a[31]||(a[31]=(0,t.Lk)("label",{for:"nombre"},"Nombre completo",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"nombre","onUpdate:modelValue":a[10]||(a[10]=e=>O.formData.nombre=e),required:"",placeholder:"Ej: Juan Pérez"},null,512),[[o.Jo,O.formData.nombre]])]),(0,t.Lk)("div",A,[a[32]||(a[32]=(0,t.Lk)("label",{for:"email"},"Correo electrónico",-1)),(0,t.bo)((0,t.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":a[11]||(a[11]=e=>O.formData.email=e),required:"",placeholder:"ejemplo@correo.com",disabled:O.isEditing},null,8,R),[[o.Jo,O.formData.email]])]),(0,t.Lk)("div",_,[a[33]||(a[33]=(0,t.Lk)("label",{for:"telefono"},"Teléfono",-1)),(0,t.bo)((0,t.Lk)("input",{type:"tel",id:"telefono","onUpdate:modelValue":a[12]||(a[12]=e=>O.formData.telefono=e),placeholder:"Ej: 3001234567"},null,512),[[o.Jo,O.formData.telefono]])]),(0,t.Lk)("div",x,[(0,t.Lk)("label",F,"Contraseña "+(0,r.v_)(O.isEditing?"(dejar en blanco para mantener actual)":""),1),(0,t.bo)((0,t.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":a[13]||(a[13]=e=>O.formData.password=e),required:!O.isEditing,placeholder:"Contraseña segura",autocomplete:"new-password"},null,8,X),[[o.Jo,O.formData.password]])]),(0,t.Lk)("div",M,[a[34]||(a[34]=(0,t.Lk)("label",null,"Roles",-1)),(0,t.Lk)("div",T,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(O.availableRoles,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"role-checkbox"},[(0,t.bo)((0,t.Lk)("input",{type:"checkbox",id:"role-"+e.id,value:e.nombre,"onUpdate:modelValue":a[14]||(a[14]=e=>O.formData.roles=e)},null,8,P),[[o.lH,O.formData.roles]]),(0,t.Lk)("label",{for:"role-"+e.id},(0,r.v_)(e.nombre),9,K)])))),128))])]),O.isEditing?((0,t.uX)(),(0,t.CE)("div",N,[a[36]||(a[36]=(0,t.Lk)("label",{for:"estado"},"Estado",-1)),(0,t.bo)((0,t.Lk)("select",{id:"estado","onUpdate:modelValue":a[15]||(a[15]=e=>O.formData.estado=e)},a[35]||(a[35]=[(0,t.Lk)("option",{value:"activo"},"Activo",-1),(0,t.Lk)("option",{value:"inactivo"},"Inactivo",-1)]),512),[[o.u1,O.formData.estado]])])):(0,t.Q3)("",!0),(0,t.Lk)("div",$,[(0,t.Lk)("button",{type:"button",onClick:a[16]||(a[16]=(...e)=>O.closeModal&&O.closeModal(...e)),class:"cancel-btn"},"Cancelar"),(0,t.Lk)("button",z,(0,r.v_)(O.isEditing?"Actualizar":"Crear"),1)])],32)])])])):(0,t.Q3)("",!0)])}s(8111),s(2489);var Q=s(144),H=s(4887),W=s(3444),B=s(981),V={name:"AdminUsers",emits:["user-created"],setup(e,{emit:a}){const s=(0,Q.KR)([]),o=(0,Q.KR)([]),r=(0,Q.KR)([]),l=(0,Q.KR)(!0),n=(0,Q.KR)(null),i=(0,Q.KR)(""),c=(0,Q.KR)(""),u=(0,Q.KR)(""),d=(0,Q.KR)(!1),v=(0,Q.KR)(!1),m=(0,Q.KR)({id:null,nombre:"",email:"",telefono:"",password:"",roles:[],estado:"activo"}),{lo:p,O0:k,kg:g,TK:y,U1:f,hG:L}=W;let h=null;const b=(0,t.EW)((()=>(0,B.hf)("Administrador")&&!(0,B.hf)("Superadministrador"))),E=(0,t.EW)((()=>(0,B.hf)("Superadministrador"))),w=(0,t.EW)((()=>b.value?r.value.filter((e=>"Empleado"===e.nombre)):r.value)),C=(0,t.EW)((()=>{const e=(0,B.HW)();return s.value.filter((a=>{if(e&&a.email===e.email)return!0;if("superadmin@example.com"===a.email&&!E.value)return!1;if(b.value&&a.roles&&Array.isArray(a.roles)&&a.roles.includes("Superadministrador"))return!1;if(c.value&&(!a.roles||!a.roles.includes(c.value)))return!1;if(u.value&&a.estado!==u.value)return!1;if(i.value&&i.value.length>=2){const e=i.value.toLowerCase(),s=a.nombre&&a.nombre.toLowerCase().includes(e),t=a.email&&a.email.toLowerCase().includes(e);return s||t}return!0}))}));(0,t.sV)((async()=>{try{console.log("AdminUsers componente montado - inicializando..."),s.value=[],o.value=[],await Promise.all([S(),D()]),console.log("Inicialización completa, usuarios cargados:",o.value.length)}catch(e){console.error("Error durante la inicialización:",e),n.value=`Error durante la inicialización: ${e.message}`}}));const S=async()=>{try{l.value=!0,n.value="",s.value=[],o.value=[];try{console.log("Obteniendo usuarios con filtros:",{searchTerm:i.value,role:c.value,status:u.value});const e=await p({searchTerm:i.value,role:c.value,status:u.value});if(e&&e.success)return console.log(`Recibidos ${e.data.length} usuarios de la API`),s.value=e.data,void(o.value=C.value);throw console.warn("Respuesta no exitosa de la API o formato incorrecto:",e),new Error(e?.message||"Error al cargar usuarios")}catch(e){throw console.error("Error al llamar a la API:",e),e}}catch(a){console.error("Error general al cargar usuarios:",a),n.value=`Error al cargar usuarios: ${a.message||"Error desconocido"}`,s.value=[],o.value=[]}finally{l.value=!1}},D=async()=>{try{try{const e=await k();if(e&&e.success)return void(r.value=Array.isArray(e.data)?e.data:[]);throw console.warn("Respuesta no exitosa de la API de roles:",e),new Error(e?.message||"Error al cargar roles")}catch(e){console.error("Error al llamar a la API de roles:",e),r.value=[{id:1,nombre:"Superadministrador",descripcion:"Control total del sistema"},{id:2,nombre:"Administrador",descripcion:"Gestión de usuarios y configuración"},{id:3,nombre:"Empleado",descripcion:"Operaciones básicas"}],console.log("Usando roles básicos para mantener la funcionalidad:",r.value.length)}}catch(a){console.error("Error general al cargar roles:",a),r.value=[{id:1,nombre:"Superadministrador"},{id:2,nombre:"Administrador"},{id:3,nombre:"Empleado"}]}},U=()=>{clearTimeout(h),h=setTimeout((()=>{(""===i.value||i.value.length>=2)&&S()}),300)},I=()=>{i.value="",c.value="",u.value="",S()},A=()=>{v.value=!1,m.value={id:null,nombre:"",email:"",telefono:"",password:"",roles:["Empleado"],estado:"activo"},d.value=!0},R=e=>{b.value&&e.roles&&Array.isArray(e.roles)&&e.roles.includes("Superadministrador")?(0,H.xE)("No tienes permisos para editar usuarios con rol de Superadministrador"):(v.value=!0,m.value={id:e.id,nombre:e.nombre,email:e.email,telefono:e.telefono||"",password:"",roles:[...e.roles],estado:e.estado},d.value=!0)},_=async()=>{try{if(l.value=!0,n.value="",!m.value.roles.length)return await(0,H.xE)("Debe seleccionar al menos un rol para el usuario"),void(l.value=!1);if(b.value&&(m.value.roles=m.value.roles.filter((e=>"Empleado"===e)),0===m.value.roles.length&&(m.value.roles=["Empleado"])),v.value){const e={nombre:m.value.nombre,telefono:m.value.telefono,roles:m.value.roles,estado:m.value.estado};m.value.password&&(e.password=m.value.password);const a=await y(m.value.id,e);if(!a||!a.success)throw new Error(a?.message||"Error al actualizar usuario");{await(0,H.xE)(a.message||"Usuario actualizado exitosamente");const t=s.value.findIndex((e=>e.id===m.value.id));-1!==t?(s.value[t]={...s.value[t],...e},o.value=C.value):await S()}}else{const t={nombre:m.value.nombre,email:m.value.email,password:m.value.password,telefono:m.value.telefono,roles:m.value.roles,fecha_creacion:(new Date).toISOString()};try{console.log("Llamando a createUser con:",t);const e=await g(t);if(!e||!e.success)throw new Error(e?.message||"Error al crear usuario");if(await(0,H.xE)(e.message||"Usuario creado exitosamente"),d.value=!1,e.data){const a={...e.data,fecha_creacion:e.data.fecha_creacion||(new Date).toISOString()};s.value=[a,...s.value],o.value=C.value}else await S();a("user-created")}catch(e){console.error("Error al crear usuario:",e),n.value=e.message||"Error al crear usuario"}}}catch(t){console.error("Error al guardar el usuario:",t),n.value=t.message||"Error al guardar el usuario"}finally{l.value=!1}},x=async e=>{if(b.value&&e.roles&&Array.isArray(e.roles)&&e.roles.includes("Superadministrador"))(0,H.xE)("No tienes permisos para modificar usuarios con rol de Superadministrador");else try{const a=await(0,H.lJ)(`¿Estás seguro de que deseas activar el usuario ${e.nombre}?`,{title:"Confirmar activación",confirmText:"Activar",cancelText:"Cancelar"});if(a){l.value=!0,console.log(`Activando usuario con ID: ${e.id}`);const a=await f(e.id,"activo");if(!a||!a.success)throw new Error(a?.message||"Error al activar usuario");{await(0,H.xE)(a.message||"Usuario activado exitosamente");const t=s.value.findIndex((a=>a.id===e.id));-1!==t&&(s.value[t].estado="activo",o.value=C.value)}}}catch(a){console.error("Error al activar usuario:",a),await(0,H.xE)(`Error al activar usuario: ${a.message||"Error desconocido"}`)}finally{l.value=!1}},F=async e=>{if(b.value&&e.roles&&Array.isArray(e.roles)&&e.roles.includes("Superadministrador"))(0,H.xE)("No tienes permisos para modificar usuarios con rol de Superadministrador");else try{const a=await(0,H.lJ)(`¿Estás seguro de que deseas desactivar el usuario ${e.nombre}? No podrá acceder al sistema mientras esté inactivo.`,{title:"Confirmar desactivación"});if(a){l.value=!0,console.log(`Desactivando usuario con ID: ${e.id}`);const a=await f(e.id,"inactivo");if(!a||!a.success)throw new Error(a?.message||"Error al desactivar usuario");{await(0,H.xE)(a.message||"Usuario desactivado exitosamente");const t=s.value.findIndex((a=>a.id===e.id));-1!==t&&(s.value[t].estado="inactivo",o.value=C.value)}}}catch(a){console.error("Error al desactivar usuario:",a),await(0,H.xE)(`Error al desactivar usuario: ${a.message||"Error desconocido"}`)}finally{l.value=!1}},X=async e=>{if(b.value&&e.roles&&Array.isArray(e.roles)&&e.roles.includes("Superadministrador"))(0,H.xE)("No tienes permisos para eliminar usuarios con rol de Superadministrador");else try{const a=await(0,H.lJ)(`¿Estás seguro de que deseas eliminar permanentemente el usuario ${e.nombre}? Esta acción no se puede deshacer.`,{title:"Confirmar eliminación",confirmText:"Eliminar",cancelText:"Cancelar"});if(a){l.value=!0,console.log(`Eliminando usuario con ID: ${e.id}`);const a=await L(e.id);if(!a||!a.success)throw new Error(a?.message||"Error al eliminar usuario");await(0,H.xE)(a.message||"Usuario eliminado exitosamente"),s.value=s.value.filter((a=>a.id!==e.id)),o.value=C.value}}catch(a){console.error("Error al eliminar usuario:",a),await(0,H.xE)(`Error al eliminar usuario: ${a.message||"Error desconocido"}`)}finally{l.value=!1}},M=()=>{d.value=!1},T=e=>{e||(e=(new Date).toISOString());try{const a=new Date(e);return isNaN(a.getTime())?"Fecha inválida":new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch(a){return"Fecha inválida"}};return{users:o,roles:r,loading:l,error:n,searchTerm:i,roleFilter:c,statusFilter:u,showModal:d,isEditing:v,formData:m,fetchUsers:S,handleSearchInput:U,resetFilters:I,showCreateForm:A,editUser:R,saveUser:_,activateUser:x,deactivateUser:F,deleteUser:X,closeModal:M,formatDate:T,availableRoles:w,isOnlyAdmin:b,filteredUsers:C}}},j=s(1241);const J=(0,j.A)(V,[["render",O],["__scopeId","data-v-a39eb1fc"]]);var q=J},1874:function(e,a,s){s.d(a,{A:function(){return K}});var t=s(6768),o=s(4232),r=s(5130);const l={class:"backups-container"},n={class:"backups-actions"},i=["disabled"],c={key:0},u={key:1},d={key:0,class:"loading-container"},v={key:1,class:"empty-state"},m={key:2,class:"backups-grid"},p={class:"backup-info"},k={class:"backup-date"},g={class:"backup-size"},y={class:"backup-actions"},f=["onClick","disabled"],L={key:0},h={key:1},b=["onClick"],E=["onClick","disabled"],w={key:0},C={key:1},S={class:"modal-container"},D={class:"modal-header"},U={class:"modal-footer"};function I(e,a,s,I,A,R){return(0,t.uX)(),(0,t.CE)("div",l,[a[12]||(a[12]=(0,t.Lk)("h2",{class:"section-title"},"Gestión de Respaldos",-1)),(0,t.Lk)("div",n,[(0,t.Lk)("button",{onClick:a[0]||(a[0]=(...e)=>I.createNewBackup&&I.createNewBackup(...e)),class:"create-backup-btn",disabled:I.creating},[I.creating?((0,t.uX)(),(0,t.CE)("span",c,a[5]||(a[5]=[(0,t.Lk)("span",{class:"loading-spinner"},null,-1),(0,t.eW)(" Creando respaldo... ")]))):((0,t.uX)(),(0,t.CE)("span",u,a[6]||(a[6]=[(0,t.Lk)("span",{class:"action-icon"},"💾",-1),(0,t.eW)(" Crear respaldo ahora ")])))],8,i)]),I.loading?((0,t.uX)(),(0,t.CE)("div",d,a[7]||(a[7]=[(0,t.Lk)("div",{class:"spinner"},null,-1),(0,t.Lk)("p",null,"Cargando respaldos...",-1)]))):0===I.backups.length?((0,t.uX)(),(0,t.CE)("div",v,a[8]||(a[8]=[(0,t.Lk)("div",{class:"empty-icon"},"📂",-1),(0,t.Lk)("p",null,"No hay respaldos disponibles",-1),(0,t.Lk)("p",{class:"empty-desc"},'Crea tu primer respaldo haciendo clic en el botón "Crear respaldo ahora"',-1)]))):((0,t.uX)(),(0,t.CE)("div",m,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(I.backups,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"backup-card"},[a[9]||(a[9]=(0,t.Lk)("div",{class:"backup-icon"},"💾",-1)),(0,t.Lk)("div",p,[(0,t.Lk)("h3",null,(0,o.v_)(e.archivo),1),(0,t.Lk)("p",k,"Fecha: "+(0,o.v_)(I.formatDate(e.fecha)),1),(0,t.Lk)("p",g,"Tamaño: "+(0,o.v_)(e.tamano),1)]),(0,t.Lk)("div",y,[(0,t.Lk)("button",{onClick:a=>I.restoreBackup(e),class:"restore-btn",disabled:I.restoring===e.id},[I.restoring===e.id?((0,t.uX)(),(0,t.CE)("span",L,"Restaurando...")):((0,t.uX)(),(0,t.CE)("span",h,"Restaurar"))],8,f),(0,t.Lk)("button",{onClick:a=>I.downloadBackup(e),class:"download-btn"},"Descargar",8,b),(0,t.Lk)("button",{onClick:a=>I.deleteBackup(e),class:"delete-btn",disabled:I.deleting===e.id},[I.deleting===e.id?((0,t.uX)(),(0,t.CE)("span",w,"Eliminando...")):((0,t.uX)(),(0,t.CE)("span",C,"Eliminar"))],8,E)])])))),128))])),I.showRestoreModal?((0,t.uX)(),(0,t.CE)("div",{key:3,class:"modal-overlay",onClick:a[4]||(a[4]=(0,r.D$)(((...e)=>I.cancelRestore&&I.cancelRestore(...e)),["self"]))},[(0,t.Lk)("div",S,[(0,t.Lk)("div",D,[a[10]||(a[10]=(0,t.Lk)("h3",null,"Confirmar restauración",-1)),(0,t.Lk)("button",{onClick:a[1]||(a[1]=(...e)=>I.cancelRestore&&I.cancelRestore(...e)),class:"close-btn"},"×")]),a[11]||(a[11]=(0,t.Lk)("div",{class:"modal-body"},[(0,t.Lk)("p",{class:"warning-text"},[(0,t.Lk)("span",{class:"warning-icon"},"⚠️"),(0,t.eW)(" Estás a punto de restaurar el sistema a partir del respaldo seleccionado. Esta acción sobrescribirá los datos actuales. ")]),(0,t.Lk)("p",null,"¿Estás seguro de que deseas continuar?")],-1)),(0,t.Lk)("div",U,[(0,t.Lk)("button",{onClick:a[2]||(a[2]=(...e)=>I.cancelRestore&&I.cancelRestore(...e)),class:"cancel-btn"},"Cancelar"),(0,t.Lk)("button",{onClick:a[3]||(a[3]=(...e)=>I.confirmRestore&&I.confirmRestore(...e)),class:"confirm-btn"},"Confirmar restauración")])])])):(0,t.Q3)("",!0)])}s(8111),s(2489);var A=s(144);async function R(){return new Promise((e=>{setTimeout((()=>{e({success:!0,data:[{id:1,fecha:(new Date).toISOString(),archivo:"backup_"+F(new Date)+".zip",tamano:"2.5 MB"},{id:2,fecha:new Date(Date.now()-864e5).toISOString(),archivo:"backup_"+F(new Date(Date.now()-864e5))+".zip",tamano:"2.3 MB"},{id:3,fecha:new Date(Date.now()-6048e5).toISOString(),archivo:"backup_"+F(new Date(Date.now()-6048e5))+".zip",tamano:"2.1 MB"}]})}),1e3)}))}async function _(){return new Promise((e=>{setTimeout((()=>{const a=new Date;e({success:!0,data:{id:Date.now(),fecha:a.toISOString(),archivo:"backup_"+F(a)+".zip",tamano:"2.4 MB"},message:"Respaldo creado exitosamente"})}),2e3)}))}async function x(e){return new Promise((e=>{setTimeout((()=>{e({success:!0,message:"Respaldo eliminado exitosamente"})}),1e3)}))}function F(e){const a=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0"),l=String(e.getSeconds()).padStart(2,"0");return`${a}${s}${t}_${o}${r}${l}`}var X=s(4887),M={name:"AdminBackups",setup(){const e=(0,A.KR)([]),a=(0,A.KR)(!0),s=(0,A.KR)(!1),o=(0,A.KR)(null),r=(0,A.KR)(null),l=(0,A.KR)(null),n=(0,A.KR)(!1);(0,t.sV)((async()=>{await i()}));const i=async()=>{try{a.value=!0;const s=await R();if(!s||!s.success)throw new Error("Error al cargar respaldos");e.value=s.data||[],e.value.sort(((e,a)=>new Date(a.fecha)-new Date(e.fecha)))}catch(s){console.error("Error al obtener respaldos:",s),await(0,X.xE)("Error al cargar los respaldos: "+(s.message||"Error desconocido"))}finally{a.value=!1}},c=e=>{if(!e)return"N/A";try{const a=new Date(e);return isNaN(a.getTime())?"Fecha inválida":new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(a)}catch(a){return"Fecha inválida"}},u=async()=>{try{s.value=!0;const a=await _();if(!a||!a.success)throw new Error("Error al crear el respaldo");e.value.unshift(a.data),await(0,X.xE)("Respaldo creado correctamente")}catch(a){console.error("Error al crear respaldo:",a),await(0,X.xE)("Error al crear respaldo: "+(a.message||"Error desconocido"))}finally{s.value=!1}},d=e=>{l.value=e,n.value=!0},v=()=>{n.value=!1,l.value=null},m=async()=>{try{if(!l.value)return;n.value=!1,o.value=l.value.id;const e=await d(l.value.id);if(!e||!e.success)throw new Error("Error al restaurar el respaldo");await(0,X.xE)("Respaldo restaurado correctamente. Se recargará la página para aplicar los cambios."),window.location.reload()}catch(e){console.error("Error al restaurar respaldo:",e),await(0,X.xE)("Error al restaurar respaldo: "+(e.message||"Error desconocido"))}finally{o.value=null,l.value=null}},p=async e=>{try{const a=document.createElement("a");a.setAttribute("href","data:application/zip;charset=utf-8,"+encodeURIComponent("Contenido simulado de respaldo")),a.setAttribute("download",e.archivo),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),await(0,X.xE)("Respaldo descargado correctamente")}catch(a){console.error("Error al descargar respaldo:",a),await(0,X.xE)("Error al descargar respaldo: "+(a.message||"Error desconocido"))}},k=async a=>{try{const s=await(0,X.lJ)(`¿Estás seguro de eliminar el respaldo "${a.archivo}"?`,{title:"Confirmar eliminación",confirmText:"Eliminar",cancelText:"Cancelar"});if(s){r.value=a.id;const s=await x(a.id);if(!s||!s.success)throw new Error("Error al eliminar el respaldo");e.value=e.value.filter((e=>e.id!==a.id)),await(0,X.xE)("Respaldo eliminado correctamente")}}catch(s){console.error("Error al eliminar respaldo:",s),await(0,X.xE)("Error al eliminar respaldo: "+(s.message||"Error desconocido"))}finally{r.value=null}};return{backups:e,loading:a,creating:s,restoring:o,deleting:r,selectedBackup:l,showRestoreModal:n,formatDate:c,createNewBackup:u,restoreBackup:d,cancelRestore:v,confirmRestore:m,downloadBackup:p,deleteBackup:k}}},T=s(1241);const P=(0,T.A)(M,[["render",I],["__scopeId","data-v-1ca49867"]]);var K=P},2346:function(e,a,s){s.d(a,{A:function(){return G}});var t=s(6768),o=s(5130),r=s(4232);const l={class:"inventory-container"},n={class:"inventory-controls"},i={class:"search-container"},c={class:"filters"},u={class:"actions"},d={key:0,class:"loading-container"},v={key:1,class:"error-container"},m={class:"error-message"},p={key:2,class:"empty-state"},k={key:3,class:"inventory-table-container"},g={class:"inventory-table"},y={class:"actions-cell"},f=["onClick"],L=["onClick"],h={key:4,class:"modal-overlay"},b={class:"modal-container"},E={class:"modal-header"},w={class:"modal-body"},C={class:"form-group"},S={class:"form-group"},D={class:"modal-footer"},U=["disabled"],I={key:0},A={key:1},R={key:5,class:"modal-overlay"},_={class:"modal-container history-modal"},x={class:"modal-header"},F={class:"modal-body"},X={key:0,class:"empty-history"},M={key:1,class:"history-list"},T={class:"history-date"},P={class:"history-details"},K={class:"history-quantity"},N={class:"history-stock"},$={class:"history-reason"},z={class:"history-user"},O={class:"modal-footer"};function Q(e,a,s,Q,H,W){return(0,t.uX)(),(0,t.CE)("div",l,[a[27]||(a[27]=(0,t.Lk)("h2",{class:"section-title"},"Gestión de Inventario",-1)),(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>Q.searchTerm=e),placeholder:"Buscar producto...",class:"search-input",onInput:a[1]||(a[1]=(...e)=>Q.handleSearchInput&&Q.handleSearchInput(...e))},null,544),[[o.Jo,Q.searchTerm]])]),(0,t.Lk)("div",c,[(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>Q.stockFilter=e),onChange:a[3]||(a[3]=(...e)=>Q.applyFilters&&Q.applyFilters(...e)),class:"filter-select"},a[15]||(a[15]=[(0,t.Lk)("option",{value:"all"},"Todos los productos",-1),(0,t.Lk)("option",{value:"low"},"Stock bajo",-1),(0,t.Lk)("option",{value:"out"},"Sin stock",-1)]),544),[[o.u1,Q.stockFilter]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>Q.categoryFilter=e),onChange:a[5]||(a[5]=(...e)=>Q.applyFilters&&Q.applyFilters(...e)),class:"filter-select"},a[16]||(a[16]=[(0,t.Lk)("option",{value:""},"Todas las categorías",-1),(0,t.Lk)("option",{value:"con_refresco"},"Con refresco",-1),(0,t.Lk)("option",{value:"sin_refresco"},"Sin refresco",-1)]),544),[[o.u1,Q.categoryFilter]])]),(0,t.Lk)("div",u,[(0,t.Lk)("button",{onClick:a[6]||(a[6]=(...e)=>Q.refreshInventory&&Q.refreshInventory(...e)),class:"refresh-btn"},a[17]||(a[17]=[(0,t.Lk)("span",{class:"btn-icon"},"🔄",-1),(0,t.eW)(" Actualizar ")]))])]),Q.loading?((0,t.uX)(),(0,t.CE)("div",d,a[18]||(a[18]=[(0,t.Lk)("div",{class:"spinner"},null,-1),(0,t.Lk)("p",null,"Cargando inventario...",-1)]))):Q.error?((0,t.uX)(),(0,t.CE)("div",v,[(0,t.Lk)("p",m,(0,r.v_)(Q.error),1),(0,t.Lk)("button",{onClick:a[7]||(a[7]=(...e)=>Q.loadInventory&&Q.loadInventory(...e)),class:"retry-btn"},"Reintentar")])):0===Q.filteredProducts.length?((0,t.uX)(),(0,t.CE)("div",p,a[19]||(a[19]=[(0,t.Lk)("div",{class:"empty-icon"},"📦",-1),(0,t.Lk)("p",null,"No se encontraron productos",-1),(0,t.Lk)("p",{class:"empty-desc"},"Intenta cambiar los filtros de búsqueda o agrega nuevos productos al inventario",-1)]))):((0,t.uX)(),(0,t.CE)("div",k,[(0,t.Lk)("table",g,[a[20]||(a[20]=(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"Nombre"),(0,t.Lk)("th",null,"Categoría"),(0,t.Lk)("th",null,"Stock Actual"),(0,t.Lk)("th",null,"Estado"),(0,t.Lk)("th",null,"Última Actualización"),(0,t.Lk)("th",null,"Acciones")])],-1)),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Q.filteredProducts,(e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.id,class:(0,r.C4)(Q.getRowClass(e))},[(0,t.Lk)("td",null,(0,r.v_)(e.name),1),(0,t.Lk)("td",null,(0,r.v_)(e.includesDrink?"Con refresco":"Sin refresco"),1),(0,t.Lk)("td",null,(0,r.v_)(e.availableQuantity),1),(0,t.Lk)("td",null,[(0,t.Lk)("span",{class:(0,r.C4)(Q.getStatusClass(e))},(0,r.v_)(Q.getStatusText(e)),3)]),(0,t.Lk)("td",null,(0,r.v_)(Q.formatDate(e.lastUpdated)),1),(0,t.Lk)("td",y,[(0,t.Lk)("button",{onClick:a=>Q.openUpdateStockModal(e),class:"update-btn",title:"Actualizar stock"}," 📝 ",8,f),(0,t.Lk)("button",{onClick:a=>Q.openHistoryModal(e),class:"history-btn",title:"Ver historial"}," 📋 ",8,L)])],2)))),128))])])])),Q.showUpdateModal?((0,t.uX)(),(0,t.CE)("div",h,[(0,t.Lk)("div",b,[(0,t.Lk)("div",E,[a[21]||(a[21]=(0,t.Lk)("h3",null,"Actualizar Stock",-1)),(0,t.Lk)("button",{onClick:a[8]||(a[8]=(...e)=>Q.closeUpdateModal&&Q.closeUpdateModal(...e)),class:"close-btn"},"×")]),(0,t.Lk)("div",w,[(0,t.Lk)("p",null,[a[22]||(a[22]=(0,t.Lk)("strong",null,"Producto:",-1)),(0,t.eW)(" "+(0,r.v_)(Q.selectedProduct?.name),1)]),(0,t.Lk)("p",null,[a[23]||(a[23]=(0,t.Lk)("strong",null,"Stock actual:",-1)),(0,t.eW)(" "+(0,r.v_)(Q.selectedProduct?.availableQuantity||0),1)]),(0,t.Lk)("div",C,[a[24]||(a[24]=(0,t.Lk)("label",{for:"newStock"},"Nuevo stock:",-1)),(0,t.bo)((0,t.Lk)("input",{type:"number",id:"newStock","onUpdate:modelValue":a[9]||(a[9]=e=>Q.updateStockForm.newQuantity=e),min:"0",class:"form-input"},null,512),[[o.Jo,Q.updateStockForm.newQuantity]])]),(0,t.Lk)("div",S,[a[25]||(a[25]=(0,t.Lk)("label",{for:"reason"},"Motivo del ajuste:",-1)),(0,t.bo)((0,t.Lk)("textarea",{id:"reason","onUpdate:modelValue":a[10]||(a[10]=e=>Q.updateStockForm.reason=e),class:"form-textarea",placeholder:"Explique el motivo del ajuste de inventario"},null,512),[[o.Jo,Q.updateStockForm.reason]])])]),(0,t.Lk)("div",D,[(0,t.Lk)("button",{onClick:a[11]||(a[11]=(...e)=>Q.closeUpdateModal&&Q.closeUpdateModal(...e)),class:"cancel-btn"},"Cancelar"),(0,t.Lk)("button",{onClick:a[12]||(a[12]=(...e)=>Q.updateStock&&Q.updateStock(...e)),class:"save-btn",disabled:Q.updateStockForm.isUpdating},[Q.updateStockForm.isUpdating?((0,t.uX)(),(0,t.CE)("span",I,"Actualizando...")):((0,t.uX)(),(0,t.CE)("span",A,"Guardar Cambios"))],8,U)])])])):(0,t.Q3)("",!0),Q.showHistoryModal?((0,t.uX)(),(0,t.CE)("div",R,[(0,t.Lk)("div",_,[(0,t.Lk)("div",x,[(0,t.Lk)("h3",null,"Historial de "+(0,r.v_)(Q.selectedProduct?.name),1),(0,t.Lk)("button",{onClick:a[13]||(a[13]=(...e)=>Q.closeHistoryModal&&Q.closeHistoryModal(...e)),class:"close-btn"},"×")]),(0,t.Lk)("div",F,[0===Q.productHistory.length?((0,t.uX)(),(0,t.CE)("div",X,a[26]||(a[26]=[(0,t.Lk)("p",null,"No hay registros de movimientos para este producto.",-1)]))):((0,t.uX)(),(0,t.CE)("div",M,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Q.productHistory,((e,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"history-item"},[(0,t.Lk)("div",T,(0,r.v_)(Q.formatDate(e.date)),1),(0,t.Lk)("div",P,[(0,t.Lk)("span",{class:(0,r.C4)(["history-type",e.type])},(0,r.v_)("increase"===e.type?"Incremento":"decrease"===e.type?"Reducción":"Ajuste"),3),(0,t.Lk)("span",K,(0,r.v_)("increase"===e.type?"+":"")+(0,r.v_)(e.change),1),(0,t.Lk)("span",N," Stock resultante: "+(0,r.v_)(e.newQuantity),1)]),(0,t.Lk)("div",$,(0,r.v_)(e.reason||"Sin motivo especificado"),1),(0,t.Lk)("div",z," Por: "+(0,r.v_)(e.userName||"Sistema"),1)])))),128))]))]),(0,t.Lk)("div",O,[(0,t.Lk)("button",{onClick:a[14]||(a[14]=(...e)=>Q.closeHistoryModal&&Q.closeHistoryModal(...e)),class:"cancel-btn"},"Cerrar")])])])):(0,t.Q3)("",!0)])}s(4114),s(8111),s(2489),s(1701);var H=s(144),W=s(3444),B=s(4887),V=s(981),j={name:"AdminInventory",setup(){const e=(0,H.KR)([]),a=(0,H.KR)(!0),s=(0,H.KR)(null),o=(0,H.KR)(""),r=(0,H.KR)("all"),l=(0,H.KR)(""),n=(0,H.KR)(!1),i=(0,H.KR)(!1),c=(0,H.KR)(null),u=(0,H.KR)([]),d=(0,H.KR)({newQuantity:0,reason:"",isUpdating:!1});(0,t.sV)((()=>{v()}));const v=async()=>{try{a.value=!0,s.value=null;const t=await(0,W.gL)();if(!t.success)throw new Error(t.message||"Error al cargar el inventario");e.value=t.data.map((e=>({...e,availableQuantity:e.availableQuantity||0,lastUpdated:e.lastUpdated||(new Date).toISOString(),stockHistory:e.stockHistory||[]}))),console.log("Inventario cargado:",e.value)}catch(t){console.error("Error al cargar inventario:",t),s.value=`Error al cargar inventario: ${t.message||"Error desconocido"}`}finally{a.value=!1}},m=()=>{v()},p=()=>{},k=()=>{},g=(0,t.EW)((()=>{let a=[...e.value];if(o.value){const e=o.value.toLowerCase();a=a.filter((a=>a.name?.toLowerCase().includes(e)))}return"all"!==r.value&&("low"===r.value?a=a.filter((e=>e.availableQuantity>0&&e.availableQuantity<=5)):"out"===r.value&&(a=a.filter((e=>0===e.availableQuantity)))),l.value&&("con_refresco"===l.value?a=a.filter((e=>e.includesDrink)):"sin_refresco"===l.value&&(a=a.filter((e=>!e.includesDrink)))),a})),y=e=>0===e.availableQuantity?"out-of-stock-row":e.availableQuantity<=5?"low-stock-row":"",f=e=>0===e.availableQuantity?"status-badge out-of-stock":e.availableQuantity<=5?"status-badge low-stock":"status-badge in-stock",L=e=>0===e.availableQuantity?"Sin stock":e.availableQuantity<=5?"Stock bajo":"Disponible",h=e=>{if(!e)return"N/A";try{const a=new Date(e);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a)}catch(a){return console.error("Error al formatear fecha:",a),"Fecha inválida"}},b=e=>{c.value={...e},d.value={newQuantity:e.availableQuantity,reason:"",isUpdating:!1},n.value=!0},E=()=>{n.value=!1,c.value=null},w=async()=>{if(c.value)if(isNaN(d.value.newQuantity)||d.value.newQuantity<0)await(0,B.xE)("Por favor ingrese una cantidad válida (mayor o igual a 0)");else if(d.value.reason.trim())try{d.value.isUpdating=!0;const a=c.value.availableQuantity,s=parseInt(d.value.newQuantity),t=s-a,o=t>0?"increase":t<0?"decrease":"adjustment",r=(0,V.HW)(),l={date:(new Date).toISOString(),type:o,change:Math.abs(t),previousQuantity:a,newQuantity:s,reason:d.value.reason,userId:r?.id,userName:r?.nombre||"Usuario"};await(0,W.NT)(c.value.id,s,l);const n=e.value.findIndex((e=>e.id===c.value.id));-1!==n&&(e.value[n].availableQuantity=s,e.value[n].lastUpdated=(new Date).toISOString(),e.value[n].stockHistory||(e.value[n].stockHistory=[]),e.value[n].stockHistory.push(l)),await(0,B.xE)("Stock actualizado correctamente",{title:"Actualización Exitosa"}),E()}catch(a){console.error("Error al actualizar stock:",a),await(0,B.xE)(`Error al actualizar stock: ${a.message||"Error desconocido"}`)}finally{d.value.isUpdating=!1}else await(0,B.xE)("Por favor ingrese un motivo para el ajuste de inventario")},C=e=>{c.value={...e},u.value=e.stockHistory||[],i.value=!0},S=()=>{i.value=!1,c.value=null,u.value=[]};return{products:e,loading:a,error:s,searchTerm:o,stockFilter:r,categoryFilter:l,filteredProducts:g,showUpdateModal:n,showHistoryModal:i,selectedProduct:c,productHistory:u,updateStockForm:d,loadInventory:v,refreshInventory:m,handleSearchInput:p,applyFilters:k,getRowClass:y,getStatusClass:f,getStatusText:L,formatDate:h,openUpdateStockModal:b,closeUpdateModal:E,updateStock:w,openHistoryModal:C,closeHistoryModal:S}}},J=s(1241);const q=(0,J.A)(j,[["render",Q],["__scopeId","data-v-55f4fd9a"]]);var G=q},3444:function(e,a,s){s.d(a,{NT:function(){return k},O0:function(){return i},TK:function(){return u},U1:function(){return d},Um:function(){return p},ao:function(){return m},gL:function(){return l},hG:function(){return v},kg:function(){return c},lo:function(){return n},wx:function(){return r}});s(4114),s(8111),s(2489),s(116),s(1701),s(8982);var t=s(133);let o=[];async function r(){try{0;const e=await t["default"].get("/admin/dashboard");return e}catch(e){return console.error("Error al obtener estadísticas del dashboard:",e),{success:!0,data:{totalUsers:45,activeUsers:38,inactiveUsers:7,activePayments:28,pendingPayments:8,overduePayments:3,totalIncome:1575e4,status:"Normal",lastBackup:(new Date).toISOString(),recentActivity:[{tipo:"system",usuario_nombre:"Sistema",accion:"inició en modo de respaldo",fecha:(new Date).toISOString()}]}}}}async function l(){try{0;const e=await t["default"].get("/admin/menu-items");return e}catch(e){return console.error("Error al obtener elementos del menú:",e),{success:!1,error:e.message||"Error al obtener elementos del menú"}}}async function n(e={}){try{let a="/admin/users";const s=[];e.searchTerm&&s.push(`search=${encodeURIComponent(e.searchTerm)}`),e.role&&s.push(`role=${encodeURIComponent(e.role)}`),e.status&&s.push(`status=${encodeURIComponent(e.status)}`),s.length>0&&(a+=`?${s.join("&")}`),console.log("Solicitando usuarios a la API:",a);const r=await t["default"].get(a);if(r&&r.success)return console.log(`Recibidos ${r.data.length} usuarios de la API`),o=r.data,{success:!0,data:r.data};throw new Error(r?.message||"Error al obtener usuarios")}catch(a){return console.error("Error al obtener usuarios:",a),o.length>0?(console.log("Usando usuarios en caché:",o.length),{success:!0,data:o}):{success:!1,message:`Error al obtener usuarios: ${a.message}`,data:[]}}}async function i(){try{const e=await t["default"].get("/admin/roles");if(e&&e.success)return e;throw new Error(e?.message||"Error al obtener roles")}catch(e){return console.error("Error al obtener roles:",e),{success:!1,message:e.message,data:[{id:1,nombre:"Superadministrador",descripcion:"Control total del sistema"},{id:2,nombre:"Administrador",descripcion:"Gestión de usuarios y configuración"},{id:3,nombre:"Empleado",descripcion:"Operaciones básicas"}]}}}async function c(e){try{if(!e.nombre||!e.email||!e.password)return{success:!1,message:"Faltan datos obligatorios"};console.log("Enviando solicitud para crear usuario:",e.email);const a=await t["default"].post("/admin/users",e);if(a&&a.success){console.log("Usuario creado exitosamente:",a.data?.email);const s=a.data||{id:Date.now(),nombre:e.nombre,email:e.email,telefono:e.telefono||"",roles:e.roles,estado:"activo",fecha_creacion:(new Date).toISOString()};return o=[s,...o],{success:!0,message:a.message||"Usuario creado correctamente",data:s}}throw new Error(a?.message||"Error al crear usuario")}catch(a){return console.error("Error al crear usuario:",a),{success:!1,message:a.message||"Error al crear usuario"}}}async function u(e,a){try{console.log(`Actualizando usuario ${e}:`,a);const s=await t["default"].put(`/admin/users/${e}`,a);if(s&&s.success){console.log("Usuario actualizado exitosamente");const t=o.findIndex((a=>a.id===e));return-1!==t&&(o[t]={...o[t],...a,id:e,email:o[t].email}),{success:!0,message:s.message||"Usuario actualizado correctamente",data:s.user}}throw new Error(s?.message||"Error al actualizar usuario")}catch(s){return console.error("Error al actualizar usuario:",s),{success:!1,message:s.message||"Error al actualizar usuario"}}}async function d(e,a){try{if("activo"!==a&&"inactivo"!==a)return{success:!1,message:"Estado inválido"};console.log(`Cambiando estado de usuario ${e} a ${a}`);const s="activo"===a?1:0,r=await t["default"].put(`/admin/users/${e}`,{activo:s});if(r&&r.success){console.log(`Estado de usuario cambiado exitosamente a ${a}`);const s=o.findIndex((a=>a.id===e));return-1!==s&&(o[s].estado=a),{success:!0,message:`Usuario ${"activo"===a?"activado":"desactivado"} correctamente`,data:{id:e,estado:a}}}throw new Error(r?.message||`Error al ${"activo"===a?"activar":"desactivar"} usuario`)}catch(s){return console.error(`Error al cambiar estado de usuario a ${a}:`,s),{success:!1,message:s.message||`Error al ${"activo"===a?"activar":"desactivar"} usuario`}}}async function v(e){try{console.log(`Eliminando usuario ${e}`);const a=await t["default"].delete(`/admin/users/${e}`);if(a&&a.success)return console.log("Usuario eliminado exitosamente"),o=o.filter((a=>a.id!==e)),{success:!0,message:a.message||"Usuario eliminado correctamente"};throw new Error(a?.message||"Error al eliminar usuario")}catch(a){return console.error("Error al eliminar usuario:",a),{success:!1,message:a.message||"Error al eliminar usuario"}}}async function m(){return new Promise((e=>{setTimeout((()=>{e({success:!0,data:[{id:1,timestamp:(new Date).toISOString(),type:"info",user:"Admin",message:"Inicio de sesión exitoso",details:{ip:"192.168.1.1",userAgent:"Chrome/96.0"}},{id:2,timestamp:new Date(Date.now()-36e5).toISOString(),type:"warning",user:"Sistema",message:"Intento de acceso fallido",details:{ip:"203.0.113.1",userAgent:"Edge/96.0",attempts:3}},{id:3,timestamp:new Date(Date.now()-72e5).toISOString(),type:"error",user:"Sistema",message:"Error en la creación de backup",details:{error:"Espacio insuficiente",code:"E0023"}},{id:4,timestamp:new Date(Date.now()-864e5).toISOString(),type:"success",user:"Juan Pérez",message:"Nuevo usuario creado",details:{newUser:"carlos@ejemplo.com"}}]})}),500)}))}async function p(){try{const e=await m();if(!e.success||!Array.isArray(e.data))throw new Error("No se pudieron obtener los logs para descargar");const a=e.data,s=["ID","Fecha","Tipo","Usuario","Mensaje","Detalles"],t=a.map((e=>[e.id||"",e.timestamp||"",e.type||"",e.user||"Sistema",e.message||"",e.details?JSON.stringify(e.details):""])),o=[s.join(","),...t.map((e=>e.map((e=>`"${String(e).replace(/"/g,'""')}"`)).join(",")))].join("\n");return{success:!0,data:o,message:"Logs descargados correctamente"}}catch(e){return console.error("Error al descargar logs en CSV:",e),{success:!1,message:e.message||"Error al descargar logs"}}}async function k(e,a){try{const s=await t["default"].put(`/admin/menu-items/${e}/stock`,{stock:a});if(s&&s.success)return{success:!0,message:"Stock actualizado correctamente",data:s.data};throw new Error(s?.message||"Error al actualizar stock")}catch(s){return console.error("Error al actualizar stock:",s),{success:!1,message:s.message||"Error al actualizar stock"}}}},7469:function(e,a,s){s.d(a,{A:function(){return Q}});var t=s(6768),o=s(5130),r=s(4232);const l={class:"logs-container"},n={class:"logs-controls"},i={class:"search-box"},c={class:"filters"},u={class:"actions"},d={key:0,class:"loading-container"},v={key:1,class:"empty-state"},m={key:2,class:"logs-table-wrapper"},p={class:"logs-table"},k={class:"message-cell"},g=["onClick"],y={key:3,class:"pagination"},f=["disabled"],L={class:"page-numbers"},h=["onClick"],b=["disabled"],E={class:"modal-container"},w={class:"modal-header"},C={class:"modal-body"},S={class:"log-detail-item"},D={class:"detail-value"},U={class:"log-detail-item"},I={class:"detail-value"},A={class:"log-detail-item"},R={class:"detail-value"},_={class:"log-detail-item"},x={class:"detail-value"},F={class:"log-detail-item"},X={class:"detail-value detail-json"},M={class:"modal-footer"};function T(e,a,s,T,P,K){return(0,t.uX)(),(0,t.CE)("div",l,[a[28]||(a[28]=(0,t.Lk)("h2",{class:"section-title"},"Registros del Sistema",-1)),(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>T.searchTerm=e),placeholder:"Buscar en registros...",class:"search-input",onInput:a[1]||(a[1]=(...e)=>T.debounceSearch&&T.debounceSearch(...e))},null,544),[[o.Jo,T.searchTerm]]),a[13]||(a[13]=(0,t.Lk)("button",{class:"search-btn"},"🔍",-1))]),(0,t.Lk)("div",c,[(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>T.typeFilter=e),class:"filter-select",onChange:a[3]||(a[3]=(...e)=>T.applyFilters&&T.applyFilters(...e))},a[14]||(a[14]=[(0,t.Fv)('<option value="" data-v-4dbe11f6>Todos los tipos</option><option value="info" data-v-4dbe11f6>Información</option><option value="warning" data-v-4dbe11f6>Advertencia</option><option value="error" data-v-4dbe11f6>Error</option><option value="success" data-v-4dbe11f6>Éxito</option>',5)]),544),[[o.u1,T.typeFilter]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>T.dateFilter=e),class:"filter-select",onChange:a[5]||(a[5]=(...e)=>T.applyFilters&&T.applyFilters(...e))},a[15]||(a[15]=[(0,t.Fv)('<option value="" data-v-4dbe11f6>Todas las fechas</option><option value="today" data-v-4dbe11f6>Hoy</option><option value="yesterday" data-v-4dbe11f6>Ayer</option><option value="week" data-v-4dbe11f6>Esta semana</option><option value="month" data-v-4dbe11f6>Este mes</option>',5)]),544),[[o.u1,T.dateFilter]])]),(0,t.Lk)("div",u,[(0,t.Lk)("button",{onClick:a[6]||(a[6]=(...e)=>T.refreshLogs&&T.refreshLogs(...e)),class:"refresh-btn"},a[16]||(a[16]=[(0,t.Lk)("span",{class:"btn-icon"},"🔄",-1),(0,t.eW)(" Actualizar ")])),(0,t.Lk)("button",{onClick:a[7]||(a[7]=(...e)=>T.downloadLogs&&T.downloadLogs(...e)),class:"download-btn"},a[17]||(a[17]=[(0,t.Lk)("span",{class:"btn-icon"},"⬇️",-1),(0,t.eW)(" Descargar ")]))])]),T.loading?((0,t.uX)(),(0,t.CE)("div",d,a[18]||(a[18]=[(0,t.Lk)("div",{class:"spinner"},null,-1),(0,t.Lk)("p",null,"Cargando registros...",-1)]))):0===T.filteredLogs.length?((0,t.uX)(),(0,t.CE)("div",v,a[19]||(a[19]=[(0,t.Lk)("div",{class:"empty-icon"},"📝",-1),(0,t.Lk)("p",null,"No se encontraron registros",-1)]))):((0,t.uX)(),(0,t.CE)("div",m,[(0,t.Lk)("table",p,[a[21]||(a[21]=(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",{class:"timestamp-col"},"Fecha y Hora"),(0,t.Lk)("th",{class:"type-col"},"Tipo"),(0,t.Lk)("th",{class:"user-col"},"Usuario"),(0,t.Lk)("th",{class:"message-col"},"Mensaje"),(0,t.Lk)("th",{class:"actions-col"},"Acciones")])],-1)),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(T.filteredLogs,(e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.id,class:(0,r.C4)("log-row "+e.type)},[(0,t.Lk)("td",null,(0,r.v_)(T.formatDate(e.timestamp)),1),(0,t.Lk)("td",null,[(0,t.Lk)("span",{class:(0,r.C4)(["log-type",e.type])},(0,r.v_)(T.getTypeLabel(e.type)),3)]),(0,t.Lk)("td",null,(0,r.v_)(e.user||"Sistema"),1),(0,t.Lk)("td",k,(0,r.v_)(e.message),1),(0,t.Lk)("td",null,[(0,t.Lk)("button",{onClick:a=>T.viewLogDetails(e),class:"detail-btn"},a[20]||(a[20]=[(0,t.Lk)("span",null,"👁️",-1)]),8,g)])],2)))),128))])])])),T.filteredLogs.length>0?((0,t.uX)(),(0,t.CE)("div",y,[(0,t.Lk)("button",{onClick:a[8]||(a[8]=e=>T.changePage(T.currentPage-1)),disabled:1===T.currentPage,class:"pagination-btn"}," < Anterior ",8,f),(0,t.Lk)("div",L,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(T.displayedPages,(e=>((0,t.uX)(),(0,t.CE)("button",{key:e,onClick:a=>T.changePage(e),class:(0,r.C4)(["page-number",{active:T.currentPage===e}])},(0,r.v_)(e),11,h)))),128))]),(0,t.Lk)("button",{onClick:a[9]||(a[9]=e=>T.changePage(T.currentPage+1)),disabled:T.currentPage===T.totalPages,class:"pagination-btn"}," Siguiente > ",8,b)])):(0,t.Q3)("",!0),T.showModal?((0,t.uX)(),(0,t.CE)("div",{key:4,class:"modal-overlay",onClick:a[12]||(a[12]=(0,o.D$)(((...e)=>T.closeModal&&T.closeModal(...e)),["self"]))},[(0,t.Lk)("div",E,[(0,t.Lk)("div",w,[a[22]||(a[22]=(0,t.Lk)("h3",null,"Detalles del Registro",-1)),(0,t.Lk)("button",{onClick:a[10]||(a[10]=(...e)=>T.closeModal&&T.closeModal(...e)),class:"close-btn"},"×")]),(0,t.Lk)("div",C,[(0,t.Lk)("div",S,[a[23]||(a[23]=(0,t.Lk)("span",{class:"detail-label"},"Fecha y Hora:",-1)),(0,t.Lk)("span",D,(0,r.v_)(T.formatDate(T.selectedLog.timestamp)),1)]),(0,t.Lk)("div",U,[a[24]||(a[24]=(0,t.Lk)("span",{class:"detail-label"},"Tipo:",-1)),(0,t.Lk)("span",I,[(0,t.Lk)("span",{class:(0,r.C4)(["log-type",T.selectedLog.type])},(0,r.v_)(T.getTypeLabel(T.selectedLog.type)),3)])]),(0,t.Lk)("div",A,[a[25]||(a[25]=(0,t.Lk)("span",{class:"detail-label"},"Usuario:",-1)),(0,t.Lk)("span",R,(0,r.v_)(T.selectedLog.user||"Sistema"),1)]),(0,t.Lk)("div",_,[a[26]||(a[26]=(0,t.Lk)("span",{class:"detail-label"},"Mensaje:",-1)),(0,t.Lk)("span",x,(0,r.v_)(T.selectedLog.message),1)]),(0,t.Lk)("div",F,[a[27]||(a[27]=(0,t.Lk)("span",{class:"detail-label"},"Detalles adicionales:",-1)),(0,t.Lk)("pre",X,(0,r.v_)(JSON.stringify(T.selectedLog.details,null,2)),1)])]),(0,t.Lk)("div",M,[(0,t.Lk)("button",{onClick:a[11]||(a[11]=(...e)=>T.closeModal&&T.closeModal(...e)),class:"close-btn"},"Cerrar")])])])):(0,t.Q3)("",!0)])}s(4114),s(8111),s(2489),s(4603),s(7566),s(8721);var P=s(144),K=s(3444),N=s(4887),$={name:"AdminLogs",setup(){const e=(0,P.KR)([]),a=(0,P.KR)(!0),s=(0,P.KR)(""),o=(0,P.KR)(""),r=(0,P.KR)(""),l=(0,P.KR)(1),n=(0,P.KR)(10),i=(0,P.KR)(!1),c=(0,P.KR)({});let u=null;(0,t.sV)((async()=>{await d()}));const d=async()=>{try{a.value=!0;const s=await(0,K.ao)();if(!s||!s.success)throw new Error("Error al cargar logs");e.value=s.data||[]}catch(s){console.error("Error al obtener logs:",s),await(0,N.xE)("Error al cargar los logs: "+(s.message||"Error desconocido"))}finally{a.value=!1}},v=e=>{if(!e)return"N/A";try{const a=new Date(e);return isNaN(a.getTime())?"Fecha inválida":new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(a)}catch(a){return"Fecha inválida"}},m=e=>{switch(e){case"info":return"Información";case"warning":return"Advertencia";case"error":return"Error";case"success":return"Éxito";default:return e}},p=(0,t.EW)((()=>{let a=[...e.value];if(s.value){const e=s.value.toLowerCase();a=a.filter((a=>a.message&&a.message.toLowerCase().includes(e)||a.user&&a.user.toLowerCase().includes(e)))}if(o.value&&(a=a.filter((e=>e.type===o.value))),r.value){const e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate());switch(r.value){case"today":a=a.filter((e=>{const a=new Date(e.timestamp);return a>=s}));break;case"yesterday":const e=new Date(s);e.setDate(e.getDate()-1),a=a.filter((a=>{const t=new Date(a.timestamp);return t>=e&&t<s}));break;case"week":const t=new Date(s);t.setDate(t.getDate()-7),a=a.filter((e=>{const a=new Date(e.timestamp);return a>=t}));break;case"month":const o=new Date(s);o.setMonth(o.getMonth()-1),a=a.filter((e=>{const a=new Date(e.timestamp);return a>=o}));break}}return a})),k=(0,t.EW)((()=>Math.ceil(p.value.length/n.value))),g=(0,t.EW)((()=>{const e=[],a=5;if(k.value<=a)for(let s=1;s<=k.value;s++)e.push(s);else{let s=Math.max(1,l.value-Math.floor(a/2));const t=Math.min(k.value,s+a-1);t-s+1<a&&(s=Math.max(1,t-a+1));for(let a=s;a<=t;a++)e.push(a)}return e})),y=((0,t.EW)((()=>{const e=(l.value-1)*n.value;return p.value.slice(e,e+n.value)})),e=>{e>=1&&e<=k.value&&(l.value=e)}),f=()=>{clearTimeout(u),u=setTimeout((()=>{l.value=1}),300)},L=()=>{l.value=1},h=async()=>{await d(),await(0,N.xE)("Registros actualizados correctamente")},b=async()=>{try{a.value=!0;const e=await(0,K.Um)();if(!e||!e.success)throw new Error("Error al descargar logs");{const a=new Blob([e.data],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),t=URL.createObjectURL(a);s.setAttribute("href",t),s.setAttribute("download",`logs_${(new Date).toISOString().split("T")[0]}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),await(0,N.xE)("Logs descargados correctamente")}}catch(e){console.error("Error al descargar logs:",e),await(0,N.xE)("Error al descargar logs: "+(e.message||"Error desconocido"))}finally{a.value=!1}},E=e=>{c.value=e,i.value=!0},w=()=>{i.value=!1};return{logs:e,loading:a,searchTerm:s,typeFilter:o,dateFilter:r,currentPage:l,totalPages:k,displayedPages:g,filteredLogs:p,showModal:i,selectedLog:c,formatDate:v,getTypeLabel:m,debounceSearch:f,applyFilters:L,refreshLogs:h,downloadLogs:b,changePage:y,viewLogDetails:E,closeModal:w}}},z=s(1241);const O=(0,z.A)($,[["render",T],["__scopeId","data-v-4dbe11f6"]]);var Q=O},7816:function(e,a,s){s.d(a,{A:function(){return F}});var t=s(6768),o=s(4232);const r={class:"dashboard-container"},l={key:0,class:"loading-spinner-container"},n={key:1,class:"error-container"},i={class:"error-message"},c={key:2,class:"dashboard-content"},u={class:"stats-cards"},d={class:"stat-card users"},v={class:"stat-info"},m={class:"stat-card menu"},p={class:"stat-info"},k={class:"stat-card sales"},g={class:"stat-info"},y={class:"recent-activity"},f={key:0,class:"activity-list"},L={key:0},h={key:1},b={key:2},E={class:"activity-content"},w={class:"activity-time"},C={key:1,class:"no-activity"},S={class:"system-status"},D={class:"status-info"};function U(e,a,s,U,I,A){return(0,t.uX)(),(0,t.CE)("div",r,[a[17]||(a[17]=(0,t.Lk)("h2",{class:"section-title"},"Dashboard",-1)),U.loading?((0,t.uX)(),(0,t.CE)("div",l,a[2]||(a[2]=[(0,t.Lk)("div",{class:"spinner"},null,-1),(0,t.Lk)("p",null,"Cargando datos...",-1)]))):U.error?((0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("p",i,(0,o.v_)(U.error),1),(0,t.Lk)("button",{onClick:a[0]||(a[0]=(...e)=>U.loadStats&&U.loadStats(...e)),class:"retry-button"},"Reintentar")])):((0,t.uX)(),(0,t.CE)("div",c,[(0,t.Lk)("div",u,[(0,t.Lk)("div",d,[a[4]||(a[4]=(0,t.Lk)("div",{class:"stat-icon"},"👥",-1)),(0,t.Lk)("div",v,[(0,t.Lk)("h3",null,(0,o.v_)(U.stats.totalUsers),1),a[3]||(a[3]=(0,t.Lk)("p",null,"Usuarios Registrados",-1))])]),(0,t.Lk)("div",m,[a[6]||(a[6]=(0,t.Lk)("div",{class:"stat-icon"},"🍽️",-1)),(0,t.Lk)("div",p,[(0,t.Lk)("h3",null,(0,o.v_)(U.stats.activePayments),1),a[5]||(a[5]=(0,t.Lk)("p",null,"Pagos Activos",-1))])]),(0,t.Lk)("div",k,[a[8]||(a[8]=(0,t.Lk)("div",{class:"stat-icon"},"💰",-1)),(0,t.Lk)("div",g,[(0,t.Lk)("h3",null,(0,o.v_)(U.formatCurrency(U.stats.totalIncome)),1),a[7]||(a[7]=(0,t.Lk)("p",null,"Ingresos Totales",-1))])])]),(0,t.Lk)("div",y,[a[9]||(a[9]=(0,t.Lk)("h3",null,"Actividad Reciente",-1)),U.stats.recentActivity&&U.stats.recentActivity.length>0?((0,t.uX)(),(0,t.CE)("div",f,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(U.stats.recentActivity,((e,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"activity-item"},[(0,t.Lk)("div",{class:(0,o.C4)(["activity-icon",e.tipo])},["user_login"===e.tipo?((0,t.uX)(),(0,t.CE)("span",L,"👤")):"system"===e.tipo?((0,t.uX)(),(0,t.CE)("span",h,"📝")):((0,t.uX)(),(0,t.CE)("span",b,"📝"))],2),(0,t.Lk)("div",E,[(0,t.Lk)("p",null,[(0,t.Lk)("strong",null,(0,o.v_)(e.usuario_nombre),1),(0,t.eW)(" "+(0,o.v_)(e.accion),1)]),(0,t.Lk)("span",w,(0,o.v_)(U.formatDate(e.fecha)),1)])])))),128))])):((0,t.uX)(),(0,t.CE)("p",C,"No hay actividad reciente registrada"))]),(0,t.Lk)("div",S,[a[15]||(a[15]=(0,t.Lk)("h3",null,"Estado del Sistema",-1)),(0,t.Lk)("div",D,[(0,t.Lk)("p",null,[a[10]||(a[10]=(0,t.Lk)("strong",null,"Estado:",-1)),a[11]||(a[11]=(0,t.eW)()),(0,t.Lk)("span",{class:(0,o.C4)("status-"+U.stats.status.toLowerCase())},(0,o.v_)(U.stats.status),3)]),(0,t.Lk)("p",null,[a[12]||(a[12]=(0,t.Lk)("strong",null,"Último respaldo:",-1)),(0,t.eW)(" "+(0,o.v_)(U.formatDate(U.stats.lastBackup)),1)]),(0,t.Lk)("p",null,[a[13]||(a[13]=(0,t.Lk)("strong",null,"Usuarios activos:",-1)),(0,t.eW)(" "+(0,o.v_)(U.stats.activeUsers),1)]),(0,t.Lk)("p",null,[a[14]||(a[14]=(0,t.Lk)("strong",null,"Usuarios inactivos:",-1)),(0,t.eW)(" "+(0,o.v_)(U.stats.inactiveUsers),1)])])])])),(0,t.Lk)("button",{onClick:a[1]||(a[1]=(...e)=>U.loadStats&&U.loadStats(...e)),class:"refresh-button"},a[16]||(a[16]=[(0,t.Lk)("span",{class:"refresh-icon"},"🔄",-1),(0,t.eW)(" Actualizar Datos ")]))])}var I=s(144),A=s(3444),R={name:"AdminDashboard",setup(){const e=(0,I.KR)({totalUsers:0,activeUsers:0,inactiveUsers:0,activePayments:0,pendingPayments:0,overduePayments:0,totalIncome:0,status:"Normal",lastBackup:null,recentActivity:[]}),a=(0,I.KR)(!0),s=(0,I.KR)(null),o=async()=>{a.value=!0,s.value=null;try{console.log("Cargando estadísticas del dashboard...");const a=await(0,A.wx)();a&&a.success&&a.data?(console.log("Estadísticas cargadas correctamente:",a.data),e.value=a.data):(console.warn("Error en la respuesta del servicio, usando datos de respaldo"),s.value=a.error||"Error al cargar las estadísticas",0===e.value.totalUsers&&(e.value={totalUsers:4,activeUsers:3,inactiveUsers:1,activePayments:28,pendingPayments:8,overduePayments:3,totalIncome:1575e4,status:"Normal",lastBackup:(new Date).toISOString(),recentActivity:[{tipo:"user_login",usuario_nombre:"Admin",accion:"inició sesión en el sistema",fecha:(new Date).toISOString()},{tipo:"system",usuario_nombre:"Sistema",accion:"realizó una sincronización de datos",fecha:new Date(Date.now()-864e5).toISOString()}]}))}catch(t){console.error("Error al cargar estadísticas:",t),s.value=t.message||"Error al cargar las estadísticas",0===e.value.totalUsers&&(e.value={totalUsers:4,activeUsers:3,inactiveUsers:1,activePayments:28,pendingPayments:8,overduePayments:3,totalIncome:1575e4,status:"Normal",lastBackup:(new Date).toISOString(),recentActivity:[{tipo:"system",usuario_nombre:"Sistema",accion:"inició en modo de respaldo",fecha:(new Date).toISOString()}]})}finally{a.value=!1}},r=e=>{if(!e)return"No disponible";try{const a=new Date(e);return a.toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(a){return console.error("Error al formatear fecha:",a),e}},l=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(e);return(0,t.sV)((()=>{o()})),{stats:e,loading:a,error:s,loadStats:o,formatDate:r,formatCurrency:l}}},_=s(1241);const x=(0,_.A)(R,[["render",U],["__scopeId","data-v-4ace1a92"]]);var F=x}}]);
//# sourceMappingURL=987.71b11cd9.js.map