{"ast":null,"code":"import { ref, onMounted, computed } from 'vue';\n// Importar todas las funciones que necesitamos\nimport * as adminService from '../../services/adminService';\nimport { alert, confirm } from '../../services/dialogService';\nexport default {\n  name: 'AdminUsers',\n  setup() {\n    const users = ref([]);\n    const roles = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n\n    // Filtros\n    const searchTerm = ref('');\n    const roleFilter = ref('');\n    const statusFilter = ref('');\n\n    // Formulario\n    const showModal = ref(false);\n    const isEditing = ref(false);\n    const formData = ref({\n      id: null,\n      nombre: '',\n      email: '',\n      telefono: '',\n      password: '',\n      roles: [],\n      estado: 'activo'\n    });\n\n    // Obtener referencias a las funciones del servicio admin\n    const {\n      getUsers,\n      getRoles,\n      createUser,\n      updateUser,\n      cambiarEstadoUsuario,\n      deleteUser: removeUser\n    } = adminService;\n\n    // Búsqueda con debounce\n    let searchTimeout = null;\n    onMounted(async () => {\n      await Promise.all([fetchUsers(), fetchRoles()]);\n    });\n\n    // Obtener usuarios con filtros aplicados\n    const fetchUsers = async () => {\n      try {\n        loading.value = true;\n        error.value = null;\n        const options = {\n          searchTerm: searchTerm.value,\n          role: roleFilter.value,\n          status: statusFilter.value\n        };\n        const response = await getUsers(options);\n        if (response && response.success) {\n          users.value = Array.isArray(response.data) ? response.data : [];\n        } else {\n          throw new Error(response?.message || 'Error al cargar usuarios');\n        }\n      } catch (err) {\n        console.error('Error al cargar usuarios:', err);\n        error.value = `Error al cargar usuarios: ${err.message || 'Error desconocido'}`;\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // Obtener roles disponibles\n    const fetchRoles = async () => {\n      try {\n        const response = await getRoles();\n        if (response && response.success) {\n          roles.value = Array.isArray(response.data) ? response.data : [];\n        } else {\n          console.warn('Error al cargar roles:', response?.message);\n        }\n      } catch (err) {\n        console.error('Error al cargar roles:', err);\n      }\n    };\n\n    // Manejar cambios en el campo de búsqueda con debounce\n    const handleSearchInput = () => {\n      clearTimeout(searchTimeout);\n      searchTimeout = setTimeout(() => {\n        fetchUsers();\n      }, 300);\n    };\n\n    // Resetear filtros\n    const resetFilters = () => {\n      searchTerm.value = '';\n      roleFilter.value = '';\n      statusFilter.value = '';\n      fetchUsers();\n    };\n\n    // Mostrar formulario de creación\n    const showCreateForm = () => {\n      isEditing.value = false;\n      formData.value = {\n        id: null,\n        nombre: '',\n        email: '',\n        telefono: '',\n        password: '',\n        roles: ['Empleado'],\n        // Rol por defecto\n        estado: 'activo'\n      };\n      showModal.value = true;\n    };\n\n    // Editar usuario\n    const editUser = user => {\n      isEditing.value = true;\n      formData.value = {\n        id: user.id,\n        nombre: user.nombre,\n        email: user.email,\n        telefono: user.telefono || '',\n        password: '',\n        // Dejamos vacío para mantener la contraseña actual\n        roles: [...user.roles],\n        estado: user.estado\n      };\n      showModal.value = true;\n    };\n\n    // Guardar usuario (crear o actualizar)\n    const saveUser = async () => {\n      try {\n        loading.value = true;\n\n        // Validar que al menos se seleccionó un rol\n        if (!formData.value.roles.length) {\n          await alert('Debe seleccionar al menos un rol para el usuario');\n          loading.value = false;\n          return;\n        }\n        if (isEditing.value) {\n          // Filtrar para enviar solo los campos necesarios\n          const userData = {\n            nombre: formData.value.nombre,\n            telefono: formData.value.telefono,\n            roles: formData.value.roles,\n            estado: formData.value.estado\n          };\n\n          // Si se proporciona una contraseña, incluirla\n          if (formData.value.password) {\n            userData.password = formData.value.password;\n          }\n          const response = await updateUser(formData.value.id, userData);\n          if (response && response.success) {\n            await alert(response.message || 'Usuario actualizado exitosamente');\n            // Refrescar lista de usuarios con los nuevos datos\n            await fetchUsers();\n          } else {\n            throw new Error(response?.message || 'Error al actualizar usuario');\n          }\n        } else {\n          // Crear nuevo usuario\n          const userData = {\n            nombre: formData.value.nombre,\n            email: formData.value.email,\n            password: formData.value.password,\n            telefono: formData.value.telefono,\n            roles: formData.value.roles\n          };\n          console.log(\"Llamando a createUser con:\", userData);\n          try {\n            const response = await createUser(userData);\n            if (response && response.success) {\n              await alert(response.message || 'Usuario creado exitosamente');\n              // Añadir directamente el usuario creado a la lista local\n              if (response.data) {\n                // Asegurarse de que response.data tenga el formato esperado\n                users.value.unshift(response.data);\n              }\n              // Y también refrescar la lista completa desde el servicio\n              await fetchUsers();\n            } else {\n              throw new Error(response?.message || 'Error al crear usuario');\n            }\n          } catch (createError) {\n            console.error('Error específico al crear usuario:', createError);\n            throw createError;\n          }\n        }\n        closeModal();\n      } catch (err) {\n        console.error('Error al guardar el usuario:', err);\n        await alert(`Error al guardar el usuario: ${err.message || 'Error desconocido'}`);\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // Activar usuario\n    const activateUser = async user => {\n      try {\n        const confirmed = await confirm(`¿Estás seguro de que deseas activar el usuario ${user.nombre}?`);\n        if (confirmed) {\n          loading.value = true;\n          const response = await cambiarEstadoUsuario(user.id, 'activo');\n          if (response && response.success) {\n            await alert(response.message || 'Usuario activado exitosamente');\n            fetchUsers(); // Refrescar lista\n          } else {\n            throw new Error(response?.message || 'Error al activar usuario');\n          }\n        }\n      } catch (err) {\n        console.error('Error al activar usuario:', err);\n        await alert(`Error al activar usuario: ${err.message || 'Error desconocido'}`);\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // Desactivar usuario\n    const deactivateUser = async user => {\n      try {\n        const confirmed = await confirm(`¿Estás seguro de que deseas desactivar el usuario ${user.nombre}? No podrá acceder al sistema mientras esté inactivo.`, {\n          title: 'Confirmar desactivación'\n        });\n        if (confirmed) {\n          loading.value = true;\n          const response = await cambiarEstadoUsuario(user.id, 'inactivo');\n          if (response && response.success) {\n            await alert(response.message || 'Usuario desactivado exitosamente');\n            fetchUsers(); // Refrescar lista\n          } else {\n            throw new Error(response?.message || 'Error al desactivar usuario');\n          }\n        }\n      } catch (err) {\n        console.error('Error al desactivar usuario:', err);\n        await alert(`Error al desactivar usuario: ${err.message || 'Error desconocido'}`);\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // Eliminar usuario\n    const deleteUser = async user => {\n      try {\n        const confirmed = await confirm(`¿Estás seguro de que deseas eliminar permanentemente el usuario ${user.nombre}? Esta acción no se puede deshacer.`, {\n          title: 'Confirmar eliminación',\n          confirmText: 'Eliminar',\n          cancelText: 'Cancelar'\n        });\n        if (confirmed) {\n          loading.value = true;\n          const response = await removeUser(user.id);\n          if (response && response.success) {\n            await alert(response.message || 'Usuario eliminado exitosamente');\n            fetchUsers(); // Refrescar lista\n          } else {\n            throw new Error(response?.message || 'Error al eliminar usuario');\n          }\n        }\n      } catch (err) {\n        console.error('Error al eliminar usuario:', err);\n        await alert(`Error al eliminar usuario: ${err.message || 'Error desconocido'}`);\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // Cerrar modal\n    const closeModal = () => {\n      showModal.value = false;\n    };\n\n    // Formatear fecha\n    const formatDate = dateStr => {\n      if (!dateStr) return 'N/A';\n      try {\n        const date = new Date(dateStr);\n        if (isNaN(date.getTime())) return 'Fecha inválida';\n        return new Intl.DateTimeFormat('es-ES', {\n          day: '2-digit',\n          month: '2-digit',\n          year: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit'\n        }).format(date);\n      } catch (e) {\n        return 'Fecha inválida';\n      }\n    };\n    return {\n      users,\n      roles,\n      loading,\n      error,\n      searchTerm,\n      roleFilter,\n      statusFilter,\n      showModal,\n      isEditing,\n      formData,\n      handleSearchInput,\n      fetchUsers,\n      resetFilters,\n      showCreateForm,\n      editUser,\n      saveUser,\n      activateUser,\n      deactivateUser,\n      deleteUser,\n      closeModal,\n      formatDate\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","adminService","alert","confirm","name","setup","users","roles","loading","error","searchTerm","roleFilter","statusFilter","showModal","isEditing","formData","id","nombre","email","telefono","password","estado","getUsers","getRoles","createUser","updateUser","cambiarEstadoUsuario","deleteUser","removeUser","searchTimeout","Promise","all","fetchUsers","fetchRoles","value","options","role","status","response","success","Array","isArray","data","Error","message","err","console","warn","handleSearchInput","clearTimeout","setTimeout","resetFilters","showCreateForm","editUser","user","saveUser","length","userData","log","unshift","createError","closeModal","activateUser","confirmed","deactivateUser","title","confirmText","cancelText","formatDate","dateStr","date","Date","isNaN","getTime","Intl","DateTimeFormat","day","month","year","hour","minute","format","e"],"sources":["F:\\Driver google\\VUE.JS-2\\temp\\websap\\src\\components\\admin\\AdminUsers.vue"],"sourcesContent":["<template>\r\n  <div class=\"users-container\">\r\n    <h2 class=\"section-title\">Gestión de Usuarios</h2>\r\n    \r\n    <!-- Controles de búsqueda y filtros -->\r\n    <div class=\"users-controls\">\r\n      <div class=\"search-container\">\r\n        <input \r\n          v-model=\"searchTerm\" \r\n          placeholder=\"Buscar usuario...\" \r\n          class=\"search-input\"\r\n          @input=\"handleSearchInput\"\r\n        />\r\n      </div>\r\n      \r\n      <div class=\"filters\">\r\n        <select v-model=\"roleFilter\" @change=\"fetchUsers\" class=\"filter-select\">\r\n          <option value=\"\">Todos los roles</option>\r\n          <option \r\n            v-for=\"role in roles\" \r\n            :key=\"role.id\" \r\n            :value=\"role.nombre\"\r\n          >\r\n            {{ role.nombre }}\r\n          </option>\r\n        </select>\r\n        \r\n        <select v-model=\"statusFilter\" @change=\"fetchUsers\" class=\"filter-select\">\r\n          <option value=\"\">Todos los estados</option>\r\n          <option value=\"activo\">Activos</option>\r\n          <option value=\"inactivo\">Inactivos</option>\r\n        </select>\r\n      </div>\r\n      \r\n      <div class=\"actions\">\r\n        <button @click=\"showCreateForm\" class=\"create-user-btn\">\r\n          <span class=\"btn-icon\">➕</span> Nuevo Usuario\r\n        </button>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- Tabla de usuarios -->\r\n    <div v-if=\"loading\" class=\"loading-container\">\r\n      <div class=\"spinner\"></div>\r\n      <p>Cargando usuarios...</p>\r\n    </div>\r\n    \r\n    <div v-else-if=\"error\" class=\"error-container\">\r\n      <p class=\"error-message\">{{ error }}</p>\r\n      <button @click=\"fetchUsers\" class=\"retry-btn\">Reintentar</button>\r\n    </div>\r\n    \r\n    <div v-else-if=\"users.length === 0\" class=\"empty-state\">\r\n      <div class=\"empty-icon\">👥</div>\r\n      <p class=\"empty-title\">No se encontraron usuarios</p>\r\n      <p class=\"empty-description\">No hay usuarios que coincidan con los criterios de búsqueda</p>\r\n      <button @click=\"resetFilters\" class=\"reset-filters-btn\">Limpiar filtros</button>\r\n    </div>\r\n    \r\n    <div v-else class=\"users-table-container\">\r\n      <table class=\"users-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Nombre</th>\r\n            <th>Email</th>\r\n            <th>Teléfono</th>\r\n            <th>Rol</th>\r\n            <th>Estado</th>\r\n            <th>Fecha de registro</th>\r\n            <th>Acciones</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"user in users\" :key=\"user.id\" :class=\"{'inactive-user': user.estado === 'inactivo'}\">\r\n            <td>{{ user.nombre }}</td>\r\n            <td>{{ user.email }}</td>\r\n            <td>{{ user.telefono || '-' }}</td>\r\n            <td>\r\n              <div class=\"roles-list\">\r\n                <span \r\n                  v-for=\"(role, index) in user.roles\" \r\n                  :key=\"index\" \r\n                  class=\"role-badge\"\r\n                  :class=\"{'admin-role': role === 'Administrador', 'superadmin-role': role === 'Superadministrador'}\"\r\n                >\r\n                  {{ role }}\r\n                </span>\r\n              </div>\r\n            </td>\r\n            <td>\r\n              <span \r\n                class=\"status-badge\" \r\n                :class=\"user.estado === 'activo' ? 'active-status' : 'inactive-status'\"\r\n              >\r\n                {{ user.estado === 'activo' ? 'Activo' : 'Inactivo' }}\r\n              </span>\r\n            </td>\r\n            <td>{{ formatDate(user.fecha_creacion) }}</td>\r\n            <td>\r\n              <div class=\"action-buttons\">\r\n                <button @click=\"editUser(user)\" class=\"edit-btn\" title=\"Editar\">\r\n                  <span class=\"btn-icon\">✏️</span>\r\n                </button>\r\n                <button \r\n                  v-if=\"user.estado === 'activo'\" \r\n                  @click=\"deactivateUser(user)\" \r\n                  class=\"deactivate-btn\" \r\n                  title=\"Desactivar\"\r\n                >\r\n                  <span class=\"btn-icon\">🔴</span>\r\n                </button>\r\n                <button \r\n                  v-else \r\n                  @click=\"activateUser(user)\" \r\n                  class=\"activate-btn\" \r\n                  title=\"Activar\"\r\n                >\r\n                  <span class=\"btn-icon\">🟢</span>\r\n                </button>\r\n                <button @click=\"deleteUser(user)\" class=\"delete-btn\" title=\"Eliminar\">\r\n                  <span class=\"btn-icon\">❌</span>\r\n                </button>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    \r\n    <!-- Form Modal -->\r\n    <div v-if=\"showModal\" class=\"modal-overlay\" @click.self=\"closeModal\">\r\n      <div class=\"modal-container\">\r\n        <div class=\"modal-header\">\r\n          <h3>{{ isEditing ? 'Editar Usuario' : 'Crear Nuevo Usuario' }}</h3>\r\n          <button @click=\"closeModal\" class=\"close-btn\">&times;</button>\r\n        </div>\r\n        \r\n        <div class=\"modal-body\">\r\n          <form @submit.prevent=\"saveUser\" class=\"user-form\">\r\n            <div class=\"form-group\">\r\n              <label for=\"nombre\">Nombre completo</label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"nombre\"\r\n                v-model=\"formData.nombre\"\r\n                required\r\n                placeholder=\"Ej: Juan Pérez\"\r\n              >\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"email\">Correo electrónico</label>\r\n              <input\r\n                type=\"email\"\r\n                id=\"email\"\r\n                v-model=\"formData.email\"\r\n                required\r\n                placeholder=\"ejemplo@correo.com\"\r\n                :disabled=\"isEditing\"\r\n              >\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"telefono\">Teléfono</label>\r\n              <input\r\n                type=\"tel\"\r\n                id=\"telefono\"\r\n                v-model=\"formData.telefono\"\r\n                placeholder=\"Ej: 3001234567\"\r\n              >\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"password\">Contraseña {{ isEditing ? '(dejar en blanco para mantener actual)' : '' }}</label>\r\n              <input\r\n                type=\"password\"\r\n                id=\"password\"\r\n                v-model=\"formData.password\"\r\n                :required=\"!isEditing\"\r\n                placeholder=\"Contraseña segura\"\r\n                autocomplete=\"new-password\"\r\n              >\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label>Roles</label>\r\n              <div class=\"roles-checkboxes\">\r\n                <div \r\n                  v-for=\"role in roles\" \r\n                  :key=\"role.id\" \r\n                  class=\"role-checkbox\"\r\n                >\r\n                  <input \r\n                    type=\"checkbox\" \r\n                    :id=\"'role-' + role.id\" \r\n                    :value=\"role.nombre\" \r\n                    v-model=\"formData.roles\"\r\n                  >\r\n                  <label :for=\"'role-' + role.id\">{{ role.nombre }}</label>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div v-if=\"isEditing\" class=\"form-group\">\r\n              <label for=\"estado\">Estado</label>\r\n              <select id=\"estado\" v-model=\"formData.estado\">\r\n                <option value=\"activo\">Activo</option>\r\n                <option value=\"inactivo\">Inactivo</option>\r\n              </select>\r\n            </div>\r\n            \r\n            <div class=\"form-buttons\">\r\n              <button type=\"button\" @click=\"closeModal\" class=\"cancel-btn\">Cancelar</button>\r\n              <button type=\"submit\" class=\"save-btn\">{{ isEditing ? 'Actualizar' : 'Crear' }}</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue';\r\n// Importar todas las funciones que necesitamos\r\nimport * as adminService from '../../services/adminService';\r\nimport { alert, confirm } from '../../services/dialogService';\r\n\r\nexport default {\r\n  name: 'AdminUsers',\r\n  setup() {\r\n    const users = ref([]);\r\n    const roles = ref([]);\r\n    const loading = ref(true);\r\n    const error = ref(null);\r\n    \r\n    // Filtros\r\n    const searchTerm = ref('');\r\n    const roleFilter = ref('');\r\n    const statusFilter = ref('');\r\n    \r\n    // Formulario\r\n    const showModal = ref(false);\r\n    const isEditing = ref(false);\r\n    const formData = ref({\r\n      id: null,\r\n      nombre: '',\r\n      email: '',\r\n      telefono: '',\r\n      password: '',\r\n      roles: [],\r\n      estado: 'activo'\r\n    });\r\n    \r\n    // Obtener referencias a las funciones del servicio admin\r\n    const { \r\n      getUsers, \r\n      getRoles, \r\n      createUser, \r\n      updateUser, \r\n      cambiarEstadoUsuario, \r\n      deleteUser: removeUser \r\n    } = adminService;\r\n    \r\n    // Búsqueda con debounce\r\n    let searchTimeout = null;\r\n    \r\n    onMounted(async () => {\r\n      await Promise.all([\r\n        fetchUsers(),\r\n        fetchRoles()\r\n      ]);\r\n    });\r\n    \r\n    // Obtener usuarios con filtros aplicados\r\n    const fetchUsers = async () => {\r\n      try {\r\n        loading.value = true;\r\n        error.value = null;\r\n        \r\n        const options = {\r\n          searchTerm: searchTerm.value,\r\n          role: roleFilter.value,\r\n          status: statusFilter.value\r\n        };\r\n        \r\n        const response = await getUsers(options);\r\n        \r\n        if (response && response.success) {\r\n          users.value = Array.isArray(response.data) ? response.data : [];\r\n        } else {\r\n          throw new Error(response?.message || 'Error al cargar usuarios');\r\n        }\r\n      } catch (err) {\r\n        console.error('Error al cargar usuarios:', err);\r\n        error.value = `Error al cargar usuarios: ${err.message || 'Error desconocido'}`;\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    // Obtener roles disponibles\r\n    const fetchRoles = async () => {\r\n      try {\r\n        const response = await getRoles();\r\n        \r\n        if (response && response.success) {\r\n          roles.value = Array.isArray(response.data) ? response.data : [];\r\n        } else {\r\n          console.warn('Error al cargar roles:', response?.message);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error al cargar roles:', err);\r\n      }\r\n    };\r\n    \r\n    // Manejar cambios en el campo de búsqueda con debounce\r\n    const handleSearchInput = () => {\r\n      clearTimeout(searchTimeout);\r\n      searchTimeout = setTimeout(() => {\r\n        fetchUsers();\r\n      }, 300);\r\n    };\r\n    \r\n    // Resetear filtros\r\n    const resetFilters = () => {\r\n      searchTerm.value = '';\r\n      roleFilter.value = '';\r\n      statusFilter.value = '';\r\n      fetchUsers();\r\n    };\r\n    \r\n    // Mostrar formulario de creación\r\n    const showCreateForm = () => {\r\n      isEditing.value = false;\r\n      formData.value = {\r\n        id: null,\r\n        nombre: '',\r\n        email: '',\r\n        telefono: '',\r\n        password: '',\r\n        roles: ['Empleado'], // Rol por defecto\r\n        estado: 'activo'\r\n      };\r\n      showModal.value = true;\r\n    };\r\n    \r\n    // Editar usuario\r\n    const editUser = (user) => {\r\n      isEditing.value = true;\r\n      formData.value = {\r\n        id: user.id,\r\n        nombre: user.nombre,\r\n        email: user.email,\r\n        telefono: user.telefono || '',\r\n        password: '', // Dejamos vacío para mantener la contraseña actual\r\n        roles: [...user.roles],\r\n        estado: user.estado\r\n      };\r\n      showModal.value = true;\r\n    };\r\n    \r\n    // Guardar usuario (crear o actualizar)\r\n    const saveUser = async () => {\r\n      try {\r\n        loading.value = true;\r\n        \r\n        // Validar que al menos se seleccionó un rol\r\n        if (!formData.value.roles.length) {\r\n          await alert('Debe seleccionar al menos un rol para el usuario');\r\n          loading.value = false;\r\n          return;\r\n        }\r\n        \r\n        if (isEditing.value) {\r\n          // Filtrar para enviar solo los campos necesarios\r\n          const userData = {\r\n            nombre: formData.value.nombre,\r\n            telefono: formData.value.telefono,\r\n            roles: formData.value.roles,\r\n            estado: formData.value.estado\r\n          };\r\n          \r\n          // Si se proporciona una contraseña, incluirla\r\n          if (formData.value.password) {\r\n            userData.password = formData.value.password;\r\n          }\r\n          \r\n          const response = await updateUser(formData.value.id, userData);\r\n          \r\n          if (response && response.success) {\r\n            await alert(response.message || 'Usuario actualizado exitosamente');\r\n            // Refrescar lista de usuarios con los nuevos datos\r\n            await fetchUsers();\r\n          } else {\r\n            throw new Error(response?.message || 'Error al actualizar usuario');\r\n          }\r\n        } else {\r\n          // Crear nuevo usuario\r\n          const userData = {\r\n            nombre: formData.value.nombre,\r\n            email: formData.value.email,\r\n            password: formData.value.password,\r\n            telefono: formData.value.telefono,\r\n            roles: formData.value.roles\r\n          };\r\n          \r\n          console.log(\"Llamando a createUser con:\", userData);\r\n          try {\r\n            const response = await createUser(userData);\r\n            \r\n            if (response && response.success) {\r\n              await alert(response.message || 'Usuario creado exitosamente');\r\n              // Añadir directamente el usuario creado a la lista local\r\n              if (response.data) {\r\n                // Asegurarse de que response.data tenga el formato esperado\r\n                users.value.unshift(response.data);\r\n              }\r\n              // Y también refrescar la lista completa desde el servicio\r\n              await fetchUsers();\r\n            } else {\r\n              throw new Error(response?.message || 'Error al crear usuario');\r\n            }\r\n          } catch (createError) {\r\n            console.error('Error específico al crear usuario:', createError);\r\n            throw createError;\r\n          }\r\n        }\r\n        \r\n        closeModal();\r\n      } catch (err) {\r\n        console.error('Error al guardar el usuario:', err);\r\n        await alert(`Error al guardar el usuario: ${err.message || 'Error desconocido'}`);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    // Activar usuario\r\n    const activateUser = async (user) => {\r\n      try {\r\n        const confirmed = await confirm(`¿Estás seguro de que deseas activar el usuario ${user.nombre}?`);\r\n        \r\n        if (confirmed) {\r\n          loading.value = true;\r\n          \r\n          const response = await cambiarEstadoUsuario(user.id, 'activo');\r\n          \r\n          if (response && response.success) {\r\n            await alert(response.message || 'Usuario activado exitosamente');\r\n            fetchUsers(); // Refrescar lista\r\n          } else {\r\n            throw new Error(response?.message || 'Error al activar usuario');\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error('Error al activar usuario:', err);\r\n        await alert(`Error al activar usuario: ${err.message || 'Error desconocido'}`);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    // Desactivar usuario\r\n    const deactivateUser = async (user) => {\r\n      try {\r\n        const confirmed = await confirm(\r\n          `¿Estás seguro de que deseas desactivar el usuario ${user.nombre}? No podrá acceder al sistema mientras esté inactivo.`,\r\n          { title: 'Confirmar desactivación' }\r\n        );\r\n        \r\n        if (confirmed) {\r\n          loading.value = true;\r\n          \r\n          const response = await cambiarEstadoUsuario(user.id, 'inactivo');\r\n          \r\n          if (response && response.success) {\r\n            await alert(response.message || 'Usuario desactivado exitosamente');\r\n            fetchUsers(); // Refrescar lista\r\n          } else {\r\n            throw new Error(response?.message || 'Error al desactivar usuario');\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error('Error al desactivar usuario:', err);\r\n        await alert(`Error al desactivar usuario: ${err.message || 'Error desconocido'}`);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    // Eliminar usuario\r\n    const deleteUser = async (user) => {\r\n      try {\r\n        const confirmed = await confirm(\r\n          `¿Estás seguro de que deseas eliminar permanentemente el usuario ${user.nombre}? Esta acción no se puede deshacer.`,\r\n          { \r\n            title: 'Confirmar eliminación',\r\n            confirmText: 'Eliminar',\r\n            cancelText: 'Cancelar' \r\n          }\r\n        );\r\n        \r\n        if (confirmed) {\r\n          loading.value = true;\r\n          \r\n          const response = await removeUser(user.id);\r\n          \r\n          if (response && response.success) {\r\n            await alert(response.message || 'Usuario eliminado exitosamente');\r\n            fetchUsers(); // Refrescar lista\r\n          } else {\r\n            throw new Error(response?.message || 'Error al eliminar usuario');\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error('Error al eliminar usuario:', err);\r\n        await alert(`Error al eliminar usuario: ${err.message || 'Error desconocido'}`);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n    \r\n    // Cerrar modal\r\n    const closeModal = () => {\r\n      showModal.value = false;\r\n    };\r\n    \r\n    // Formatear fecha\r\n    const formatDate = (dateStr) => {\r\n      if (!dateStr) return 'N/A';\r\n      \r\n      try {\r\n        const date = new Date(dateStr);\r\n        if (isNaN(date.getTime())) return 'Fecha inválida';\r\n        \r\n        return new Intl.DateTimeFormat('es-ES', {\r\n          day: '2-digit',\r\n          month: '2-digit',\r\n          year: 'numeric',\r\n          hour: '2-digit',\r\n          minute: '2-digit'\r\n        }).format(date);\r\n      } catch (e) {\r\n        return 'Fecha inválida';\r\n      }\r\n    };\r\n    \r\n    return {\r\n      users,\r\n      roles,\r\n      loading,\r\n      error,\r\n      searchTerm,\r\n      roleFilter,\r\n      statusFilter,\r\n      showModal,\r\n      isEditing,\r\n      formData,\r\n      handleSearchInput,\r\n      fetchUsers,\r\n      resetFilters,\r\n      showCreateForm,\r\n      editUser,\r\n      saveUser,\r\n      activateUser,\r\n      deactivateUser,\r\n      deleteUser,\r\n      closeModal,\r\n      formatDate\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.users-container {\r\n  padding: 0;\r\n}\r\n\r\n.section-title {\r\n  font-size: 24px;\r\n  margin-bottom: 30px;\r\n  color: #333;\r\n  border-bottom: 2px solid #4CAF50;\r\n  padding-bottom: 10px;\r\n}\r\n\r\n/* Controles y filtros */\r\n.users-controls {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 15px;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.search-container {\r\n  flex-grow: 1;\r\n  min-width: 250px;\r\n}\r\n\r\n.search-input {\r\n  width: 100%;\r\n  padding: 10px 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n}\r\n\r\n.filters {\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n.filter-select {\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  background-color: white;\r\n}\r\n\r\n.actions {\r\n  margin-left: auto;\r\n}\r\n\r\n.create-user-btn {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 10px 15px;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 5px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.create-user-btn:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n.btn-icon {\r\n  font-size: 16px;\r\n}\r\n\r\n/* Estados de carga y error */\r\n.loading-container, .error-container, .empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 50px 20px;\r\n  text-align: center;\r\n  background-color: #f9f9f9;\r\n  border-radius: 8px;\r\n  margin: 20px 0;\r\n}\r\n\r\n.spinner {\r\n  border: 4px solid rgba(0, 0, 0, 0.1);\r\n  width: 36px;\r\n  height: 36px;\r\n  border-radius: 50%;\r\n  border-left-color: #4CAF50;\r\n  animation: spin 1s linear infinite;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n.error-message {\r\n  color: #f44336;\r\n  font-weight: bold;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.retry-btn {\r\n  background-color: #2196F3;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 10px 15px;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n}\r\n\r\n.retry-btn:hover {\r\n  background-color: #0b7dda;\r\n}\r\n\r\n.empty-icon {\r\n  font-size: 48px;\r\n  color: #ccc;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.empty-title {\r\n  font-size: 20px;\r\n  color: #666;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.empty-description {\r\n  color: #888;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.reset-filters-btn {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 10px 15px;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n}\r\n\r\n.reset-filters-btn:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n/* Tabla de usuarios */\r\n.users-table-container {\r\n  overflow-x: auto;\r\n  margin-top: 20px;\r\n}\r\n\r\n.users-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n}\r\n\r\n.users-table th, .users-table td {\r\n  padding: 15px;\r\n  text-align: left;\r\n}\r\n\r\n.users-table th {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  font-weight: normal;\r\n}\r\n\r\n.users-table tr:nth-child(even) {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.users-table tr:hover {\r\n  background-color: #f1f1f1;\r\n}\r\n\r\n.inactive-user {\r\n  opacity: 0.7;\r\n  background-color: #f5f5f5 !important;\r\n}\r\n\r\n/* Badges */\r\n.roles-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 5px;\r\n}\r\n\r\n.role-badge {\r\n  padding: 3px 8px;\r\n  border-radius: 20px;\r\n  font-size: 12px;\r\n  background-color: #e0e0e0;\r\n  color: #333;\r\n}\r\n\r\n.admin-role {\r\n  background-color: #2196F3;\r\n  color: white;\r\n}\r\n\r\n.superadmin-role {\r\n  background-color: #673AB7;\r\n  color: white;\r\n}\r\n\r\n.status-badge {\r\n  padding: 3px 8px;\r\n  border-radius: 20px;\r\n  font-size: 12px;\r\n}\r\n\r\n.active-status {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\n.inactive-status {\r\n  background-color: #f44336;\r\n  color: white;\r\n}\r\n\r\n/* Botones de acción */\r\n.action-buttons {\r\n  display: flex;\r\n  gap: 5px;\r\n}\r\n\r\n.edit-btn, .activate-btn, .deactivate-btn, .delete-btn {\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: 50%;\r\n  border: none;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.edit-btn {\r\n  background-color: #2196F3;\r\n  color: white;\r\n}\r\n\r\n.edit-btn:hover {\r\n  background-color: #0b7dda;\r\n}\r\n\r\n.activate-btn {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\n.activate-btn:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n.deactivate-btn {\r\n  background-color: #FF9800;\r\n  color: white;\r\n}\r\n\r\n.deactivate-btn:hover {\r\n  background-color: #e68a00;\r\n}\r\n\r\n.delete-btn {\r\n  background-color: #f44336;\r\n  color: white;\r\n}\r\n\r\n.delete-btn:hover {\r\n  background-color: #d32f2f;\r\n}\r\n\r\n/* Modal */\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-container {\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\r\n  width: 90%;\r\n  max-width: 500px;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n  animation: modalFadeIn 0.3s;\r\n}\r\n\r\n@keyframes modalFadeIn {\r\n  from { opacity: 0; transform: translateY(-20px); }\r\n  to { opacity: 1; transform: translateY(0); }\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 15px 20px;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.modal-header h3 {\r\n  margin: 0;\r\n  color: #333;\r\n}\r\n\r\n.close-btn {\r\n  background: none;\r\n  border: none;\r\n  font-size: 24px;\r\n  cursor: pointer;\r\n  color: #999;\r\n}\r\n\r\n.close-btn:hover {\r\n  color: #666;\r\n}\r\n\r\n.modal-body {\r\n  padding: 20px;\r\n}\r\n\r\n/* Formulario */\r\n.user-form {\r\n  display: grid;\r\n  gap: 15px;\r\n}\r\n\r\n.form-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 5px;\r\n}\r\n\r\n.form-group label {\r\n  color: #666;\r\n  font-weight: 600;\r\n}\r\n\r\n.form-group input, .form-group select {\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n}\r\n\r\n.form-group input:focus, .form-group select:focus {\r\n  outline: none;\r\n  border-color: #4CAF50;\r\n}\r\n\r\n.form-group input:disabled {\r\n  background-color: #f5f5f5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.roles-checkboxes {\r\n  display: grid;\r\n  gap: 10px;\r\n}\r\n\r\n.role-checkbox {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.role-checkbox input[type=\"checkbox\"] {\r\n  width: auto;\r\n  margin: 0;\r\n}\r\n\r\n.form-buttons {\r\n  display: flex;\r\n  gap: 10px;\r\n  margin-top: 10px;\r\n}\r\n\r\n.cancel-btn, .save-btn {\r\n  padding: 10px 15px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n  flex: 1;\r\n}\r\n\r\n.cancel-btn {\r\n  background-color: #f1f1f1;\r\n  color: #333;\r\n}\r\n\r\n.cancel-btn:hover {\r\n  background-color: #e1e1e1;\r\n}\r\n\r\n.save-btn {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\n.save-btn:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .users-controls {\r\n    flex-direction: column;\r\n  }\r\n  \r\n  .actions {\r\n    margin-left: 0;\r\n    width: 100%;\r\n  }\r\n  \r\n  .create-user-btn {\r\n    width: 100%;\r\n  }\r\n  \r\n  .users-table th, .users-table td {\r\n    padding: 10px;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}