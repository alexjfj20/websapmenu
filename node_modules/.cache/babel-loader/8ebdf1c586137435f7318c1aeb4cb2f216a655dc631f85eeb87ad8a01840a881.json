{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { saveMenu } from '../services/menuService';\nimport { formatShareLinkMessage } from '../utils/messageFormatter';\nimport SalesChartComponent from './SalesChartComponent.vue';\nimport { saveAs } from 'file-saver';\nimport * as XLSX from 'xlsx';\nimport { jsPDF } from 'jspdf';\nimport 'jspdf-autotable';\nimport { getMenuItems, saveMenuItems, getBusinessInfo, saveBusinessInfo as saveBusinessInfoToDB, getSoldItems, saveSoldItems, deleteMenuItemFromDB, migrateFromLocalStorage, compressImage } from '../services/storageService';\nimport { confirm, alert } from '../services/dialogService';\nexport default {\n  name: 'MenuComponent',\n  components: {\n    SalesChartComponent\n  },\n  setup() {\n    // Estado para información del negocio\n    const businessInfo = ref({\n      name: '',\n      description: '',\n      contact: '',\n      address: '',\n      logo: ''\n    });\n    const showBusinessForm = ref(false);\n\n    // Estado para información de pago\n    const paymentInfo = ref({\n      qrTitle: '',\n      qrImage: '',\n      nequiNumber: '',\n      nequiImage: ''\n    });\n    const showPaymentForm = ref(false);\n\n    // Estado para platos del menú\n    const newItem = ref({\n      name: '',\n      description: '',\n      price: 0,\n      includesDrink: false,\n      availableQuantity: 0,\n      image: '',\n      id: null\n    });\n    const menuItems = ref([]);\n    const showMenuForm = ref(false);\n    const isEditing = ref(false);\n    const editingIndex = ref(-1);\n\n    // Estado para ventas e inventario\n    const soldItems = ref([]);\n    const searchTerm = ref('');\n    const sortBy = ref('');\n    const categoryFilter = ref('');\n    const selectedChartType = ref('bar');\n\n    // Estado para compartir\n    const shareLink = ref('');\n    const showCopiedMessage = ref(false);\n\n    // Estado para mostrar progreso de migración\n    const migrationStatus = ref({\n      inProgress: false,\n      completed: false,\n      message: ''\n    });\n\n    // Estado para errores del gráfico\n    const chartError = ref(null);\n\n    // Manejar errores del gráfico\n    const handleChartError = error => {\n      console.error(\"Error en el gráfico:\", error);\n      chartError.value = error;\n    };\n\n    // Estado para mensajes de notificación\n    const notification = ref({\n      show: false,\n      message: '',\n      type: 'success',\n      // 'success', 'error'\n      timeout: null\n    });\n\n    // Estado para platos especiales\n    const newSpecialItem = ref({\n      name: '',\n      description: '',\n      price: 0,\n      includesDrink: false,\n      availableQuantity: 0,\n      image: '',\n      id: null\n    });\n    const specialMenuItems = ref([]);\n    const showSpecialMenuForm = ref(false);\n    const isEditingSpecial = ref(false);\n    const editingSpecialIndex = ref(-1);\n\n    // Cargar datos guardados\n    onMounted(async () => {\n      try {\n        migrationStatus.value.inProgress = true;\n        migrationStatus.value.message = 'Cargando datos...';\n        const hasLocalData = localStorage.getItem('businessInfo') || localStorage.getItem('menuItems') || localStorage.getItem('soldItems');\n        if (hasLocalData) {\n          migrationStatus.value.message = 'Migrando datos desde localStorage a IndexedDB...';\n          const migrationResult = await migrateFromLocalStorage();\n          if (migrationResult) {\n            migrationStatus.value.completed = true;\n            migrationStatus.value.message = 'Migración completada exitosamente';\n            localStorage.removeItem('businessInfo');\n            localStorage.removeItem('menuItems');\n            localStorage.removeItem('soldItems');\n          } else {\n            migrationStatus.value.message = 'Error en la migración de datos';\n          }\n        }\n        const dbBusinessInfo = await getBusinessInfo();\n        if (dbBusinessInfo && dbBusinessInfo.name) {\n          businessInfo.value = dbBusinessInfo;\n        }\n        const dbMenuItems = await getMenuItems();\n        if (dbMenuItems && dbMenuItems.length > 0) {\n          menuItems.value = dbMenuItems;\n\n          // Filtrar los platos especiales del menú regular\n          const specialItems = dbMenuItems.filter(item => item.isSpecial === true);\n          if (specialItems.length > 0) {\n            specialMenuItems.value = specialItems;\n          }\n        }\n        const dbSoldItems = await getSoldItems();\n        if (dbSoldItems && dbSoldItems.length > 0) {\n          soldItems.value = dbSoldItems;\n        }\n        setTimeout(() => {\n          migrationStatus.value.inProgress = false;\n        }, 1500);\n      } catch (error) {\n        console.error('Error al cargar datos:', error);\n        migrationStatus.value.message = 'Error al cargar datos: ' + error.message;\n        setTimeout(() => {\n          migrationStatus.value.inProgress = false;\n        }, 3000);\n      }\n    });\n\n    // Métodos para información del negocio\n    const toggleBusinessForm = () => {\n      showBusinessForm.value = !showBusinessForm.value;\n    };\n    const onLogoChange = async event => {\n      const file = event.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = async e => {\n          const compressedLogo = await compressImage(e.target.result);\n          businessInfo.value.logo = compressedLogo;\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    const saveBusinessInfo = async () => {\n      try {\n        if (notification.value.timeout) {\n          clearTimeout(notification.value.timeout);\n        }\n        await saveBusinessInfoToDB(businessInfo.value);\n        notification.value = {\n          show: true,\n          message: 'Información del negocio guardada con éxito!',\n          type: 'success',\n          timeout: setTimeout(() => {\n            notification.value.show = false;\n          }, 3000)\n        };\n      } catch (error) {\n        console.error('Error al guardar información del negocio:', error);\n        notification.value = {\n          show: true,\n          message: 'Error al guardar la información. Por favor, intenta nuevamente.',\n          type: 'error',\n          timeout: setTimeout(() => {\n            notification.value.show = false;\n          }, 3000)\n        };\n      }\n    };\n    const clearBusinessForm = async () => {\n      const confirmed = await confirm('¿Estás seguro de querer limpiar el formulario?');\n      if (confirmed) {\n        businessInfo.value = {\n          name: '',\n          description: '',\n          contact: '',\n          address: '',\n          logo: ''\n        };\n      }\n    };\n\n    // Métodos para información de pago\n    const togglePaymentForm = () => {\n      showPaymentForm.value = !showPaymentForm.value;\n    };\n    const onQRImageChange = async event => {\n      const file = event.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = async e => {\n          const compressedImage = await compressImage(e.target.result);\n          paymentInfo.value.qrImage = compressedImage;\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    const onNequiImageChange = async event => {\n      const file = event.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = async e => {\n          const compressedImage = await compressImage(e.target.result);\n          paymentInfo.value.nequiImage = compressedImage;\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    const savePaymentInfo = async () => {\n      try {\n        if (notification.value.timeout) {\n          clearTimeout(notification.value.timeout);\n        }\n        businessInfo.value.paymentInfo = {\n          ...paymentInfo.value\n        };\n        await saveBusinessInfoToDB(businessInfo.value);\n        notification.value = {\n          show: true,\n          message: 'Información de pago guardada con éxito!',\n          type: 'success',\n          timeout: setTimeout(() => {\n            notification.value.show = false;\n          }, 3000)\n        };\n      } catch (error) {\n        console.error('Error al guardar información de pago:', error);\n        notification.value = {\n          show: true,\n          message: 'Error al guardar la información de pago. Por favor, intenta nuevamente.',\n          type: 'error',\n          timeout: setTimeout(() => {\n            notification.value.show = false;\n          }, 3000)\n        };\n      }\n    };\n    const clearPaymentForm = async () => {\n      const confirmed = await confirm('¿Estás seguro de querer limpiar la información de pago?');\n      if (confirmed) {\n        paymentInfo.value = {\n          qrTitle: '',\n          qrImage: '',\n          nequiNumber: '',\n          nequiImage: ''\n        };\n      }\n    };\n\n    // Métodos para platos del menú\n    const toggleMenuForm = () => {\n      showMenuForm.value = !showMenuForm.value;\n      if (!showMenuForm.value) {\n        clearMenuForm();\n      }\n    };\n    const onImageChange = async event => {\n      const file = event.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = async e => {\n          const compressedImage = await compressImage(e.target.result);\n          newItem.value.image = compressedImage;\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    const saveMenuItem = async () => {\n      try {\n        if (!newItem.value.id) {\n          newItem.value.id = Date.now() + Math.random().toString(36).substring(2, 10);\n        }\n        if (isEditing.value) {\n          const index = menuItems.value.findIndex(item => item.id === newItem.value.id);\n          if (index !== -1) {\n            menuItems.value[index] = {\n              ...newItem.value\n            };\n          }\n          isEditing.value = false;\n          editingIndex.value = -1;\n          await alert('Plato actualizado con éxito!');\n        } else {\n          const existingItem = menuItems.value.find(item => item.name.toLowerCase() === newItem.value.name.toLowerCase());\n          if (existingItem) {\n            const confirmed = await confirm(`Ya existe un plato llamado \"${newItem.value.name}\". ¿Desea actualizarlo?`, {\n              title: 'Actualizar plato existente'\n            });\n            if (confirmed) {\n              const index = menuItems.value.findIndex(item => item.id === existingItem.id);\n              if (index !== -1) {\n                newItem.value.id = existingItem.id;\n                menuItems.value[index] = {\n                  ...newItem.value\n                };\n                await alert('Plato actualizado con éxito!');\n              }\n            } else {\n              return;\n            }\n          } else {\n            menuItems.value.push({\n              ...newItem.value\n            });\n            await alert('Plato creado con éxito!');\n          }\n        }\n\n        // Guardar todos los platos (regulares y especiales) en una sola colección\n        const allItems = [...menuItems.value.filter(item => !item.isSpecial), ...specialMenuItems.value];\n        await saveMenuItems(allItems);\n        clearMenuForm();\n      } catch (error) {\n        console.error('Error al guardar el plato:', error);\n        await alert('Error al guardar el plato. Por favor, intenta nuevamente.');\n      }\n    };\n    const clearMenuForm = () => {\n      newItem.value = {\n        name: '',\n        description: '',\n        price: 0,\n        includesDrink: false,\n        availableQuantity: 0,\n        image: '',\n        id: null\n      };\n      isEditing.value = false;\n      editingIndex.value = -1;\n    };\n    const editMenuItem = index => {\n      newItem.value = {\n        ...menuItems.value[index]\n      };\n      isEditing.value = true;\n      editingIndex.value = index;\n      showMenuForm.value = true;\n    };\n    const deleteMenuItem = async index => {\n      const confirmed = await confirm('¿Estás seguro de querer eliminar este plato?', {\n        title: 'Eliminar plato',\n        confirmText: 'Eliminar',\n        cancelText: 'Cancelar'\n      });\n      if (confirmed) {\n        try {\n          if (index < 0 || index >= menuItems.value.length) {\n            console.error('Error: Índice fuera de rango', index);\n            await alert('Error: No se encontró el elemento a eliminar');\n            return;\n          }\n          const item = menuItems.value[index];\n          console.log(`Eliminando plato: índice=${index}, nombre=${item.name}, id=${item.id}`);\n          if (!item) {\n            console.error('Error: Elemento del menú no encontrado en el índice', index);\n            await alert('Error: No se encontró el elemento a eliminar');\n            return;\n          }\n          const itemName = item.name || 'Producto sin nombre';\n          const currentDate = new Date().toISOString();\n          if (!Array.isArray(soldItems.value)) {\n            console.warn('soldItems.value no es un array, inicializando como array vacío');\n            soldItems.value = [];\n          }\n          const soldItem = soldItems.value.find(sold => sold && typeof sold === 'object' && sold.name === itemName);\n          if (soldItem) {\n            soldItem.quantity += 1;\n            if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\n              soldItem.date = currentDate;\n            }\n          } else {\n            const newSoldItem = {\n              name: itemName,\n              quantity: 1,\n              price: Number(item.price) || 0,\n              includesDrink: Boolean(item.includesDrink),\n              date: currentDate\n            };\n            soldItems.value.push(newSoldItem);\n          }\n          const cleanSoldItems = soldItems.value.map(item => {\n            if (!item || typeof item !== 'object') {\n              return {\n                name: 'Producto desconocido',\n                quantity: 1,\n                price: 0,\n                includesDrink: false,\n                date: currentDate\n              };\n            }\n            return {\n              name: String(item.name || 'Producto desconocido'),\n              quantity: Number(item.quantity) || 1,\n              price: Number(item.price) || 0,\n              includesDrink: Boolean(item.includesDrink),\n              date: item.date || currentDate\n            };\n          });\n          await saveSoldItems(cleanSoldItems);\n          if (item.id) {\n            try {\n              console.log(`Llamando a deleteMenuItemFromDB para ID: ${item.id}`);\n              const deleteResult = await deleteMenuItemFromDB(item.id);\n              console.log(`Resultado de la eliminación: ${deleteResult}`);\n            } catch (deleteError) {\n              console.error('Error al eliminar item del almacén:', deleteError);\n            }\n          }\n          menuItems.value.splice(index, 1);\n          soldItems.value = cleanSoldItems;\n          console.log('Elemento eliminado correctamente del menú local');\n        } catch (error) {\n          console.error('Error al eliminar el plato:', error);\n          await alert('Error al eliminar el plato. Por favor, intenta nuevamente.');\n        }\n      }\n    };\n    const sellMenuItem = async index => {\n      try {\n        const item = menuItems.value[index];\n        if (item.availableQuantity <= 0) {\n          await alert('No hay unidades disponibles de este plato.');\n          return;\n        }\n        item.availableQuantity--;\n        const soldItem = soldItems.value.find(sold => sold.name === item.name);\n        const currentDate = new Date().toISOString();\n        if (soldItem) {\n          soldItem.quantity += 1;\n          if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\n            soldItem.date = currentDate;\n          }\n        } else {\n          const newSoldItem = {\n            name: item.name || 'Producto sin nombre',\n            quantity: 1,\n            price: Number(item.price) || 0,\n            includesDrink: Boolean(item.includesDrink),\n            date: currentDate\n          };\n          soldItems.value.push(newSoldItem);\n        }\n        const cleanSoldItems = soldItems.value.map(item => ({\n          name: String(item.name || 'Producto desconocido'),\n          quantity: Number(item.quantity) || 1,\n          price: Number(item.price) || 0,\n          includesDrink: Boolean(item.includesDrink),\n          date: item.date || currentDate\n        }));\n        await saveMenuItems(menuItems.value);\n        await saveSoldItems(cleanSoldItems);\n        soldItems.value = cleanSoldItems;\n        await alert(`Se ha vendido una unidad de \"${item.name}\"`);\n      } catch (error) {\n        console.error('Error al vender el plato:', error);\n        await alert('Error al procesar la venta. Por favor, intenta nuevamente.');\n      }\n    };\n\n    // Métodos para platos especiales\n    const toggleSpecialMenuForm = () => {\n      showSpecialMenuForm.value = !showSpecialMenuForm.value;\n      if (!showSpecialMenuForm.value) {\n        clearSpecialMenuForm();\n      }\n    };\n    const onSpecialImageChange = async event => {\n      const file = event.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = async e => {\n          const compressedImage = await compressImage(e.target.result);\n          newSpecialItem.value.image = compressedImage;\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    const saveSpecialMenuItem = async () => {\n      try {\n        if (!newSpecialItem.value.id) {\n          newSpecialItem.value.id = Date.now() + Math.random().toString(36).substring(2, 10);\n        }\n\n        // Marcar el plato como especial\n        newSpecialItem.value.isSpecial = true;\n        if (isEditingSpecial.value) {\n          const index = specialMenuItems.value.findIndex(item => item.id === newSpecialItem.value.id);\n          if (index !== -1) {\n            specialMenuItems.value[index] = {\n              ...newSpecialItem.value\n            };\n          }\n          isEditingSpecial.value = false;\n          editingSpecialIndex.value = -1;\n          await alert('Plato especial actualizado con éxito!');\n        } else {\n          const existingItem = specialMenuItems.value.find(item => item.name.toLowerCase() === newSpecialItem.value.name.toLowerCase());\n          if (existingItem) {\n            const confirmed = await confirm(`Ya existe un plato especial llamado \"${newSpecialItem.value.name}\". ¿Desea actualizarlo?`, {\n              title: 'Actualizar plato especial existente'\n            });\n            if (confirmed) {\n              const index = specialMenuItems.value.findIndex(item => item.id === existingItem.id);\n              if (index !== -1) {\n                newSpecialItem.value.id = existingItem.id;\n                specialMenuItems.value[index] = {\n                  ...newSpecialItem.value\n                };\n                await alert('Plato especial actualizado con éxito!');\n              }\n            } else {\n              return;\n            }\n          } else {\n            specialMenuItems.value.push({\n              ...newSpecialItem.value\n            });\n            await alert('Plato especial creado con éxito!');\n          }\n        }\n\n        // Guardar todos los platos (regulares y especiales) en una sola colección\n        const allItems = [...menuItems.value.filter(item => !item.isSpecial), ...specialMenuItems.value];\n        await saveMenuItems(allItems);\n        clearSpecialMenuForm();\n      } catch (error) {\n        console.error('Error al guardar el plato especial:', error);\n        await alert('Error al guardar el plato especial. Por favor, intenta nuevamente.');\n      }\n    };\n    const clearSpecialMenuForm = () => {\n      newSpecialItem.value = {\n        name: '',\n        description: '',\n        price: 0,\n        includesDrink: false,\n        availableQuantity: 0,\n        image: '',\n        id: null\n      };\n      isEditingSpecial.value = false;\n      editingSpecialIndex.value = -1;\n    };\n    const editSpecialMenuItem = index => {\n      newSpecialItem.value = {\n        ...specialMenuItems.value[index]\n      };\n      isEditingSpecial.value = true;\n      editingSpecialIndex.value = index;\n      showSpecialMenuForm.value = true;\n    };\n    const deleteSpecialMenuItem = async index => {\n      const confirmed = await confirm('¿Estás seguro de querer eliminar este plato especial?', {\n        title: 'Eliminar plato especial',\n        confirmText: 'Eliminar',\n        cancelText: 'Cancelar'\n      });\n      if (confirmed) {\n        try {\n          if (index < 0 || index >= specialMenuItems.value.length) {\n            console.error('Error: Índice fuera de rango', index);\n            await alert('Error: No se encontró el elemento a eliminar');\n            return;\n          }\n          const item = specialMenuItems.value[index];\n          console.log(`Eliminando plato especial: índice=${index}, nombre=${item.name}, id=${item.id}`);\n          if (!item) {\n            console.error('Error: Elemento del menú especial no encontrado en el índice', index);\n            await alert('Error: No se encontró el elemento a eliminar');\n            return;\n          }\n          const itemName = item.name || 'Producto desconocido';\n          const currentDate = new Date().toISOString();\n          if (!Array.isArray(soldItems.value)) {\n            console.warn('soldItems.value no es un array, inicializando como array vacío');\n            soldItems.value = [];\n          }\n          const soldItem = soldItems.value.find(sold => sold && typeof sold === 'object' && sold.name === itemName);\n          if (soldItem) {\n            soldItem.quantity += 1;\n            if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\n              soldItem.date = currentDate;\n            }\n          } else {\n            const newSoldItem = {\n              name: itemName,\n              quantity: 1,\n              price: Number(item.price) || 0,\n              includesDrink: Boolean(item.includesDrink),\n              date: currentDate\n            };\n            soldItems.value.push(newSoldItem);\n          }\n          const cleanSoldItems = soldItems.value.map(item => {\n            if (!item || typeof item !== 'object') {\n              return {\n                name: 'Producto desconocido',\n                quantity: 1,\n                price: 0,\n                includesDrink: false,\n                date: currentDate\n              };\n            }\n            return {\n              name: String(item.name || 'Producto desconocido'),\n              quantity: Number(item.quantity) || 1,\n              price: Number(item.price) || 0,\n              includesDrink: Boolean(item.includesDrink),\n              date: item.date || currentDate\n            };\n          });\n          await saveSoldItems(cleanSoldItems);\n          if (item.id) {\n            try {\n              console.log(`Llamando a deleteMenuItemFromDB para ID: ${item.id}`);\n              const deleteResult = await deleteMenuItemFromDB(item.id);\n              console.log(`Resultado de la eliminación: ${deleteResult}`);\n            } catch (deleteError) {\n              console.error('Error al eliminar item del almacén:', deleteError);\n            }\n          }\n          specialMenuItems.value.splice(index, 1);\n          soldItems.value = cleanSoldItems;\n\n          // Actualizar la colección completa después de eliminar\n          const allItems = [...menuItems.value.filter(item => !item.isSpecial), ...specialMenuItems.value];\n          await saveMenuItems(allItems);\n          console.log('Elemento eliminado correctamente del menú especial');\n        } catch (error) {\n          console.error('Error al eliminar el plato especial:', error);\n          await alert('Error al eliminar el plato especial. Por favor, intenta nuevamente.');\n        }\n      }\n    };\n    const sellSpecialMenuItem = async index => {\n      try {\n        const item = specialMenuItems.value[index];\n        if (item.availableQuantity <= 0) {\n          await alert('No hay unidades disponibles de este plato especial.');\n          return;\n        }\n        item.availableQuantity--;\n        const soldItem = soldItems.value.find(sold => sold.name === item.name);\n        const currentDate = new Date().toISOString();\n        if (soldItem) {\n          soldItem.quantity += 1;\n          if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\n            soldItem.date = currentDate;\n          }\n        } else {\n          const newSoldItem = {\n            name: item.name || 'Producto sin nombre',\n            quantity: 1,\n            price: Number(item.price) || 0,\n            includesDrink: Boolean(item.includesDrink),\n            date: currentDate\n          };\n          soldItems.value.push(newSoldItem);\n        }\n        const cleanSoldItems = soldItems.value.map(item => ({\n          name: String(item.name || 'Producto desconocido'),\n          quantity: Number(item.quantity) || 1,\n          price: Number(item.price) || 0,\n          includesDrink: Boolean(item.includesDrink),\n          date: item.date || currentDate\n        }));\n\n        // Guardar todos los platos (regulares y especiales) en una sola colección\n        const allItems = [...menuItems.value.filter(item => !item.isSpecial), ...specialMenuItems.value];\n        await saveMenuItems(allItems);\n        await saveSoldItems(cleanSoldItems);\n        soldItems.value = cleanSoldItems;\n        await alert(`Se ha vendido una unidad de \"${item.name}\"`);\n      } catch (error) {\n        console.error('Error al vender el plato especial:', error);\n        await alert('Error al procesar la venta. Por favor, intenta nuevamente.');\n      }\n    };\n\n    // Métodos para compartir\n    const shareByWhatsApp = async () => {\n      try {\n        await alert('Procesando imágenes para compartir...');\n        if (menuItems.value.length > 30) {\n          await alert('El menú tiene demasiados elementos. Por favor, seleccione menos platos para compartir.');\n          return;\n        }\n        const itemsToShare = menuItems.value.map(item => ({\n          id: item.id,\n          name: item.name,\n          description: item.description,\n          price: item.price,\n          includesDrink: item.includesDrink,\n          image: item.image\n        }));\n        console.log(`Preparando para compartir ${itemsToShare.length} elementos...`);\n        const menuId = await saveMenu(itemsToShare);\n        const url = `${window.location.origin}/menu/${menuId}`;\n        shareLink.value = url;\n        const message = formatShareLinkMessage(url, businessInfo.value.name);\n        const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;\n        window.open(whatsappUrl, '_blank');\n      } catch (error) {\n        console.error('Error al compartir por WhatsApp:', error);\n        await alert(`Error al compartir el menú: ${error.message || 'Error desconocido'}. Por favor, intenta reducir el tamaño de las imágenes o eliminar algunos ítems.`);\n      }\n    };\n    const copyLink = async () => {\n      try {\n        const loadingMessage = 'Procesando imágenes para compartir...';\n        showCopiedMessage.value = true;\n        if (menuItems.value.length > 30) {\n          await alert('El menú tiene demasiados elementos. Por favor, seleccione menos platos para compartir.');\n          showCopiedMessage.value = false;\n          return;\n        }\n        const itemsToShare = menuItems.value.map(item => ({\n          id: item.id,\n          name: item.name,\n          description: item.description,\n          price: item.price,\n          includesDrink: item.includesDrink,\n          image: item.image\n        }));\n        const menuId = await saveMenu(itemsToShare);\n        const url = `${window.location.origin}/menu/${menuId}`;\n        shareLink.value = url;\n        try {\n          await navigator.clipboard.writeText(url);\n          showCopiedMessage.value = true;\n          setTimeout(() => {\n            showCopiedMessage.value = false;\n          }, 3000);\n        } catch (clipboardError) {\n          console.error('Error al copiar al portapapeles:', clipboardError);\n          await alert('No se pudo copiar automáticamente. Por favor, copia manualmente este enlace: ' + url);\n        }\n      } catch (error) {\n        console.error('Error al generar enlace para compartir:', error);\n        showCopiedMessage.value = false;\n        await alert(`Error al generar el enlace: ${error.message || 'Error desconocido'}. Por favor, intenta reducir el tamaño de las imágenes o eliminar algunos ítems.`);\n      }\n    };\n\n    // Computados\n    const totalSales = computed(() => {\n      return soldItems.value.reduce((total, item) => {\n        return total + item.quantity * item.price;\n      }, 0);\n    });\n    const formatPrice = price => {\n      if (isNaN(Number(price))) return '0,00';\n      const fixed = Number(price).toFixed(2);\n      const [intPart, decPart] = fixed.split('.');\n      const formattedIntPart = intPart.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\n      return `${formattedIntPart},${decPart}`;\n    };\n    const formatDate = dateStr => {\n      if (!dateStr) return 'N/A';\n      const date = new Date(dateStr);\n      if (isNaN(date.getTime())) return 'Fecha inválida';\n      return new Intl.DateTimeFormat('es-ES', {\n        day: '2-digit',\n        month: '2-digit',\n        year: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      }).format(date);\n    };\n    const filteredSoldItems = computed(() => {\n      let items = soldItems.value;\n      if (!Array.isArray(items)) {\n        console.warn('soldItems no es un array. Devolviendo array vacío.');\n        return [];\n      }\n      if (searchTerm.value) {\n        const term = searchTerm.value.toLowerCase();\n        items = items.filter(item => {\n          return item && item.name && typeof item.name === 'string' && item.name.toLowerCase().includes(term);\n        });\n      }\n      if (categoryFilter.value) {\n        if (categoryFilter.value === 'drinks') {\n          items = items.filter(item => Boolean(item && item.includesDrink));\n        } else if (categoryFilter.value === 'nodrinks') {\n          items = items.filter(item => item && item.includesDrink === false);\n        }\n      }\n      if (sortBy.value) {\n        items = [...items];\n        switch (sortBy.value) {\n          case 'name':\n            items.sort((a, b) => {\n              if (!a || !a.name) return 1;\n              if (!b || !b.name) return -1;\n              return a.name.localeCompare(b.name);\n            });\n            break;\n          case 'quantity-desc':\n            items.sort((a, b) => {\n              const qtyA = a && typeof a.quantity === 'number' ? a.quantity : 0;\n              const qtyB = b && typeof b.quantity === 'number' ? b.quantity : 0;\n              return qtyB - qtyA;\n            });\n            break;\n          case 'quantity-asc':\n            items.sort((a, b) => {\n              const qtyA = a && typeof a.quantity === 'number' ? a.quantity : 0;\n              const qtyB = b && typeof b.quantity === 'number' ? b.quantity : 0;\n              return qtyA - qtyB;\n            });\n            break;\n          case 'price-desc':\n            items.sort((a, b) => {\n              const priceA = a && typeof a.price === 'number' ? a.price : 0;\n              const priceB = b && typeof b.price === 'number' ? b.price : 0;\n              return priceB - priceA;\n            });\n            break;\n          case 'price-asc':\n            items.sort((a, b) => {\n              const priceA = a && typeof a.price === 'number' ? a.price : 0;\n              const priceB = b && typeof b.price === 'number' ? b.price : 0;\n              return priceA - priceB;\n            });\n            break;\n          case 'date-desc':\n            items.sort((a, b) => {\n              const dateA = a && a.date ? new Date(a.date) : new Date(0);\n              const dateB = b && b.date ? new Date(b.date) : new Date(0);\n              return dateB - dateA;\n            });\n            break;\n          case 'date-asc':\n            items.sort((a, b) => {\n              const dateA = a && a.date ? new Date(a.date) : new Date(0);\n              const dateB = b && b.date ? new Date(b.date) : new Date(0);\n              return dateA - dateB;\n            });\n            break;\n          default:\n            break;\n        }\n      }\n      return items;\n    });\n    const exportToExcel = () => {\n      // Crear un array con los datos a exportar\n      const data = [['Nombre del Plato', 'Categoría', 'Cantidad Vendida', 'Precio por Unidad', 'Fecha de Venta', 'Subtotal'], ...filteredSoldItems.value.map(item => [item.name, item.includesDrink ? 'Con refresco' : 'Sin refresco', item.quantity, `$${formatPrice(item.price)}`, formatDate(item.date), `$${formatPrice(item.quantity * item.price)}`]), ['', '', '', '', 'Total', `$${formatPrice(totalSales.value)}`]];\n\n      // Crear un libro de Excel y una hoja de cálculo\n      const ws = XLSX.utils.aoa_to_sheet(data);\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, 'Ventas');\n\n      // Generar el archivo Excel y descargarlo\n      const excelBuffer = XLSX.write(wb, {\n        bookType: 'xlsx',\n        type: 'array'\n      });\n      const blob = new Blob([excelBuffer], {\n        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n      });\n      saveAs(blob, `ventas_${new Date().toLocaleDateString()}.xlsx`);\n    };\n    const exportToPDF = () => {\n      // Crear un nuevo documento PDF\n      const doc = new jsPDF();\n\n      // Añadir título\n      doc.setFontSize(18);\n      doc.text('Reporte de Ventas', 14, 22);\n      doc.setFontSize(11);\n      doc.text(`Fecha: ${new Date().toLocaleDateString()}`, 14, 32);\n\n      // Crear la tabla con los datos\n      const tableData = filteredSoldItems.value.map(item => [item.name, item.includesDrink ? 'Con refresco' : 'Sin refresco', item.quantity, `$${formatPrice(item.price)}`, formatDate(item.date), `$${formatPrice(item.quantity * item.price)}`]);\n\n      // Añadir la tabla\n      doc.autoTable({\n        head: [['Nombre del Plato', 'Categoría', 'Cantidad Vendida', 'Precio por Unidad', 'Fecha de Venta', 'Subtotal']],\n        body: tableData,\n        foot: [['', '', '', '', 'Total', `$${formatPrice(totalSales.value)}`]],\n        startY: 40,\n        theme: 'striped',\n        headStyles: {\n          fillColor: [76, 175, 80]\n        },\n        footStyles: {\n          fillColor: [240, 240, 240],\n          textColor: [0, 0, 0],\n          fontStyle: 'bold'\n        }\n      });\n\n      // Guardar el PDF de exportación\n      doc.save(`ventas_${new Date().toLocaleDateString()}.pdf`);\n    };\n    const removeDuplicates = array => {\n      return [...new Set(array)];\n    };\n    return {\n      businessInfo,\n      showBusinessForm,\n      toggleBusinessForm,\n      onLogoChange,\n      saveBusinessInfo,\n      clearBusinessForm,\n      paymentInfo,\n      showPaymentForm,\n      togglePaymentForm,\n      onQRImageChange,\n      onNequiImageChange,\n      savePaymentInfo,\n      clearPaymentForm,\n      newItem,\n      menuItems,\n      showMenuForm,\n      isEditing,\n      toggleMenuForm,\n      onImageChange,\n      saveMenuItem,\n      editMenuItem,\n      deleteMenuItem,\n      sellMenuItem,\n      clearMenuForm,\n      soldItems,\n      totalSales,\n      searchTerm,\n      sortBy,\n      categoryFilter,\n      filteredSoldItems,\n      formatPrice,\n      selectedChartType,\n      exportToExcel,\n      exportToPDF,\n      shareLink,\n      showCopiedMessage,\n      shareByWhatsApp,\n      copyLink,\n      migrationStatus,\n      removeDuplicates,\n      chartError,\n      handleChartError,\n      notification,\n      formatDate,\n      newSpecialItem,\n      specialMenuItems,\n      showSpecialMenuForm,\n      isEditingSpecial,\n      editingSpecialIndex,\n      toggleSpecialMenuForm,\n      onSpecialImageChange,\n      saveSpecialMenuItem,\n      clearSpecialMenuForm,\n      editSpecialMenuItem,\n      deleteSpecialMenuItem,\n      sellSpecialMenuItem\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","saveMenu","formatShareLinkMessage","SalesChartComponent","saveAs","XLSX","jsPDF","getMenuItems","saveMenuItems","getBusinessInfo","saveBusinessInfo","saveBusinessInfoToDB","getSoldItems","saveSoldItems","deleteMenuItemFromDB","migrateFromLocalStorage","compressImage","confirm","alert","name","components","setup","businessInfo","description","contact","address","logo","showBusinessForm","paymentInfo","qrTitle","qrImage","nequiNumber","nequiImage","showPaymentForm","newItem","price","includesDrink","availableQuantity","image","id","menuItems","showMenuForm","isEditing","editingIndex","soldItems","searchTerm","sortBy","categoryFilter","selectedChartType","shareLink","showCopiedMessage","migrationStatus","inProgress","completed","message","chartError","handleChartError","error","console","value","notification","show","type","timeout","newSpecialItem","specialMenuItems","showSpecialMenuForm","isEditingSpecial","editingSpecialIndex","hasLocalData","localStorage","getItem","migrationResult","removeItem","dbBusinessInfo","dbMenuItems","length","specialItems","filter","item","isSpecial","dbSoldItems","setTimeout","toggleBusinessForm","onLogoChange","event","file","target","files","reader","FileReader","onload","e","compressedLogo","result","readAsDataURL","clearTimeout","clearBusinessForm","confirmed","togglePaymentForm","onQRImageChange","compressedImage","onNequiImageChange","savePaymentInfo","clearPaymentForm","toggleMenuForm","clearMenuForm","onImageChange","saveMenuItem","Date","now","Math","random","toString","substring","index","findIndex","existingItem","find","toLowerCase","title","push","allItems","editMenuItem","deleteMenuItem","confirmText","cancelText","log","itemName","currentDate","toISOString","Array","isArray","warn","soldItem","sold","quantity","date","newSoldItem","Number","Boolean","cleanSoldItems","map","String","deleteResult","deleteError","splice","sellMenuItem","toggleSpecialMenuForm","clearSpecialMenuForm","onSpecialImageChange","saveSpecialMenuItem","editSpecialMenuItem","deleteSpecialMenuItem","sellSpecialMenuItem","shareByWhatsApp","itemsToShare","menuId","url","window","location","origin","whatsappUrl","encodeURIComponent","open","copyLink","loadingMessage","navigator","clipboard","writeText","clipboardError","totalSales","reduce","total","formatPrice","isNaN","fixed","toFixed","intPart","decPart","split","formattedIntPart","replace","formatDate","dateStr","getTime","Intl","DateTimeFormat","day","month","year","hour","minute","format","filteredSoldItems","items","term","includes","sort","a","b","localeCompare","qtyA","qtyB","priceA","priceB","dateA","dateB","exportToExcel","data","ws","utils","aoa_to_sheet","wb","book_new","book_append_sheet","excelBuffer","write","bookType","blob","Blob","toLocaleDateString","exportToPDF","doc","setFontSize","text","tableData","autoTable","head","body","foot","startY","theme","headStyles","fillColor","footStyles","textColor","fontStyle","save","removeDuplicates","array","Set"],"sources":["F:\\Driver google\\VUE.JS-2\\temp\\websap\\src\\components\\MenuComponent.vue"],"sourcesContent":["<template>\r\n  <div class=\"menu-container\">\r\n    <!-- Notificaciones -->\r\n    <div \r\n      v-if=\"notification.show\" \r\n      class=\"notification\" \r\n      :class=\"notification.type\"\r\n    >\r\n      {{ notification.message }}\r\n      <button @click=\"notification.show = false\" class=\"notification-close\">&times;</button>\r\n    </div>\r\n\r\n    <!-- Mensaje de migración de datos -->\r\n    <div v-if=\"migrationStatus.inProgress || migrationStatus.completed\" class=\"migration-status\" :class=\"{ 'completed': migrationStatus.completed }\">\r\n      <div class=\"migration-message\">\r\n        <span v-if=\"migrationStatus.inProgress\" class=\"loading-spinner\"></span>\r\n        {{ migrationStatus.message }}\r\n      </div>\r\n    </div>\r\n  \r\n    <!-- SECCIÓN 1: INFORMACIÓN DEL NEGOCIO -->\r\n    <section class=\"business-info-section\">\r\n      <h2>Información del Negocio</h2>\r\n      <button @click=\"toggleBusinessForm\" class=\"toggle-button\">\r\n        {{ showBusinessForm ? 'Ocultar Formulario' : 'Mostrar Formulario' }}\r\n      </button>\r\n\r\n      <div v-if=\"showBusinessForm\" class=\"business-form\">\r\n        <form @submit.prevent=\"saveBusinessInfo\">\r\n          <div>\r\n            <label for=\"business-name\">Nombre del Restaurante:</label>\r\n            <input type=\"text\" id=\"business-name\" v-model=\"businessInfo.name\" required>\r\n          </div>\r\n          <div>\r\n            <label for=\"business-description\">Descripción:</label>\r\n            <textarea id=\"business-description\" v-model=\"businessInfo.description\"></textarea>\r\n          </div>\r\n          <div>\r\n            <label for=\"business-contact\">Contacto:</label>\r\n            <input type=\"text\" id=\"business-contact\" v-model=\"businessInfo.contact\">\r\n          </div>\r\n          <div>\r\n            <label for=\"business-address\">Dirección:</label>\r\n            <input type=\"text\" id=\"business-address\" v-model=\"businessInfo.address\">\r\n          </div>\r\n          <div>\r\n            <label for=\"business-logo\">Logo:</label>\r\n            <input type=\"file\" id=\"business-logo\" @change=\"onLogoChange\">\r\n            <img v-if=\"businessInfo.logo\" :src=\"businessInfo.logo\" alt=\"Logo\" style=\"max-width: 100px; margin-top: 10px;\">\r\n          </div>\r\n          <div class=\"button-group\">\r\n            <button type=\"submit\" class=\"save-button\">Guardar</button>\r\n            <button type=\"button\" @click=\"clearBusinessForm\" class=\"clear-button\">Limpiar</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n\r\n      <div v-if=\"businessInfo.name\" class=\"business-preview\">\r\n        <h3>Información Guardada</h3>\r\n        <img v-if=\"businessInfo.logo\" :src=\"businessInfo.logo\" alt=\"Logo\" style=\"max-width: 100px;\">\r\n        <h4>{{ businessInfo.name }}</h4>\r\n        <p>{{ businessInfo.description }}</p>\r\n        <p><strong>Contacto:</strong> {{ businessInfo.contact }}</p>\r\n        <p><strong>Dirección:</strong> {{ businessInfo.address }}</p>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- SECCIÓN 2: FORMA DE PAGO -->\r\n    <section class=\"payment-info-section\">\r\n      <h2>Forma de Pago</h2>\r\n      <button @click=\"togglePaymentForm\" class=\"toggle-button\">\r\n        {{ showPaymentForm ? 'Ocultar Formulario' : 'Mostrar Formulario' }}\r\n      </button>\r\n\r\n      <div v-if=\"showPaymentForm\" class=\"payment-form\">\r\n        <form @submit.prevent=\"savePaymentInfo\">\r\n          <div>\r\n            <label for=\"qr-title\">Título del código QR:</label>\r\n            <input type=\"text\" id=\"qr-title\" v-model=\"paymentInfo.qrTitle\" placeholder=\"Ej: Escanea para pagar\">\r\n          </div>\r\n          <div>\r\n            <label for=\"qr-image\">Imagen QR de Pago:</label>\r\n            <input type=\"file\" id=\"qr-image\" @change=\"onQRImageChange\">\r\n            <img v-if=\"paymentInfo.qrImage\" :src=\"paymentInfo.qrImage\" alt=\"QR de Pago\" style=\"max-width: 200px; max-height: 200px; margin-top: 10px;\">\r\n          </div>\r\n          <div>\r\n            <label for=\"nequi-number\">Número de Nequi:</label>\r\n            <input type=\"text\" id=\"nequi-number\" v-model=\"paymentInfo.nequiNumber\" placeholder=\"Ej: 300 123 4567\">\r\n          </div>\r\n          <div>\r\n            <label for=\"nequi-image\">Imagen Nequi:</label>\r\n            <input type=\"file\" id=\"nequi-image\" @change=\"onNequiImageChange\">\r\n            <img v-if=\"paymentInfo.nequiImage\" :src=\"paymentInfo.nequiImage\" alt=\"Imagen Nequi\" style=\"max-width: 200px; max-height: 200px; margin-top: 10px;\">\r\n          </div>\r\n          <div class=\"button-group\">\r\n            <button type=\"submit\" class=\"save-button\">Guardar</button>\r\n            <button type=\"button\" @click=\"clearPaymentForm\" class=\"clear-button\">Limpiar</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n\r\n      <div v-if=\"paymentInfo.qrImage || paymentInfo.nequiNumber\" class=\"payment-preview\">\r\n        <h3>Información de Pago</h3>\r\n        <div class=\"payment-methods\">\r\n          <div v-if=\"paymentInfo.qrImage\" class=\"payment-method\">\r\n            <h4>{{ paymentInfo.qrTitle || 'Código QR de Pago' }}</h4>\r\n            <img :src=\"paymentInfo.qrImage\" alt=\"QR de Pago\" style=\"width: 200px; height: 200px; object-fit: contain;\">\r\n          </div>\r\n          \r\n          <div v-if=\"paymentInfo.nequiNumber || paymentInfo.nequiImage\" class=\"payment-method\">\r\n            <h4>Pago con Nequi</h4>\r\n            <img v-if=\"paymentInfo.nequiImage\" :src=\"paymentInfo.nequiImage\" alt=\"Nequi\" style=\"width: 200px; height: 200px; object-fit: contain;\">\r\n            <p v-if=\"paymentInfo.nequiNumber\"><strong>Número:</strong> {{ paymentInfo.nequiNumber }}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- SECCIÓN 3.1: MENÚ ESPECIAL -->\r\n    <section class=\"menu-special-section\">\r\n      <h2>Menú Especial</h2>\r\n      <button @click=\"toggleSpecialMenuForm\" class=\"toggle-button\">\r\n        {{ showSpecialMenuForm ? 'Ocultar Formulario' : 'Mostrar Formulario' }}\r\n      </button>\r\n\r\n      <!-- Formulario para agregar/editar platos especiales -->\r\n      <div v-if=\"showSpecialMenuForm\" class=\"menu-form\">\r\n        <form @submit.prevent=\"saveSpecialMenuItem\">\r\n          <div>\r\n            <label for=\"special-item-name\">Nombre del plato especial:</label>\r\n            <input type=\"text\" id=\"special-item-name\" v-model=\"newSpecialItem.name\" required>\r\n          </div>\r\n          <div>\r\n            <label for=\"special-item-description\">Descripción del plato especial:</label>\r\n            <textarea id=\"special-item-description\" v-model=\"newSpecialItem.description\"></textarea>\r\n          </div>\r\n          <div>\r\n            <label for=\"special-item-price\">Precio:</label>\r\n            <input type=\"number\" id=\"special-item-price\" v-model.number=\"newSpecialItem.price\" min=\"0\" step=\"0.01\" required>\r\n          </div>\r\n          <div>\r\n            <label for=\"special-item-drinks\">Incluye refresco:</label>\r\n            <select id=\"special-item-drinks\" v-model=\"newSpecialItem.includesDrink\">\r\n              <option :value=\"true\">Sí</option>\r\n              <option :value=\"false\">No</option>\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label for=\"special-item-quantity\">Cantidad disponible:</label>\r\n            <input type=\"number\" id=\"special-item-quantity\" v-model.number=\"newSpecialItem.availableQuantity\" min=\"0\" required>\r\n          </div>\r\n          <div>\r\n            <label for=\"special-item-image\">Imagen del plato especial:</label>\r\n            <input type=\"file\" id=\"special-item-image\" @change=\"onSpecialImageChange\">\r\n            <img v-if=\"newSpecialItem.image\" :src=\"newSpecialItem.image\" alt=\"Imagen del plato especial\" style=\"max-width: 100%; height: auto; margin-top: 10px;\">\r\n          </div>\r\n          <div class=\"button-group\">\r\n            <button type=\"submit\" class=\"save-button\">{{ isEditingSpecial ? 'Actualizar' : 'Crear' }}</button>\r\n            <button type=\"button\" @click=\"clearSpecialMenuForm\" class=\"clear-button\">Cancelar</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n\r\n      <!-- Lista de platos especiales -->\r\n      <div class=\"menu-special-items-list\">\r\n        <div v-for=\"(item, index) in specialMenuItems\" :key=\"index\" class=\"menu-item-card\">\r\n          <div class=\"menu-item-image-container\">\r\n            <img v-if=\"item.image\" :src=\"item.image\" alt=\"Plato especial\" class=\"menu-item-image\">\r\n            <div v-else class=\"no-image-placeholder\">Sin imagen</div>\r\n          </div>\r\n          <div class=\"menu-item-details\">\r\n            <h3>{{ item.name }}</h3>\r\n            <p>{{ item.description }}</p>\r\n            <p><strong>Precio:</strong> ${{ item.price }}</p>\r\n            <p><strong>Incluye refresco:</strong> {{ item.includesDrink ? 'Sí' : 'No' }}</p>\r\n            <p><strong>Disponibles:</strong> {{ item.availableQuantity }}</p>\r\n          </div>\r\n          <div class=\"menu-item-actions\">\r\n            <button @click=\"editSpecialMenuItem(index)\" class=\"edit-button\">Editar</button>\r\n            <button @click=\"sellSpecialMenuItem(index)\" class=\"sell-button\">Vender</button>\r\n            <button @click=\"deleteSpecialMenuItem(index)\" class=\"delete-button\">Eliminar</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- SECCIÓN 3: MENÚ DEL RESTAURANTE -->\r\n    <section class=\"menu-section\">\r\n      <h2>Menú del Restaurante</h2>\r\n      <button @click=\"toggleMenuForm\" class=\"toggle-button\">\r\n        {{ showMenuForm ? 'Ocultar Formulario' : 'Mostrar Formulario' }}\r\n      </button>\r\n\r\n      <!-- Formulario para agregar/editar platos -->\r\n      <div v-if=\"showMenuForm\" class=\"menu-form\">\r\n        <form @submit.prevent=\"saveMenuItem\">\r\n          <div>\r\n            <label for=\"item-name\">Nombre del plato:</label>\r\n            <input type=\"text\" id=\"item-name\" v-model=\"newItem.name\" required>\r\n          </div>\r\n          <div>\r\n            <label for=\"item-description\">Descripción del plato:</label>\r\n            <textarea id=\"item-description\" v-model=\"newItem.description\"></textarea>\r\n          </div>\r\n          <div>\r\n            <label for=\"item-price\">Precio:</label>\r\n            <input type=\"number\" id=\"item-price\" v-model.number=\"newItem.price\" min=\"0\" step=\"0.01\" required>\r\n          </div>\r\n          <div>\r\n            <label for=\"item-drinks\">Incluye refresco:</label>\r\n            <select id=\"item-drinks\" v-model=\"newItem.includesDrink\">\r\n              <option :value=\"true\">Sí</option>\r\n              <option :value=\"false\">No</option>\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label for=\"item-quantity\">Cantidad disponible:</label>\r\n            <input type=\"number\" id=\"item-quantity\" v-model.number=\"newItem.availableQuantity\" min=\"0\" required>\r\n          </div>\r\n          <div>\r\n            <label for=\"item-image\">Imagen del plato:</label>\r\n            <input type=\"file\" id=\"item-image\" @change=\"onImageChange\">\r\n            <img v-if=\"newItem.image\" :src=\"newItem.image\" alt=\"Imagen del plato\" style=\"max-width: 100px; margin-top: 10px;\">\r\n          </div>\r\n          <div class=\"button-group\">\r\n            <button type=\"submit\" class=\"save-button\">{{ isEditing ? 'Actualizar' : 'Crear' }}</button>\r\n            <button type=\"button\" @click=\"clearMenuForm\" class=\"clear-button\">Cancelar</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n\r\n      <!-- Lista de platos -->\r\n      <div class=\"menu-items-list\">\r\n        <div v-for=\"(item, index) in menuItems\" :key=\"index\" class=\"menu-item-card\">\r\n          <div class=\"menu-item-image-container\">\r\n            <img v-if=\"item.image\" :src=\"item.image\" alt=\"Plato\" class=\"menu-item-image\">\r\n            <div v-else class=\"no-image-placeholder\">Sin imagen</div>\r\n          </div>\r\n          <div class=\"menu-item-details\">\r\n            <h3>{{ item.name }}</h3>\r\n            <p>{{ item.description }}</p>\r\n            <p><strong>Precio:</strong> ${{ item.price }}</p>\r\n            <p><strong>Incluye refresco:</strong> {{ item.includesDrink ? 'Sí' : 'No' }}</p>\r\n            <p><strong>Disponibles:</strong> {{ item.availableQuantity }}</p>\r\n          </div>\r\n          <div class=\"menu-item-actions\">\r\n            <button @click=\"editMenuItem(index)\" class=\"edit-button\">Editar</button>\r\n            <button @click=\"sellMenuItem(index)\" class=\"sell-button\">Vender</button>\r\n            <button @click=\"deleteMenuItem(index)\" class=\"delete-button\">Eliminar</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- SECCIÓN 4: INVENTARIO DE PLATOS VENDIDOS -->\r\n    <section class=\"inventory-section\">\r\n      <h2>Inventario de Platos Vendidos</h2>\r\n      \r\n      <div class=\"inventory-controls\">\r\n        <div class=\"inventory-search-container\">\r\n          <input \r\n            v-model=\"searchTerm\" \r\n            placeholder=\"Buscar plato...\" \r\n            class=\"inventory-search-input\"\r\n          />\r\n        </div>\r\n        \r\n        <div class=\"inventory-filters\">\r\n          <select v-model=\"sortBy\" class=\"inventory-filter\">\r\n            <option value=\"\">Ordenar por</option>\r\n            <option value=\"name\">Nombre</option>\r\n            <option value=\"quantity-desc\">Más vendidos</option>\r\n            <option value=\"quantity-asc\">Menos vendidos</option>\r\n            <option value=\"price-desc\">Mayor precio</option>\r\n            <option value=\"price-asc\">Menor precio</option>\r\n            <option value=\"date-desc\">Más recientes</option>\r\n            <option value=\"date-asc\">Más antiguos</option>\r\n          </select>\r\n          \r\n          <select v-model=\"categoryFilter\" class=\"inventory-filter\">\r\n            <option value=\"\">Todas las categorías</option>\r\n            <option value=\"drinks\">Con refresco</option>\r\n            <option value=\"nodrinks\">Sin refresco</option>\r\n          </select>\r\n        </div>\r\n        \r\n        <div class=\"inventory-actions\">\r\n          <button @click=\"exportToExcel\" class=\"export-button excel\">\r\n            <span class=\"action-icon\">📊</span> Exportar a Excel\r\n          </button>\r\n          <button @click=\"exportToPDF\" class=\"export-button pdf\">\r\n            <span class=\"action-icon\">📄</span> Exportar a PDF\r\n          </button>\r\n          <select v-model=\"selectedChartType\" class=\"inventory-filter\">\r\n            <option value=\"bar\">Gráfico de barras</option>\r\n            <option value=\"line\">Gráfico de líneas</option>\r\n            <option value=\"none\">Sin gráfico</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Gráfico de ventas con tratamiento de errores -->\r\n      <div v-if=\"selectedChartType !== 'none'\" class=\"sales-chart-container\">\r\n        <SalesChartComponent \r\n          v-if=\"filteredSoldItems.length > 0\" \r\n          :chartType=\"selectedChartType\" \r\n          :items=\"filteredSoldItems\"\r\n          class=\"sales-chart\"\r\n          @error=\"handleChartError\"\r\n        />\r\n        <div v-else class=\"empty-chart-message\">\r\n          No hay datos suficientes para mostrar el gráfico\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"inventory-table\">\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>Nombre del Plato</th>\r\n              <th>Categoría</th>\r\n              <th>Cantidad Vendida</th>\r\n              <th>Precio por Unidad</th>\r\n              <th>Fecha de Venta</th>\r\n              <th>Subtotal</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(item, index) in filteredSoldItems\" :key=\"index\" :class=\"{ 'alternate-row': index % 2 !== 0 }\">\r\n              <td>{{ item.name }}</td>\r\n              <td>{{ item.includesDrink ? 'Con refresco' : 'Sin refresco' }}</td>\r\n              <td>{{ item.quantity }}</td>\r\n              <td>${{ formatPrice(item.price) }}</td>\r\n              <td>{{ formatDate(item.date) }}</td>\r\n              <td>${{ formatPrice(item.quantity * item.price) }}</td>\r\n            </tr>\r\n          </tbody>\r\n          <tfoot>\r\n            <tr>\r\n              <td colspan=\"5\"><strong>Total Ventas</strong></td>\r\n              <td><strong>${{ formatPrice(totalSales) }}</strong></td>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- SECCIÓN 5: COMPARTIR MENU -->\r\n    <section class=\"share-section\">\r\n      <h2>Compartir Menú</h2>\r\n      <div class=\"share-buttons\">\r\n        <button @click=\"shareByWhatsApp\" class=\"whatsapp-button\">\r\n          <span class=\"emoji\">📱</span> Compartir en WhatsApp\r\n        </button>\r\n        <button @click=\"copyLink\" class=\"copy-button\">\r\n          <span class=\"emoji\">📋</span> Copiar Enlace\r\n        </button>\r\n      </div>\r\n      <p v-if=\"showCopiedMessage\" class=\"copied-message\">¡Enlace copiado al portapapeles!</p>\r\n      <p v-if=\"shareLink\" class=\"share-link\">\r\n        Enlace para compartir: <a :href=\"shareLink\" target=\"_blank\">{{ shareLink }}</a>\r\n      </p>\r\n    </section>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport { saveMenu } from '../services/menuService';\r\nimport { formatShareLinkMessage } from '../utils/messageFormatter';\r\nimport SalesChartComponent from './SalesChartComponent.vue';\r\nimport { saveAs } from 'file-saver';\r\nimport * as XLSX from 'xlsx';\r\nimport { jsPDF } from 'jspdf';\r\nimport 'jspdf-autotable';\r\nimport { \r\n  getMenuItems, \r\n  saveMenuItems,\r\n  getBusinessInfo, \r\n  saveBusinessInfo as saveBusinessInfoToDB,\r\n  getSoldItems, \r\n  saveSoldItems,\r\n  deleteMenuItemFromDB,\r\n  migrateFromLocalStorage,\r\n  compressImage\r\n} from '../services/storageService';\r\nimport { confirm, alert } from '../services/dialogService';\r\n\r\nexport default {\r\n  name: 'MenuComponent',\r\n  components: {\r\n    SalesChartComponent\r\n  },\r\n  setup() {\r\n    // Estado para información del negocio\r\n    const businessInfo = ref({\r\n      name: '',\r\n      description: '',\r\n      contact: '',\r\n      address: '',\r\n      logo: ''\r\n    });\r\n    const showBusinessForm = ref(false);\r\n\r\n    // Estado para información de pago\r\n    const paymentInfo = ref({\r\n      qrTitle: '',\r\n      qrImage: '',\r\n      nequiNumber: '',\r\n      nequiImage: ''\r\n    });\r\n    const showPaymentForm = ref(false);\r\n\r\n    // Estado para platos del menú\r\n    const newItem = ref({\r\n      name: '',\r\n      description: '',\r\n      price: 0,\r\n      includesDrink: false,\r\n      availableQuantity: 0,\r\n      image: '',\r\n      id: null\r\n    });\r\n    const menuItems = ref([]);\r\n    const showMenuForm = ref(false);\r\n    const isEditing = ref(false);\r\n    const editingIndex = ref(-1);\r\n\r\n    // Estado para ventas e inventario\r\n    const soldItems = ref([]);\r\n    const searchTerm = ref('');\r\n    const sortBy = ref('');\r\n    const categoryFilter = ref('');\r\n    const selectedChartType = ref('bar');\r\n\r\n    // Estado para compartir\r\n    const shareLink = ref('');\r\n    const showCopiedMessage = ref(false);\r\n    \r\n    // Estado para mostrar progreso de migración\r\n    const migrationStatus = ref({\r\n      inProgress: false,\r\n      completed: false,\r\n      message: ''\r\n    });\r\n\r\n    // Estado para errores del gráfico\r\n    const chartError = ref(null);\r\n    \r\n    // Manejar errores del gráfico\r\n    const handleChartError = (error) => {\r\n      console.error(\"Error en el gráfico:\", error);\r\n      chartError.value = error;\r\n    };\r\n\r\n    // Estado para mensajes de notificación\r\n    const notification = ref({\r\n      show: false,\r\n      message: '',\r\n      type: 'success', // 'success', 'error'\r\n      timeout: null\r\n    });\r\n\r\n    // Estado para platos especiales\r\n    const newSpecialItem = ref({\r\n      name: '',\r\n      description: '',\r\n      price: 0,\r\n      includesDrink: false,\r\n      availableQuantity: 0,\r\n      image: '',\r\n      id: null\r\n    });\r\n    const specialMenuItems = ref([]);\r\n    const showSpecialMenuForm = ref(false);\r\n    const isEditingSpecial = ref(false);\r\n    const editingSpecialIndex = ref(-1);\r\n\r\n    // Cargar datos guardados\r\n    onMounted(async () => {\r\n      try {\r\n        migrationStatus.value.inProgress = true;\r\n        migrationStatus.value.message = 'Cargando datos...';\r\n        \r\n        const hasLocalData = localStorage.getItem('businessInfo') || \r\n                             localStorage.getItem('menuItems') ||\r\n                             localStorage.getItem('soldItems');\r\n          \r\n        if (hasLocalData) {\r\n          migrationStatus.value.message = 'Migrando datos desde localStorage a IndexedDB...';\r\n          \r\n          const migrationResult = await migrateFromLocalStorage();\r\n          \r\n          if (migrationResult) {\r\n            migrationStatus.value.completed = true;\r\n            migrationStatus.value.message = 'Migración completada exitosamente';\r\n            localStorage.removeItem('businessInfo');\r\n            localStorage.removeItem('menuItems');\r\n            localStorage.removeItem('soldItems');\r\n          } else {\r\n            migrationStatus.value.message = 'Error en la migración de datos';\r\n          }\r\n        }\r\n\r\n        const dbBusinessInfo = await getBusinessInfo();\r\n        if (dbBusinessInfo && dbBusinessInfo.name) {\r\n          businessInfo.value = dbBusinessInfo;\r\n        }\r\n\r\n        const dbMenuItems = await getMenuItems();\r\n        if (dbMenuItems && dbMenuItems.length > 0) {\r\n          menuItems.value = dbMenuItems;\r\n          \r\n          // Filtrar los platos especiales del menú regular\r\n          const specialItems = dbMenuItems.filter(item => item.isSpecial === true);\r\n          if (specialItems.length > 0) {\r\n            specialMenuItems.value = specialItems;\r\n          }\r\n        }\r\n\r\n        const dbSoldItems = await getSoldItems();\r\n        if (dbSoldItems && dbSoldItems.length > 0) {\r\n          soldItems.value = dbSoldItems;\r\n        }\r\n        \r\n        setTimeout(() => {\r\n          migrationStatus.value.inProgress = false;\r\n        }, 1500);\r\n      } catch (error) {\r\n        console.error('Error al cargar datos:', error);\r\n        migrationStatus.value.message = 'Error al cargar datos: ' + error.message;\r\n        setTimeout(() => {\r\n          migrationStatus.value.inProgress = false;\r\n        }, 3000);\r\n      }\r\n    });\r\n\r\n    // Métodos para información del negocio\r\n    const toggleBusinessForm = () => {\r\n      showBusinessForm.value = !showBusinessForm.value;\r\n    };\r\n\r\n    const onLogoChange = async (event) => {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = async (e) => {\r\n          const compressedLogo = await compressImage(e.target.result);\r\n          businessInfo.value.logo = compressedLogo;\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    };\r\n\r\n    const saveBusinessInfo = async () => {\r\n      try {\r\n        if (notification.value.timeout) {\r\n          clearTimeout(notification.value.timeout);\r\n        }\r\n        \r\n        await saveBusinessInfoToDB(businessInfo.value);\r\n        \r\n        notification.value = {\r\n          show: true,\r\n          message: 'Información del negocio guardada con éxito!',\r\n          type: 'success',\r\n          timeout: setTimeout(() => {\r\n            notification.value.show = false;\r\n          }, 3000)\r\n        };\r\n      } catch (error) {\r\n        console.error('Error al guardar información del negocio:', error);\r\n        \r\n        notification.value = {\r\n          show: true,\r\n          message: 'Error al guardar la información. Por favor, intenta nuevamente.',\r\n          type: 'error',\r\n          timeout: setTimeout(() => {\r\n            notification.value.show = false;\r\n          }, 3000)\r\n        };\r\n      }\r\n    };\r\n\r\n    const clearBusinessForm = async () => {\r\n      const confirmed = await confirm('¿Estás seguro de querer limpiar el formulario?');\r\n      if (confirmed) {\r\n        businessInfo.value = {\r\n          name: '',\r\n          description: '',\r\n          contact: '',\r\n          address: '',\r\n          logo: ''\r\n        };\r\n      }\r\n    };\r\n\r\n    // Métodos para información de pago\r\n    const togglePaymentForm = () => {\r\n      showPaymentForm.value = !showPaymentForm.value;\r\n    };\r\n\r\n    const onQRImageChange = async (event) => {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = async (e) => {\r\n          const compressedImage = await compressImage(e.target.result);\r\n          paymentInfo.value.qrImage = compressedImage;\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    };\r\n\r\n    const onNequiImageChange = async (event) => {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = async (e) => {\r\n          const compressedImage = await compressImage(e.target.result);\r\n          paymentInfo.value.nequiImage = compressedImage;\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    };\r\n\r\n    const savePaymentInfo = async () => {\r\n      try {\r\n        if (notification.value.timeout) {\r\n          clearTimeout(notification.value.timeout);\r\n        }\r\n        \r\n        businessInfo.value.paymentInfo = { ...paymentInfo.value };\r\n        \r\n        await saveBusinessInfoToDB(businessInfo.value);\r\n        \r\n        notification.value = {\r\n          show: true,\r\n          message: 'Información de pago guardada con éxito!',\r\n          type: 'success',\r\n          timeout: setTimeout(() => {\r\n            notification.value.show = false;\r\n          }, 3000)\r\n        };\r\n      } catch (error) {\r\n        console.error('Error al guardar información de pago:', error);\r\n        \r\n        notification.value = {\r\n          show: true,\r\n          message: 'Error al guardar la información de pago. Por favor, intenta nuevamente.',\r\n          type: 'error',\r\n          timeout: setTimeout(() => {\r\n            notification.value.show = false;\r\n          }, 3000)\r\n        };\r\n      }\r\n    };\r\n\r\n    const clearPaymentForm = async () => {\r\n      const confirmed = await confirm('¿Estás seguro de querer limpiar la información de pago?');\r\n      if (confirmed) {\r\n        paymentInfo.value = {\r\n          qrTitle: '',\r\n          qrImage: '',\r\n          nequiNumber: '',\r\n          nequiImage: ''\r\n        };\r\n      }\r\n    };\r\n\r\n    // Métodos para platos del menú\r\n    const toggleMenuForm = () => {\r\n      showMenuForm.value = !showMenuForm.value;\r\n      if (!showMenuForm.value) {\r\n        clearMenuForm();\r\n      }\r\n    };\r\n\r\n    const onImageChange = async (event) => {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = async (e) => {\r\n          const compressedImage = await compressImage(e.target.result);\r\n          newItem.value.image = compressedImage;\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    };\r\n\r\n    const saveMenuItem = async () => {\r\n      try {\r\n        if (!newItem.value.id) {\r\n          newItem.value.id = Date.now() + Math.random().toString(36).substring(2, 10);\r\n        }\r\n        \r\n        if (isEditing.value) {\r\n          const index = menuItems.value.findIndex(item => item.id === newItem.value.id);\r\n          if (index !== -1) {\r\n            menuItems.value[index] = { ...newItem.value };\r\n          }\r\n          isEditing.value = false;\r\n          editingIndex.value = -1;\r\n          await alert('Plato actualizado con éxito!');\r\n        } else {\r\n          const existingItem = menuItems.value.find(item => \r\n            item.name.toLowerCase() === newItem.value.name.toLowerCase()\r\n          );\r\n          \r\n          if (existingItem) {\r\n            const confirmed = await confirm(\r\n              `Ya existe un plato llamado \"${newItem.value.name}\". ¿Desea actualizarlo?`,\r\n              { title: 'Actualizar plato existente' }\r\n            );\r\n            \r\n            if (confirmed) {\r\n              const index = menuItems.value.findIndex(item => item.id === existingItem.id);\r\n              if (index !== -1) {\r\n                newItem.value.id = existingItem.id;\r\n                menuItems.value[index] = { ...newItem.value };\r\n                await alert('Plato actualizado con éxito!');\r\n              }\r\n            } else {\r\n              return;\r\n            }\r\n          } else {\r\n            menuItems.value.push({ ...newItem.value });\r\n            await alert('Plato creado con éxito!');\r\n          }\r\n        }\r\n        \r\n        // Guardar todos los platos (regulares y especiales) en una sola colección\r\n        const allItems = [\r\n          ...menuItems.value.filter(item => !item.isSpecial),\r\n          ...specialMenuItems.value\r\n        ];\r\n        \r\n        await saveMenuItems(allItems);\r\n        clearMenuForm();\r\n      } catch (error) {\r\n        console.error('Error al guardar el plato:', error);\r\n        await alert('Error al guardar el plato. Por favor, intenta nuevamente.');\r\n      }\r\n    };\r\n\r\n    const clearMenuForm = () => {\r\n      newItem.value = {\r\n        name: '',\r\n        description: '',\r\n        price: 0,\r\n        includesDrink: false,\r\n        availableQuantity: 0,\r\n        image: '',\r\n        id: null\r\n      };\r\n      isEditing.value = false;\r\n      editingIndex.value = -1;\r\n    };\r\n\r\n    const editMenuItem = (index) => {\r\n      newItem.value = { ...menuItems.value[index] };\r\n      isEditing.value = true;\r\n      editingIndex.value = index;\r\n      showMenuForm.value = true;\r\n    };\r\n\r\n    const deleteMenuItem = async (index) => {\r\n      const confirmed = await confirm('¿Estás seguro de querer eliminar este plato?', {\r\n        title: 'Eliminar plato',\r\n        confirmText: 'Eliminar',\r\n        cancelText: 'Cancelar'\r\n      });\r\n      \r\n      if (confirmed) {\r\n        try {\r\n          if (index < 0 || index >= menuItems.value.length) {\r\n            console.error('Error: Índice fuera de rango', index);\r\n            await alert('Error: No se encontró el elemento a eliminar');\r\n            return;\r\n          }\r\n          \r\n          const item = menuItems.value[index];\r\n          console.log(`Eliminando plato: índice=${index}, nombre=${item.name}, id=${item.id}`);\r\n          \r\n          if (!item) {\r\n            console.error('Error: Elemento del menú no encontrado en el índice', index);\r\n            await alert('Error: No se encontró el elemento a eliminar');\r\n            return;\r\n          }\r\n          \r\n          const itemName = item.name || 'Producto sin nombre';\r\n          const currentDate = new Date().toISOString();\r\n          \r\n          if (!Array.isArray(soldItems.value)) {\r\n            console.warn('soldItems.value no es un array, inicializando como array vacío');\r\n            soldItems.value = [];\r\n          }\r\n          \r\n          const soldItem = soldItems.value.find(sold => \r\n            sold && typeof sold === 'object' && sold.name === itemName\r\n          );\r\n          \r\n          if (soldItem) {\r\n            soldItem.quantity += 1;\r\n            if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\r\n              soldItem.date = currentDate;\r\n            }\r\n          } else {\r\n            const newSoldItem = {\r\n              name: itemName,\r\n              quantity: 1,\r\n              price: Number(item.price) || 0,\r\n              includesDrink: Boolean(item.includesDrink),\r\n              date: currentDate\r\n            };\r\n            \r\n            soldItems.value.push(newSoldItem);\r\n          }\r\n          \r\n          const cleanSoldItems = soldItems.value.map(item => {\r\n            if (!item || typeof item !== 'object') {\r\n              return {\r\n                name: 'Producto desconocido',\r\n                quantity: 1,\r\n                price: 0,\r\n                includesDrink: false,\r\n                date: currentDate\r\n              };\r\n            }\r\n            \r\n            return {\r\n              name: String(item.name || 'Producto desconocido'),\r\n              quantity: Number(item.quantity) || 1,\r\n              price: Number(item.price) || 0,\r\n              includesDrink: Boolean(item.includesDrink),\r\n              date: item.date || currentDate\r\n            };\r\n          });\r\n          \r\n          await saveSoldItems(cleanSoldItems);\r\n          \r\n          if (item.id) {\r\n            try {\r\n              console.log(`Llamando a deleteMenuItemFromDB para ID: ${item.id}`);\r\n              const deleteResult = await deleteMenuItemFromDB(item.id);\r\n              console.log(`Resultado de la eliminación: ${deleteResult}`);\r\n            } catch (deleteError) {\r\n              console.error('Error al eliminar item del almacén:', deleteError);\r\n            }\r\n          }\r\n          \r\n          menuItems.value.splice(index, 1);\r\n          soldItems.value = cleanSoldItems;\r\n\r\n          console.log('Elemento eliminado correctamente del menú local');\r\n          \r\n        } catch (error) {\r\n          console.error('Error al eliminar el plato:', error);\r\n          await alert('Error al eliminar el plato. Por favor, intenta nuevamente.');\r\n        }\r\n      }\r\n    };\r\n\r\n    const sellMenuItem = async (index) => {\r\n      try {\r\n        const item = menuItems.value[index];\r\n        \r\n        if (item.availableQuantity <= 0) {\r\n          await alert('No hay unidades disponibles de este plato.');\r\n          return;\r\n        }\r\n        \r\n        item.availableQuantity--;\r\n        \r\n        const soldItem = soldItems.value.find(sold => sold.name === item.name);\r\n        const currentDate = new Date().toISOString();\r\n        \r\n        if (soldItem) {\r\n          soldItem.quantity += 1;\r\n          if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\r\n            soldItem.date = currentDate;\r\n          }\r\n        } else {\r\n          const newSoldItem = {\r\n            name: item.name || 'Producto sin nombre',\r\n            quantity: 1,\r\n            price: Number(item.price) || 0,\r\n            includesDrink: Boolean(item.includesDrink),\r\n            date: currentDate\r\n          };\r\n          \r\n          soldItems.value.push(newSoldItem);\r\n        }\r\n        \r\n        const cleanSoldItems = soldItems.value.map(item => ({\r\n          name: String(item.name || 'Producto desconocido'),\r\n          quantity: Number(item.quantity) || 1,\r\n          price: Number(item.price) || 0,\r\n          includesDrink: Boolean(item.includesDrink),\r\n          date: item.date || currentDate\r\n        }));\r\n        \r\n        await saveMenuItems(menuItems.value);\r\n        await saveSoldItems(cleanSoldItems);\r\n        \r\n        soldItems.value = cleanSoldItems;\r\n        \r\n        await alert(`Se ha vendido una unidad de \"${item.name}\"`);\r\n        \r\n      } catch (error) {\r\n        console.error('Error al vender el plato:', error);\r\n        await alert('Error al procesar la venta. Por favor, intenta nuevamente.');\r\n      }\r\n    };\r\n\r\n    // Métodos para platos especiales\r\n    const toggleSpecialMenuForm = () => {\r\n      showSpecialMenuForm.value = !showSpecialMenuForm.value;\r\n      if (!showSpecialMenuForm.value) {\r\n        clearSpecialMenuForm();\r\n      }\r\n    };\r\n\r\n    const onSpecialImageChange = async (event) => {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = async (e) => {\r\n          const compressedImage = await compressImage(e.target.result);\r\n          newSpecialItem.value.image = compressedImage;\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    };\r\n\r\n    const saveSpecialMenuItem = async () => {\r\n      try {\r\n        if (!newSpecialItem.value.id) {\r\n          newSpecialItem.value.id = Date.now() + Math.random().toString(36).substring(2, 10);\r\n        }\r\n        \r\n        // Marcar el plato como especial\r\n        newSpecialItem.value.isSpecial = true;\r\n        \r\n        if (isEditingSpecial.value) {\r\n          const index = specialMenuItems.value.findIndex(item => item.id === newSpecialItem.value.id);\r\n          if (index !== -1) {\r\n            specialMenuItems.value[index] = { ...newSpecialItem.value };\r\n          }\r\n          isEditingSpecial.value = false;\r\n          editingSpecialIndex.value = -1;\r\n          await alert('Plato especial actualizado con éxito!');\r\n        } else {\r\n          const existingItem = specialMenuItems.value.find(item => \r\n            item.name.toLowerCase() === newSpecialItem.value.name.toLowerCase()\r\n          );\r\n          \r\n          if (existingItem) {\r\n            const confirmed = await confirm(\r\n              `Ya existe un plato especial llamado \"${newSpecialItem.value.name}\". ¿Desea actualizarlo?`,\r\n              { title: 'Actualizar plato especial existente' }\r\n            );\r\n            \r\n            if (confirmed) {\r\n              const index = specialMenuItems.value.findIndex(item => item.id === existingItem.id);\r\n              if (index !== -1) {\r\n                newSpecialItem.value.id = existingItem.id;\r\n                specialMenuItems.value[index] = { ...newSpecialItem.value };\r\n                await alert('Plato especial actualizado con éxito!');\r\n              }\r\n            } else {\r\n              return;\r\n            }\r\n          } else {\r\n            specialMenuItems.value.push({ ...newSpecialItem.value });\r\n            await alert('Plato especial creado con éxito!');\r\n          }\r\n        }\r\n        \r\n        // Guardar todos los platos (regulares y especiales) en una sola colección\r\n        const allItems = [\r\n          ...menuItems.value.filter(item => !item.isSpecial),\r\n          ...specialMenuItems.value\r\n        ];\r\n        \r\n        await saveMenuItems(allItems);\r\n        clearSpecialMenuForm();\r\n      } catch (error) {\r\n        console.error('Error al guardar el plato especial:', error);\r\n        await alert('Error al guardar el plato especial. Por favor, intenta nuevamente.');\r\n      }\r\n    };\r\n\r\n    const clearSpecialMenuForm = () => {\r\n      newSpecialItem.value = {\r\n        name: '',\r\n        description: '',\r\n        price: 0,\r\n        includesDrink: false,\r\n        availableQuantity: 0,\r\n        image: '',\r\n        id: null\r\n      };\r\n      isEditingSpecial.value = false;\r\n      editingSpecialIndex.value = -1;\r\n    };\r\n\r\n    const editSpecialMenuItem = (index) => {\r\n      newSpecialItem.value = { ...specialMenuItems.value[index] };\r\n      isEditingSpecial.value = true;\r\n      editingSpecialIndex.value = index;\r\n      showSpecialMenuForm.value = true;\r\n    };\r\n\r\n    const deleteSpecialMenuItem = async (index) => {\r\n      const confirmed = await confirm('¿Estás seguro de querer eliminar este plato especial?', {\r\n        title: 'Eliminar plato especial',\r\n        confirmText: 'Eliminar',\r\n        cancelText: 'Cancelar'\r\n      });\r\n      \r\n      if (confirmed) {\r\n        try {\r\n          if (index < 0 || index >= specialMenuItems.value.length) {\r\n            console.error('Error: Índice fuera de rango', index);\r\n            await alert('Error: No se encontró el elemento a eliminar');\r\n            return;\r\n          }\r\n          \r\n          const item = specialMenuItems.value[index];\r\n          console.log(`Eliminando plato especial: índice=${index}, nombre=${item.name}, id=${item.id}`);\r\n          \r\n          if (!item) {\r\n            console.error('Error: Elemento del menú especial no encontrado en el índice', index);\r\n            await alert('Error: No se encontró el elemento a eliminar');\r\n            return;\r\n          }\r\n          \r\n          const itemName = item.name || 'Producto desconocido';\r\n          const currentDate = new Date().toISOString();\r\n          \r\n          if (!Array.isArray(soldItems.value)) {\r\n            console.warn('soldItems.value no es un array, inicializando como array vacío');\r\n            soldItems.value = [];\r\n          }\r\n          \r\n          const soldItem = soldItems.value.find(sold => \r\n            sold && typeof sold === 'object' && sold.name === itemName\r\n          );\r\n          \r\n          if (soldItem) {\r\n            soldItem.quantity += 1;\r\n            if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\r\n              soldItem.date = currentDate;\r\n            }\r\n          } else {\r\n            const newSoldItem = {\r\n              name: itemName,\r\n              quantity: 1,\r\n              price: Number(item.price) || 0,\r\n              includesDrink: Boolean(item.includesDrink),\r\n              date: currentDate\r\n            };\r\n            \r\n            soldItems.value.push(newSoldItem);\r\n          }\r\n          \r\n          const cleanSoldItems = soldItems.value.map(item => {\r\n            if (!item || typeof item !== 'object') {\r\n              return {\r\n                name: 'Producto desconocido',\r\n                quantity: 1,\r\n                price: 0,\r\n                includesDrink: false,\r\n                date: currentDate\r\n              };\r\n            }\r\n            \r\n            return {\r\n              name: String(item.name || 'Producto desconocido'),\r\n              quantity: Number(item.quantity) || 1,\r\n              price: Number(item.price) || 0,\r\n              includesDrink: Boolean(item.includesDrink),\r\n              date: item.date || currentDate\r\n            };\r\n          });\r\n          \r\n          await saveSoldItems(cleanSoldItems);\r\n          \r\n          if (item.id) {\r\n            try {\r\n              console.log(`Llamando a deleteMenuItemFromDB para ID: ${item.id}`);\r\n              const deleteResult = await deleteMenuItemFromDB(item.id);\r\n              console.log(`Resultado de la eliminación: ${deleteResult}`);\r\n            } catch (deleteError) {\r\n              console.error('Error al eliminar item del almacén:', deleteError);\r\n            }\r\n          }\r\n          \r\n          specialMenuItems.value.splice(index, 1);\r\n          soldItems.value = cleanSoldItems;\r\n\r\n          // Actualizar la colección completa después de eliminar\r\n          const allItems = [\r\n            ...menuItems.value.filter(item => !item.isSpecial),\r\n            ...specialMenuItems.value\r\n          ];\r\n          \r\n          await saveMenuItems(allItems);\r\n\r\n          console.log('Elemento eliminado correctamente del menú especial');\r\n          \r\n        } catch (error) {\r\n          console.error('Error al eliminar el plato especial:', error);\r\n          await alert('Error al eliminar el plato especial. Por favor, intenta nuevamente.');\r\n        }\r\n      }\r\n    };\r\n\r\n    const sellSpecialMenuItem = async (index) => {\r\n      try {\r\n        const item = specialMenuItems.value[index];\r\n        \r\n        if (item.availableQuantity <= 0) {\r\n          await alert('No hay unidades disponibles de este plato especial.');\r\n          return;\r\n        }\r\n        \r\n        item.availableQuantity--;\r\n        \r\n        const soldItem = soldItems.value.find(sold => sold.name === item.name);\r\n        const currentDate = new Date().toISOString();\r\n        \r\n        if (soldItem) {\r\n          soldItem.quantity += 1;\r\n          if (!soldItem.date || new Date(currentDate) > new Date(soldItem.date)) {\r\n            soldItem.date = currentDate;\r\n          }\r\n        } else {\r\n          const newSoldItem = {\r\n            name: item.name || 'Producto sin nombre',\r\n            quantity: 1,\r\n            price: Number(item.price) || 0,\r\n            includesDrink: Boolean(item.includesDrink),\r\n            date: currentDate\r\n          };\r\n          \r\n          soldItems.value.push(newSoldItem);\r\n        }\r\n        \r\n        const cleanSoldItems = soldItems.value.map(item => ({\r\n          name: String(item.name || 'Producto desconocido'),\r\n          quantity: Number(item.quantity) || 1,\r\n          price: Number(item.price) || 0,\r\n          includesDrink: Boolean(item.includesDrink),\r\n          date: item.date || currentDate\r\n        }));\r\n        \r\n        // Guardar todos los platos (regulares y especiales) en una sola colección\r\n        const allItems = [\r\n          ...menuItems.value.filter(item => !item.isSpecial),\r\n          ...specialMenuItems.value\r\n        ];\r\n        \r\n        await saveMenuItems(allItems);\r\n        await saveSoldItems(cleanSoldItems);\r\n        \r\n        soldItems.value = cleanSoldItems;\r\n        \r\n        await alert(`Se ha vendido una unidad de \"${item.name}\"`);\r\n        \r\n      } catch (error) {\r\n        console.error('Error al vender el plato especial:', error);\r\n        await alert('Error al procesar la venta. Por favor, intenta nuevamente.');\r\n      }\r\n    };\r\n\r\n    // Métodos para compartir\r\n    const shareByWhatsApp = async () => {\r\n      try {\r\n        await alert('Procesando imágenes para compartir...');\r\n        \r\n        if (menuItems.value.length > 30) {\r\n          await alert('El menú tiene demasiados elementos. Por favor, seleccione menos platos para compartir.');\r\n          return;\r\n        }\r\n        \r\n        const itemsToShare = menuItems.value.map(item => ({\r\n          id: item.id,\r\n          name: item.name,\r\n          description: item.description,\r\n          price: item.price,\r\n          includesDrink: item.includesDrink,\r\n          image: item.image\r\n        }));\r\n        \r\n        console.log(`Preparando para compartir ${itemsToShare.length} elementos...`);\r\n        \r\n        const menuId = await saveMenu(itemsToShare);\r\n        const url = `${window.location.origin}/menu/${menuId}`;\r\n        shareLink.value = url;\r\n        \r\n        const message = formatShareLinkMessage(url, businessInfo.value.name);\r\n        const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;\r\n        window.open(whatsappUrl, '_blank');\r\n      } catch (error) {\r\n        console.error('Error al compartir por WhatsApp:', error);\r\n        await alert(`Error al compartir el menú: ${error.message || 'Error desconocido'}. Por favor, intenta reducir el tamaño de las imágenes o eliminar algunos ítems.`);\r\n      }\r\n    };\r\n\r\n    const copyLink = async () => {\r\n      try {\r\n        const loadingMessage = 'Procesando imágenes para compartir...';\r\n        showCopiedMessage.value = true;\r\n        \r\n        if (menuItems.value.length > 30) {\r\n          await alert('El menú tiene demasiados elementos. Por favor, seleccione menos platos para compartir.');\r\n          showCopiedMessage.value = false;\r\n          return;\r\n        }\r\n        \r\n        const itemsToShare = menuItems.value.map(item => ({\r\n          id: item.id,\r\n          name: item.name,\r\n          description: item.description,\r\n          price: item.price,\r\n          includesDrink: item.includesDrink,\r\n          image: item.image\r\n        }));\r\n        \r\n        const menuId = await saveMenu(itemsToShare);\r\n        const url = `${window.location.origin}/menu/${menuId}`;\r\n        shareLink.value = url;\r\n        \r\n        try {\r\n          await navigator.clipboard.writeText(url);\r\n          showCopiedMessage.value = true;\r\n          setTimeout(() => {\r\n            showCopiedMessage.value = false;\r\n          }, 3000);\r\n        } catch (clipboardError) {\r\n          console.error('Error al copiar al portapapeles:', clipboardError);\r\n          await alert('No se pudo copiar automáticamente. Por favor, copia manualmente este enlace: ' + url);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error al generar enlace para compartir:', error);\r\n        showCopiedMessage.value = false;\r\n        await alert(`Error al generar el enlace: ${error.message || 'Error desconocido'}. Por favor, intenta reducir el tamaño de las imágenes o eliminar algunos ítems.`);\r\n      }\r\n    };\r\n\r\n    // Computados\r\n    const totalSales = computed(() => {\r\n      return soldItems.value.reduce((total, item) => {\r\n        return total + (item.quantity * item.price);\r\n      }, 0);\r\n    });\r\n\r\n    const formatPrice = (price) => {\r\n      if (isNaN(Number(price))) return '0,00';\r\n      const fixed = Number(price).toFixed(2);\r\n      const [intPart, decPart] = fixed.split('.');\r\n      const formattedIntPart = intPart.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\r\n      return `${formattedIntPart},${decPart}`;\r\n    };\r\n    \r\n    const formatDate = (dateStr) => {\r\n      if (!dateStr) return 'N/A';\r\n      const date = new Date(dateStr);\r\n      if (isNaN(date.getTime())) return 'Fecha inválida';\r\n      return new Intl.DateTimeFormat('es-ES', {\r\n        day: '2-digit',\r\n        month: '2-digit',\r\n        year: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit'\r\n      }).format(date);\r\n    };\r\n\r\n    const filteredSoldItems = computed(() => {\r\n      let items = soldItems.value;\r\n      if (!Array.isArray(items)) {\r\n        console.warn('soldItems no es un array. Devolviendo array vacío.');\r\n        return [];\r\n      }\r\n      if (searchTerm.value) {\r\n        const term = searchTerm.value.toLowerCase();\r\n        items = items.filter(item => {\r\n          return item && item.name && typeof item.name === 'string' && \r\n                 item.name.toLowerCase().includes(term);\r\n        });\r\n      }\r\n      if (categoryFilter.value) {\r\n        if (categoryFilter.value === 'drinks') {\r\n          items = items.filter(item => Boolean(item && item.includesDrink));\r\n        } else if (categoryFilter.value === 'nodrinks') {\r\n          items = items.filter(item => item && item.includesDrink === false);\r\n        }\r\n      }\r\n      if (sortBy.value) {\r\n        items = [...items];\r\n        switch (sortBy.value) {\r\n          case 'name':\r\n            items.sort((a, b) => {\r\n              if (!a || !a.name) return 1;\r\n              if (!b || !b.name) return -1;\r\n              return a.name.localeCompare(b.name);\r\n            });\r\n            break;\r\n          case 'quantity-desc':\r\n            items.sort((a, b) => {\r\n              const qtyA = (a && typeof a.quantity === 'number') ? a.quantity : 0;\r\n              const qtyB = (b && typeof b.quantity === 'number') ? b.quantity : 0;\r\n              return qtyB - qtyA;\r\n            });\r\n            break;\r\n          case 'quantity-asc':\r\n            items.sort((a, b) => {\r\n              const qtyA = (a && typeof a.quantity === 'number') ? a.quantity : 0;\r\n              const qtyB = (b && typeof b.quantity === 'number') ? b.quantity : 0;\r\n              return qtyA - qtyB;\r\n            });\r\n            break;\r\n          case 'price-desc':\r\n            items.sort((a, b) => {\r\n              const priceA = (a && typeof a.price === 'number') ? a.price : 0;\r\n              const priceB = (b && typeof b.price === 'number') ? b.price : 0;\r\n              return priceB - priceA;\r\n            });\r\n            break;\r\n          case 'price-asc':\r\n            items.sort((a, b) => {\r\n              const priceA = (a && typeof a.price === 'number') ? a.price : 0;\r\n              const priceB = (b && typeof b.price === 'number') ? b.price : 0;\r\n              return priceA - priceB;\r\n            });\r\n            break;\r\n          case 'date-desc':\r\n            items.sort((a, b) => {\r\n              const dateA = a && a.date ? new Date(a.date) : new Date(0);\r\n              const dateB = b && b.date ? new Date(b.date) : new Date(0);\r\n              return dateB - dateA;\r\n            });\r\n            break;\r\n          case 'date-asc':\r\n            items.sort((a, b) => {\r\n              const dateA = a && a.date ? new Date(a.date) : new Date(0);\r\n              const dateB = b && b.date ? new Date(b.date) : new Date(0);\r\n              return dateA - dateB;\r\n            });\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      }\r\n      return items;\r\n    });\r\n\r\n    const exportToExcel = () => {\r\n      // Crear un array con los datos a exportar\r\n      const data = [\r\n        ['Nombre del Plato', 'Categoría', 'Cantidad Vendida', 'Precio por Unidad', 'Fecha de Venta', 'Subtotal'],\r\n        ...filteredSoldItems.value.map(item => [\r\n          item.name,\r\n          item.includesDrink ? 'Con refresco' : 'Sin refresco',\r\n          item.quantity,\r\n          `$${formatPrice(item.price)}`,\r\n          formatDate(item.date),\r\n          `$${formatPrice(item.quantity * item.price)}`\r\n        ]),\r\n        ['', '', '', '', 'Total', `$${formatPrice(totalSales.value)}`]\r\n      ];\r\n\r\n      // Crear un libro de Excel y una hoja de cálculo\r\n      const ws = XLSX.utils.aoa_to_sheet(data);\r\n      const wb = XLSX.utils.book_new();\r\n      XLSX.utils.book_append_sheet(wb, ws, 'Ventas');\r\n\r\n      // Generar el archivo Excel y descargarlo\r\n      const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\r\n      const blob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\r\n      saveAs(blob, `ventas_${new Date().toLocaleDateString()}.xlsx`);\r\n    };\r\n\r\n    const exportToPDF = () => {\r\n      // Crear un nuevo documento PDF\r\n      const doc = new jsPDF();\r\n      \r\n      // Añadir título\r\n      doc.setFontSize(18);\r\n      doc.text('Reporte de Ventas', 14, 22);\r\n      doc.setFontSize(11);\r\n      doc.text(`Fecha: ${new Date().toLocaleDateString()}`, 14, 32);\r\n\r\n      // Crear la tabla con los datos\r\n      const tableData = filteredSoldItems.value.map(item => [\r\n        item.name,\r\n        item.includesDrink ? 'Con refresco' : 'Sin refresco',\r\n        item.quantity,\r\n        `$${formatPrice(item.price)}`,\r\n        formatDate(item.date),\r\n        `$${formatPrice(item.quantity * item.price)}`\r\n      ]);\r\n\r\n      // Añadir la tabla\r\n      doc.autoTable({\r\n        head: [['Nombre del Plato', 'Categoría', 'Cantidad Vendida', 'Precio por Unidad', 'Fecha de Venta', 'Subtotal']],\r\n        body: tableData,\r\n        foot: [['', '', '', '', 'Total', `$${formatPrice(totalSales.value)}`]],\r\n        startY: 40,\r\n        theme: 'striped',\r\n        headStyles: { fillColor: [76, 175, 80] },\r\n        footStyles: { fillColor: [240, 240, 240], textColor: [0, 0, 0], fontStyle: 'bold' }\r\n      });\r\n\r\n      // Guardar el PDF de exportación\r\n      doc.save(`ventas_${new Date().toLocaleDateString()}.pdf`);\r\n    };\r\n\r\n    const removeDuplicates = (array) => {\r\n      return [...new Set(array)];\r\n    };\r\n\r\n    return {\r\n      businessInfo,\r\n      showBusinessForm,\r\n      toggleBusinessForm,\r\n      onLogoChange,\r\n      saveBusinessInfo,\r\n      clearBusinessForm,\r\n      paymentInfo,\r\n      showPaymentForm,\r\n      togglePaymentForm,\r\n      onQRImageChange,\r\n      onNequiImageChange,\r\n      savePaymentInfo,\r\n      clearPaymentForm,\r\n      newItem,\r\n      menuItems,\r\n      showMenuForm,\r\n      isEditing,\r\n      toggleMenuForm,\r\n      onImageChange,\r\n      saveMenuItem,\r\n      editMenuItem,\r\n      deleteMenuItem,\r\n      sellMenuItem,\r\n      clearMenuForm,\r\n      soldItems,\r\n      totalSales,\r\n      searchTerm,\r\n      sortBy,\r\n      categoryFilter,\r\n      filteredSoldItems,\r\n      formatPrice,\r\n      selectedChartType,\r\n      exportToExcel,\r\n      exportToPDF,\r\n      shareLink,\r\n      showCopiedMessage,\r\n      shareByWhatsApp,\r\n      copyLink,\r\n      migrationStatus,\r\n      removeDuplicates,\r\n      chartError,\r\n      handleChartError,\r\n      notification,\r\n      formatDate,\r\n      newSpecialItem,\r\n      specialMenuItems,\r\n      showSpecialMenuForm,\r\n      isEditingSpecial,\r\n      editingSpecialIndex,\r\n      toggleSpecialMenuForm,\r\n      onSpecialImageChange,\r\n      saveSpecialMenuItem,\r\n      clearSpecialMenuForm,\r\n      editSpecialMenuItem,\r\n      deleteSpecialMenuItem,\r\n      sellSpecialMenuItem\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.menu-container {\r\n  padding: 20px;\r\n}\r\n\r\nsection {\r\n  margin-bottom: 40px;\r\n  padding: 20px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 8px;\r\n  background-color: #fff;\r\n}\r\n\r\nh2 {\r\n  color: #333;\r\n  font-size: 24px;\r\n  margin-bottom: 20px;\r\n  border-bottom: 2px solid #4CAF50;\r\n  padding-bottom: 10px;\r\n}\r\n\r\n.toggle-button {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 10px 15px;\r\n  margin-bottom: 20px;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n}\r\n\r\n.toggle-button:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\nform {\r\n  display: grid;\r\n  gap: 15px;\r\n}\r\n\r\nlabel {\r\n  font-weight: bold;\r\n}\r\n\r\ninput, textarea, select {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n}\r\n\r\n.button-group {\r\n  display: flex;\r\n  gap: 10px;\r\n  margin-top: 15px;\r\n}\r\n\r\n.save-button {\r\n  background-color: #007bff;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 10px 15px;\r\n  cursor: pointer;\r\n  flex: 1;\r\n}\r\n\r\n.save-button:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\n.clear-button {\r\n  background-color: #dc3545;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 10px 15px;\r\n  cursor: pointer;\r\n  flex: 1;\r\n}\r\n\r\n.clear-button:hover {\r\n  background-color: #c82333;\r\n}\r\n\r\n.business-preview {\r\n  margin-top: 20px;\r\n  padding: 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n/* Mejoras a la lista de platos */\r\n.menu-items-list {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\r\n  gap: 20px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.menu-item-card {\r\n  border: 1px solid #ddd;\r\n  border-radius: 8px;\r\n  background-color: #f9f9f9;\r\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.menu-item-card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 5px 15px rgba(0,0,0,0.2);\r\n}\r\n\r\n.menu-item-image-container {\r\n  width: 100%;\r\n  height: 200px;\r\n  position: relative;\r\n  overflow: hidden;\r\n  background-color: #f0f0f0;\r\n}\r\n\r\n.menu-item-image {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n  transition: transform 0.5s ease;\r\n}\r\n\r\n.menu-item-card:hover .menu-item-image {\r\n  transform: scale(1.05);\r\n}\r\n\r\n.no-image-placeholder {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n  color: #999;\r\n  font-style: italic;\r\n}\r\n\r\n.menu-item-details {\r\n  padding: 15px;\r\n  flex-grow: 1;\r\n}\r\n\r\n.menu-item-details h3 {\r\n  margin-top: 0;\r\n  color: #333;\r\n  font-size: 18px;\r\n}\r\n\r\n.menu-item-actions {\r\n  display: flex;\r\n  gap: 10px;\r\n  padding: 0 15px 15px;\r\n}\r\n\r\n.edit-button, .sell-button, .delete-button {\r\n  flex: 1;\r\n  padding: 8px 12px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.edit-button {\r\n  background-color: #ffc107;\r\n  color: #212529;\r\n}\r\n\r\n.edit-button:hover {\r\n  background-color: #e0a800;\r\n}\r\n\r\n.sell-button {\r\n  background-color: #28a745;\r\n  color: white;\r\n}\r\n\r\n.sell-button:hover {\r\n  background-color: #218838;\r\n}\r\n\r\n.delete-button {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n\r\n.delete-button:hover {\r\n  background-color: #c82333;\r\n}\r\n\r\n/* Mejoras a la sección de inventario */\r\n.inventory-section {\r\n  margin-bottom: 40px;\r\n}\r\n\r\n.inventory-controls {\r\n  margin-bottom: 20px;\r\n  display: grid;\r\n  gap: 15px;\r\n  grid-template-columns: 1fr;\r\n}\r\n\r\n@media (min-width: 768px) {\r\n  .inventory-controls {\r\n    grid-template-columns: repeat(3, 1fr);\r\n  }\r\n}\r\n\r\n.inventory-search-input {\r\n  width: 100%;\r\n  padding: 10px 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);\r\n}\r\n\r\n.inventory-filters, \r\n.inventory-actions {\r\n  display: flex;\r\n  gap: 10px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.inventory-filter {\r\n  flex: 1;\r\n  min-width: 150px;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  background-color: white;\r\n}\r\n\r\n.export-button {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 8px;\r\n  padding: 10px 15px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.export-button.excel {\r\n  background-color: #1D6F42;\r\n  color: white;\r\n}\r\n\r\n.export-button.excel:hover {\r\n  background-color: #165235;\r\n}\r\n\r\n.export-button.pdf {\r\n  background-color: #F40F02;\r\n  color: white;\r\n}\r\n\r\n.export-button.pdf:hover {\r\n  background-color: #C90C02;\r\n}\r\n\r\n.action-icon {\r\n  font-size: 18px;\r\n}\r\n\r\n.sales-chart-container {\r\n  margin-bottom: 20px;\r\n  background-color: white;\r\n  padding: 15px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n  min-height: 300px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.empty-chart-message {\r\n  color: #666;\r\n  font-style: italic;\r\n  text-align: center;\r\n  width: 100%;\r\n  padding: 50px 20px;\r\n}\r\n\r\n.sales-chart {\r\n  margin-bottom: 20px;\r\n  background-color: white;\r\n  padding: 15px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n}\r\n\r\n.inventory-table {\r\n  overflow-x: auto;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n}\r\n\r\ntable {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\nth, td {\r\n  padding: 15px;\r\n  text-align: left;\r\n}\r\n\r\nthead {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\nthead th {\r\n  font-weight: 600;\r\n}\r\n\r\ntbody tr:hover {\r\n  background-color: #f1f1f1;\r\n}\r\n\r\n.alternate-row {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\ntfoot {\r\n  background-color: #e9e9e9;\r\n  font-weight: bold;\r\n}\r\n\r\ntfoot td {\r\n  padding: 12px 15px;\r\n}\r\n\r\n.share-buttons {\r\n  display: flex;\r\n  gap: 15px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.whatsapp-button, .copy-button {\r\n  flex: 1;\r\n  padding: 12px 15px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-weight: bold;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.whatsapp-button {\r\n  background-color: #25D366;\r\n  color: white;\r\n}\r\n\r\n.whatsapp-button:hover {\r\n  background-color: #128C7E;\r\n}\r\n\r\n.copy-button {\r\n  background-color: #6c757d;\r\n  color: white;\r\n}\r\n\r\n.copy-button:hover {\r\n  background-color: #5a6268;\r\n}\r\n\r\n.emoji {\r\n  font-size: 1.2em;\r\n  margin-right: 8px;\r\n}\r\n\r\n.copied-message {\r\n  color: #28a745;\r\n  margin-top: 10px;\r\n}\r\n\r\n.share-link {\r\n  margin-top: 15px;\r\n  padding: 10px;\r\n  background-color: #f8f9fa;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  word-break: break-all;\r\n}\r\n\r\n.migration-status {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 20px;\r\n  background-color: #ffeb3b;\r\n  color: #333;\r\n  padding: 15px 20px;\r\n  border-radius: 6px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\r\n  z-index: 1000;\r\n  max-width: 300px;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.migration-status.completed {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\n.migration-message {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.loading-spinner {\r\n  display: inline-block;\r\n  width: 18px;\r\n  height: 18px;\r\n  border: 3px solid rgba(0, 0, 0, 0.1);\r\n  border-radius: 50%;\r\n  border-top-color: #333;\r\n  animation: spin 1s ease-in-out infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n/* Estilos para notificaciones */\r\n.notification {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 20px;\r\n  padding: 15px 20px;\r\n  border-radius: 4px;\r\n  color: white;\r\n  font-weight: bold;\r\n  z-index: 1001;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  min-width: 300px;\r\n  max-width: 500px;\r\n  animation: slide-in 0.3s ease-out;\r\n}\r\n\r\n.notification.success {\r\n  background-color: #4CAF50;\r\n}\r\n\r\n.notification.error {\r\n  background-color: #f44336;\r\n}\r\n\r\n.notification-close {\r\n  background: transparent;\r\n  border: none;\r\n  color: white;\r\n  font-size: 20px;\r\n  margin-left: 15px;\r\n  cursor: pointer;\r\n  padding: 0 5px;\r\n}\r\n\r\n@keyframes slide-in {\r\n  from {\r\n    transform: translateX(100%);\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    transform: translateX(0);\r\n    opacity: 1;\r\n  }\r\n}\r\n</style>"],"mappings":";;;;;;;;;;;;;AA+WA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAQ,QAAS,KAAK;AAC9C,SAASC,QAAO,QAAS,yBAAyB;AAClD,SAASC,sBAAqB,QAAS,2BAA2B;AAClE,OAAOC,mBAAkB,MAAO,2BAA2B;AAC3D,SAASC,MAAK,QAAS,YAAY;AACnC,OAAO,KAAKC,IAAG,MAAO,MAAM;AAC5B,SAASC,KAAI,QAAS,OAAO;AAC7B,OAAO,iBAAiB;AACxB,SACEC,YAAY,EACZC,aAAa,EACbC,eAAe,EACfC,gBAAe,IAAKC,oBAAoB,EACxCC,YAAY,EACZC,aAAa,EACbC,oBAAoB,EACpBC,uBAAuB,EACvBC,aAAY,QACP,4BAA4B;AACnC,SAASC,OAAO,EAAEC,KAAI,QAAS,2BAA2B;AAE1D,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,UAAU,EAAE;IACVjB;EACF,CAAC;EACDkB,KAAKA,CAAA,EAAG;IACN;IACA,MAAMC,YAAW,GAAIxB,GAAG,CAAC;MACvBqB,IAAI,EAAE,EAAE;MACRI,WAAW,EAAE,EAAE;MACfC,OAAO,EAAE,EAAE;MACXC,OAAO,EAAE,EAAE;MACXC,IAAI,EAAE;IACR,CAAC,CAAC;IACF,MAAMC,gBAAe,GAAI7B,GAAG,CAAC,KAAK,CAAC;;IAEnC;IACA,MAAM8B,WAAU,GAAI9B,GAAG,CAAC;MACtB+B,OAAO,EAAE,EAAE;MACXC,OAAO,EAAE,EAAE;MACXC,WAAW,EAAE,EAAE;MACfC,UAAU,EAAE;IACd,CAAC,CAAC;IACF,MAAMC,eAAc,GAAInC,GAAG,CAAC,KAAK,CAAC;;IAElC;IACA,MAAMoC,OAAM,GAAIpC,GAAG,CAAC;MAClBqB,IAAI,EAAE,EAAE;MACRI,WAAW,EAAE,EAAE;MACfY,KAAK,EAAE,CAAC;MACRC,aAAa,EAAE,KAAK;MACpBC,iBAAiB,EAAE,CAAC;MACpBC,KAAK,EAAE,EAAE;MACTC,EAAE,EAAE;IACN,CAAC,CAAC;IACF,MAAMC,SAAQ,GAAI1C,GAAG,CAAC,EAAE,CAAC;IACzB,MAAM2C,YAAW,GAAI3C,GAAG,CAAC,KAAK,CAAC;IAC/B,MAAM4C,SAAQ,GAAI5C,GAAG,CAAC,KAAK,CAAC;IAC5B,MAAM6C,YAAW,GAAI7C,GAAG,CAAC,CAAC,CAAC,CAAC;;IAE5B;IACA,MAAM8C,SAAQ,GAAI9C,GAAG,CAAC,EAAE,CAAC;IACzB,MAAM+C,UAAS,GAAI/C,GAAG,CAAC,EAAE,CAAC;IAC1B,MAAMgD,MAAK,GAAIhD,GAAG,CAAC,EAAE,CAAC;IACtB,MAAMiD,cAAa,GAAIjD,GAAG,CAAC,EAAE,CAAC;IAC9B,MAAMkD,iBAAgB,GAAIlD,GAAG,CAAC,KAAK,CAAC;;IAEpC;IACA,MAAMmD,SAAQ,GAAInD,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMoD,iBAAgB,GAAIpD,GAAG,CAAC,KAAK,CAAC;;IAEpC;IACA,MAAMqD,eAAc,GAAIrD,GAAG,CAAC;MAC1BsD,UAAU,EAAE,KAAK;MACjBC,SAAS,EAAE,KAAK;MAChBC,OAAO,EAAE;IACX,CAAC,CAAC;;IAEF;IACA,MAAMC,UAAS,GAAIzD,GAAG,CAAC,IAAI,CAAC;;IAE5B;IACA,MAAM0D,gBAAe,GAAKC,KAAK,IAAK;MAClCC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5CF,UAAU,CAACI,KAAI,GAAIF,KAAK;IAC1B,CAAC;;IAED;IACA,MAAMG,YAAW,GAAI9D,GAAG,CAAC;MACvB+D,IAAI,EAAE,KAAK;MACXP,OAAO,EAAE,EAAE;MACXQ,IAAI,EAAE,SAAS;MAAE;MACjBC,OAAO,EAAE;IACX,CAAC,CAAC;;IAEF;IACA,MAAMC,cAAa,GAAIlE,GAAG,CAAC;MACzBqB,IAAI,EAAE,EAAE;MACRI,WAAW,EAAE,EAAE;MACfY,KAAK,EAAE,CAAC;MACRC,aAAa,EAAE,KAAK;MACpBC,iBAAiB,EAAE,CAAC;MACpBC,KAAK,EAAE,EAAE;MACTC,EAAE,EAAE;IACN,CAAC,CAAC;IACF,MAAM0B,gBAAe,GAAInE,GAAG,CAAC,EAAE,CAAC;IAChC,MAAMoE,mBAAkB,GAAIpE,GAAG,CAAC,KAAK,CAAC;IACtC,MAAMqE,gBAAe,GAAIrE,GAAG,CAAC,KAAK,CAAC;IACnC,MAAMsE,mBAAkB,GAAItE,GAAG,CAAC,CAAC,CAAC,CAAC;;IAEnC;IACAE,SAAS,CAAC,YAAY;MACpB,IAAI;QACFmD,eAAe,CAACQ,KAAK,CAACP,UAAS,GAAI,IAAI;QACvCD,eAAe,CAACQ,KAAK,CAACL,OAAM,GAAI,mBAAmB;QAEnD,MAAMe,YAAW,GAAIC,YAAY,CAACC,OAAO,CAAC,cAAc,KACnCD,YAAY,CAACC,OAAO,CAAC,WAAW,KAChCD,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;QAEtD,IAAIF,YAAY,EAAE;UAChBlB,eAAe,CAACQ,KAAK,CAACL,OAAM,GAAI,kDAAkD;UAElF,MAAMkB,eAAc,GAAI,MAAMzD,uBAAuB,CAAC,CAAC;UAEvD,IAAIyD,eAAe,EAAE;YACnBrB,eAAe,CAACQ,KAAK,CAACN,SAAQ,GAAI,IAAI;YACtCF,eAAe,CAACQ,KAAK,CAACL,OAAM,GAAI,mCAAmC;YACnEgB,YAAY,CAACG,UAAU,CAAC,cAAc,CAAC;YACvCH,YAAY,CAACG,UAAU,CAAC,WAAW,CAAC;YACpCH,YAAY,CAACG,UAAU,CAAC,WAAW,CAAC;UACtC,OAAO;YACLtB,eAAe,CAACQ,KAAK,CAACL,OAAM,GAAI,gCAAgC;UAClE;QACF;QAEA,MAAMoB,cAAa,GAAI,MAAMjE,eAAe,CAAC,CAAC;QAC9C,IAAIiE,cAAa,IAAKA,cAAc,CAACvD,IAAI,EAAE;UACzCG,YAAY,CAACqC,KAAI,GAAIe,cAAc;QACrC;QAEA,MAAMC,WAAU,GAAI,MAAMpE,YAAY,CAAC,CAAC;QACxC,IAAIoE,WAAU,IAAKA,WAAW,CAACC,MAAK,GAAI,CAAC,EAAE;UACzCpC,SAAS,CAACmB,KAAI,GAAIgB,WAAW;;UAE7B;UACA,MAAME,YAAW,GAAIF,WAAW,CAACG,MAAM,CAACC,IAAG,IAAKA,IAAI,CAACC,SAAQ,KAAM,IAAI,CAAC;UACxE,IAAIH,YAAY,CAACD,MAAK,GAAI,CAAC,EAAE;YAC3BX,gBAAgB,CAACN,KAAI,GAAIkB,YAAY;UACvC;QACF;QAEA,MAAMI,WAAU,GAAI,MAAMrE,YAAY,CAAC,CAAC;QACxC,IAAIqE,WAAU,IAAKA,WAAW,CAACL,MAAK,GAAI,CAAC,EAAE;UACzChC,SAAS,CAACe,KAAI,GAAIsB,WAAW;QAC/B;QAEAC,UAAU,CAAC,MAAM;UACf/B,eAAe,CAACQ,KAAK,CAACP,UAAS,GAAI,KAAK;QAC1C,CAAC,EAAE,IAAI,CAAC;MACV,EAAE,OAAOK,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;QAC9CN,eAAe,CAACQ,KAAK,CAACL,OAAM,GAAI,yBAAwB,GAAIG,KAAK,CAACH,OAAO;QACzE4B,UAAU,CAAC,MAAM;UACf/B,eAAe,CAACQ,KAAK,CAACP,UAAS,GAAI,KAAK;QAC1C,CAAC,EAAE,IAAI,CAAC;MACV;IACF,CAAC,CAAC;;IAEF;IACA,MAAM+B,kBAAiB,GAAIA,CAAA,KAAM;MAC/BxD,gBAAgB,CAACgC,KAAI,GAAI,CAAChC,gBAAgB,CAACgC,KAAK;IAClD,CAAC;IAED,MAAMyB,YAAW,GAAI,MAAOC,KAAK,IAAK;MACpC,MAAMC,IAAG,GAAID,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAClC,IAAIF,IAAI,EAAE;QACR,MAAMG,MAAK,GAAI,IAAIC,UAAU,CAAC,CAAC;QAC/BD,MAAM,CAACE,MAAK,GAAI,MAAOC,CAAC,IAAK;UAC3B,MAAMC,cAAa,GAAI,MAAM7E,aAAa,CAAC4E,CAAC,CAACL,MAAM,CAACO,MAAM,CAAC;UAC3DxE,YAAY,CAACqC,KAAK,CAACjC,IAAG,GAAImE,cAAc;QAC1C,CAAC;QACDJ,MAAM,CAACM,aAAa,CAACT,IAAI,CAAC;MAC5B;IACF,CAAC;IAED,MAAM5E,gBAAe,GAAI,MAAAA,CAAA,KAAY;MACnC,IAAI;QACF,IAAIkD,YAAY,CAACD,KAAK,CAACI,OAAO,EAAE;UAC9BiC,YAAY,CAACpC,YAAY,CAACD,KAAK,CAACI,OAAO,CAAC;QAC1C;QAEA,MAAMpD,oBAAoB,CAACW,YAAY,CAACqC,KAAK,CAAC;QAE9CC,YAAY,CAACD,KAAI,GAAI;UACnBE,IAAI,EAAE,IAAI;UACVP,OAAO,EAAE,6CAA6C;UACtDQ,IAAI,EAAE,SAAS;UACfC,OAAO,EAAEmB,UAAU,CAAC,MAAM;YACxBtB,YAAY,CAACD,KAAK,CAACE,IAAG,GAAI,KAAK;UACjC,CAAC,EAAE,IAAI;QACT,CAAC;MACH,EAAE,OAAOJ,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,2CAA2C,EAAEA,KAAK,CAAC;QAEjEG,YAAY,CAACD,KAAI,GAAI;UACnBE,IAAI,EAAE,IAAI;UACVP,OAAO,EAAE,iEAAiE;UAC1EQ,IAAI,EAAE,OAAO;UACbC,OAAO,EAAEmB,UAAU,CAAC,MAAM;YACxBtB,YAAY,CAACD,KAAK,CAACE,IAAG,GAAI,KAAK;UACjC,CAAC,EAAE,IAAI;QACT,CAAC;MACH;IACF,CAAC;IAED,MAAMoC,iBAAgB,GAAI,MAAAA,CAAA,KAAY;MACpC,MAAMC,SAAQ,GAAI,MAAMjF,OAAO,CAAC,gDAAgD,CAAC;MACjF,IAAIiF,SAAS,EAAE;QACb5E,YAAY,CAACqC,KAAI,GAAI;UACnBxC,IAAI,EAAE,EAAE;UACRI,WAAW,EAAE,EAAE;UACfC,OAAO,EAAE,EAAE;UACXC,OAAO,EAAE,EAAE;UACXC,IAAI,EAAE;QACR,CAAC;MACH;IACF,CAAC;;IAED;IACA,MAAMyE,iBAAgB,GAAIA,CAAA,KAAM;MAC9BlE,eAAe,CAAC0B,KAAI,GAAI,CAAC1B,eAAe,CAAC0B,KAAK;IAChD,CAAC;IAED,MAAMyC,eAAc,GAAI,MAAOf,KAAK,IAAK;MACvC,MAAMC,IAAG,GAAID,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAClC,IAAIF,IAAI,EAAE;QACR,MAAMG,MAAK,GAAI,IAAIC,UAAU,CAAC,CAAC;QAC/BD,MAAM,CAACE,MAAK,GAAI,MAAOC,CAAC,IAAK;UAC3B,MAAMS,eAAc,GAAI,MAAMrF,aAAa,CAAC4E,CAAC,CAACL,MAAM,CAACO,MAAM,CAAC;UAC5DlE,WAAW,CAAC+B,KAAK,CAAC7B,OAAM,GAAIuE,eAAe;QAC7C,CAAC;QACDZ,MAAM,CAACM,aAAa,CAACT,IAAI,CAAC;MAC5B;IACF,CAAC;IAED,MAAMgB,kBAAiB,GAAI,MAAOjB,KAAK,IAAK;MAC1C,MAAMC,IAAG,GAAID,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAClC,IAAIF,IAAI,EAAE;QACR,MAAMG,MAAK,GAAI,IAAIC,UAAU,CAAC,CAAC;QAC/BD,MAAM,CAACE,MAAK,GAAI,MAAOC,CAAC,IAAK;UAC3B,MAAMS,eAAc,GAAI,MAAMrF,aAAa,CAAC4E,CAAC,CAACL,MAAM,CAACO,MAAM,CAAC;UAC5DlE,WAAW,CAAC+B,KAAK,CAAC3B,UAAS,GAAIqE,eAAe;QAChD,CAAC;QACDZ,MAAM,CAACM,aAAa,CAACT,IAAI,CAAC;MAC5B;IACF,CAAC;IAED,MAAMiB,eAAc,GAAI,MAAAA,CAAA,KAAY;MAClC,IAAI;QACF,IAAI3C,YAAY,CAACD,KAAK,CAACI,OAAO,EAAE;UAC9BiC,YAAY,CAACpC,YAAY,CAACD,KAAK,CAACI,OAAO,CAAC;QAC1C;QAEAzC,YAAY,CAACqC,KAAK,CAAC/B,WAAU,GAAI;UAAE,GAAGA,WAAW,CAAC+B;QAAM,CAAC;QAEzD,MAAMhD,oBAAoB,CAACW,YAAY,CAACqC,KAAK,CAAC;QAE9CC,YAAY,CAACD,KAAI,GAAI;UACnBE,IAAI,EAAE,IAAI;UACVP,OAAO,EAAE,yCAAyC;UAClDQ,IAAI,EAAE,SAAS;UACfC,OAAO,EAAEmB,UAAU,CAAC,MAAM;YACxBtB,YAAY,CAACD,KAAK,CAACE,IAAG,GAAI,KAAK;UACjC,CAAC,EAAE,IAAI;QACT,CAAC;MACH,EAAE,OAAOJ,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,uCAAuC,EAAEA,KAAK,CAAC;QAE7DG,YAAY,CAACD,KAAI,GAAI;UACnBE,IAAI,EAAE,IAAI;UACVP,OAAO,EAAE,yEAAyE;UAClFQ,IAAI,EAAE,OAAO;UACbC,OAAO,EAAEmB,UAAU,CAAC,MAAM;YACxBtB,YAAY,CAACD,KAAK,CAACE,IAAG,GAAI,KAAK;UACjC,CAAC,EAAE,IAAI;QACT,CAAC;MACH;IACF,CAAC;IAED,MAAM2C,gBAAe,GAAI,MAAAA,CAAA,KAAY;MACnC,MAAMN,SAAQ,GAAI,MAAMjF,OAAO,CAAC,yDAAyD,CAAC;MAC1F,IAAIiF,SAAS,EAAE;QACbtE,WAAW,CAAC+B,KAAI,GAAI;UAClB9B,OAAO,EAAE,EAAE;UACXC,OAAO,EAAE,EAAE;UACXC,WAAW,EAAE,EAAE;UACfC,UAAU,EAAE;QACd,CAAC;MACH;IACF,CAAC;;IAED;IACA,MAAMyE,cAAa,GAAIA,CAAA,KAAM;MAC3BhE,YAAY,CAACkB,KAAI,GAAI,CAAClB,YAAY,CAACkB,KAAK;MACxC,IAAI,CAAClB,YAAY,CAACkB,KAAK,EAAE;QACvB+C,aAAa,CAAC,CAAC;MACjB;IACF,CAAC;IAED,MAAMC,aAAY,GAAI,MAAOtB,KAAK,IAAK;MACrC,MAAMC,IAAG,GAAID,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAClC,IAAIF,IAAI,EAAE;QACR,MAAMG,MAAK,GAAI,IAAIC,UAAU,CAAC,CAAC;QAC/BD,MAAM,CAACE,MAAK,GAAI,MAAOC,CAAC,IAAK;UAC3B,MAAMS,eAAc,GAAI,MAAMrF,aAAa,CAAC4E,CAAC,CAACL,MAAM,CAACO,MAAM,CAAC;UAC5D5D,OAAO,CAACyB,KAAK,CAACrB,KAAI,GAAI+D,eAAe;QACvC,CAAC;QACDZ,MAAM,CAACM,aAAa,CAACT,IAAI,CAAC;MAC5B;IACF,CAAC;IAED,MAAMsB,YAAW,GAAI,MAAAA,CAAA,KAAY;MAC/B,IAAI;QACF,IAAI,CAAC1E,OAAO,CAACyB,KAAK,CAACpB,EAAE,EAAE;UACrBL,OAAO,CAACyB,KAAK,CAACpB,EAAC,GAAIsE,IAAI,CAACC,GAAG,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;QAC7E;QAEA,IAAIxE,SAAS,CAACiB,KAAK,EAAE;UACnB,MAAMwD,KAAI,GAAI3E,SAAS,CAACmB,KAAK,CAACyD,SAAS,CAACrC,IAAG,IAAKA,IAAI,CAACxC,EAAC,KAAML,OAAO,CAACyB,KAAK,CAACpB,EAAE,CAAC;UAC7E,IAAI4E,KAAI,KAAM,CAAC,CAAC,EAAE;YAChB3E,SAAS,CAACmB,KAAK,CAACwD,KAAK,IAAI;cAAE,GAAGjF,OAAO,CAACyB;YAAM,CAAC;UAC/C;UACAjB,SAAS,CAACiB,KAAI,GAAI,KAAK;UACvBhB,YAAY,CAACgB,KAAI,GAAI,CAAC,CAAC;UACvB,MAAMzC,KAAK,CAAC,8BAA8B,CAAC;QAC7C,OAAO;UACL,MAAMmG,YAAW,GAAI7E,SAAS,CAACmB,KAAK,CAAC2D,IAAI,CAACvC,IAAG,IAC3CA,IAAI,CAAC5D,IAAI,CAACoG,WAAW,CAAC,MAAMrF,OAAO,CAACyB,KAAK,CAACxC,IAAI,CAACoG,WAAW,CAAC,CAC7D,CAAC;UAED,IAAIF,YAAY,EAAE;YAChB,MAAMnB,SAAQ,GAAI,MAAMjF,OAAO,CAC7B,+BAA+BiB,OAAO,CAACyB,KAAK,CAACxC,IAAI,yBAAyB,EAC1E;cAAEqG,KAAK,EAAE;YAA6B,CACxC,CAAC;YAED,IAAItB,SAAS,EAAE;cACb,MAAMiB,KAAI,GAAI3E,SAAS,CAACmB,KAAK,CAACyD,SAAS,CAACrC,IAAG,IAAKA,IAAI,CAACxC,EAAC,KAAM8E,YAAY,CAAC9E,EAAE,CAAC;cAC5E,IAAI4E,KAAI,KAAM,CAAC,CAAC,EAAE;gBAChBjF,OAAO,CAACyB,KAAK,CAACpB,EAAC,GAAI8E,YAAY,CAAC9E,EAAE;gBAClCC,SAAS,CAACmB,KAAK,CAACwD,KAAK,IAAI;kBAAE,GAAGjF,OAAO,CAACyB;gBAAM,CAAC;gBAC7C,MAAMzC,KAAK,CAAC,8BAA8B,CAAC;cAC7C;YACF,OAAO;cACL;YACF;UACF,OAAO;YACLsB,SAAS,CAACmB,KAAK,CAAC8D,IAAI,CAAC;cAAE,GAAGvF,OAAO,CAACyB;YAAM,CAAC,CAAC;YAC1C,MAAMzC,KAAK,CAAC,yBAAyB,CAAC;UACxC;QACF;;QAEA;QACA,MAAMwG,QAAO,GAAI,CACf,GAAGlF,SAAS,CAACmB,KAAK,CAACmB,MAAM,CAACC,IAAG,IAAK,CAACA,IAAI,CAACC,SAAS,CAAC,EAClD,GAAGf,gBAAgB,CAACN,KAAI,CACzB;QAED,MAAMnD,aAAa,CAACkH,QAAQ,CAAC;QAC7BhB,aAAa,CAAC,CAAC;MACjB,EAAE,OAAOjD,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;QAClD,MAAMvC,KAAK,CAAC,2DAA2D,CAAC;MAC1E;IACF,CAAC;IAED,MAAMwF,aAAY,GAAIA,CAAA,KAAM;MAC1BxE,OAAO,CAACyB,KAAI,GAAI;QACdxC,IAAI,EAAE,EAAE;QACRI,WAAW,EAAE,EAAE;QACfY,KAAK,EAAE,CAAC;QACRC,aAAa,EAAE,KAAK;QACpBC,iBAAiB,EAAE,CAAC;QACpBC,KAAK,EAAE,EAAE;QACTC,EAAE,EAAE;MACN,CAAC;MACDG,SAAS,CAACiB,KAAI,GAAI,KAAK;MACvBhB,YAAY,CAACgB,KAAI,GAAI,CAAC,CAAC;IACzB,CAAC;IAED,MAAMgE,YAAW,GAAKR,KAAK,IAAK;MAC9BjF,OAAO,CAACyB,KAAI,GAAI;QAAE,GAAGnB,SAAS,CAACmB,KAAK,CAACwD,KAAK;MAAE,CAAC;MAC7CzE,SAAS,CAACiB,KAAI,GAAI,IAAI;MACtBhB,YAAY,CAACgB,KAAI,GAAIwD,KAAK;MAC1B1E,YAAY,CAACkB,KAAI,GAAI,IAAI;IAC3B,CAAC;IAED,MAAMiE,cAAa,GAAI,MAAOT,KAAK,IAAK;MACtC,MAAMjB,SAAQ,GAAI,MAAMjF,OAAO,CAAC,8CAA8C,EAAE;QAC9EuG,KAAK,EAAE,gBAAgB;QACvBK,WAAW,EAAE,UAAU;QACvBC,UAAU,EAAE;MACd,CAAC,CAAC;MAEF,IAAI5B,SAAS,EAAE;QACb,IAAI;UACF,IAAIiB,KAAI,GAAI,KAAKA,KAAI,IAAK3E,SAAS,CAACmB,KAAK,CAACiB,MAAM,EAAE;YAChDlB,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAE0D,KAAK,CAAC;YACpD,MAAMjG,KAAK,CAAC,8CAA8C,CAAC;YAC3D;UACF;UAEA,MAAM6D,IAAG,GAAIvC,SAAS,CAACmB,KAAK,CAACwD,KAAK,CAAC;UACnCzD,OAAO,CAACqE,GAAG,CAAC,4BAA4BZ,KAAK,YAAYpC,IAAI,CAAC5D,IAAI,QAAQ4D,IAAI,CAACxC,EAAE,EAAE,CAAC;UAEpF,IAAI,CAACwC,IAAI,EAAE;YACTrB,OAAO,CAACD,KAAK,CAAC,qDAAqD,EAAE0D,KAAK,CAAC;YAC3E,MAAMjG,KAAK,CAAC,8CAA8C,CAAC;YAC3D;UACF;UAEA,MAAM8G,QAAO,GAAIjD,IAAI,CAAC5D,IAAG,IAAK,qBAAqB;UACnD,MAAM8G,WAAU,GAAI,IAAIpB,IAAI,CAAC,CAAC,CAACqB,WAAW,CAAC,CAAC;UAE5C,IAAI,CAACC,KAAK,CAACC,OAAO,CAACxF,SAAS,CAACe,KAAK,CAAC,EAAE;YACnCD,OAAO,CAAC2E,IAAI,CAAC,gEAAgE,CAAC;YAC9EzF,SAAS,CAACe,KAAI,GAAI,EAAE;UACtB;UAEA,MAAM2E,QAAO,GAAI1F,SAAS,CAACe,KAAK,CAAC2D,IAAI,CAACiB,IAAG,IACvCA,IAAG,IAAK,OAAOA,IAAG,KAAM,QAAO,IAAKA,IAAI,CAACpH,IAAG,KAAM6G,QACpD,CAAC;UAED,IAAIM,QAAQ,EAAE;YACZA,QAAQ,CAACE,QAAO,IAAK,CAAC;YACtB,IAAI,CAACF,QAAQ,CAACG,IAAG,IAAK,IAAI5B,IAAI,CAACoB,WAAW,IAAI,IAAIpB,IAAI,CAACyB,QAAQ,CAACG,IAAI,CAAC,EAAE;cACrEH,QAAQ,CAACG,IAAG,GAAIR,WAAW;YAC7B;UACF,OAAO;YACL,MAAMS,WAAU,GAAI;cAClBvH,IAAI,EAAE6G,QAAQ;cACdQ,QAAQ,EAAE,CAAC;cACXrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;cAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;cAC1CqG,IAAI,EAAER;YACR,CAAC;YAEDrF,SAAS,CAACe,KAAK,CAAC8D,IAAI,CAACiB,WAAW,CAAC;UACnC;UAEA,MAAMG,cAAa,GAAIjG,SAAS,CAACe,KAAK,CAACmF,GAAG,CAAC/D,IAAG,IAAK;YACjD,IAAI,CAACA,IAAG,IAAK,OAAOA,IAAG,KAAM,QAAQ,EAAE;cACrC,OAAO;gBACL5D,IAAI,EAAE,sBAAsB;gBAC5BqH,QAAQ,EAAE,CAAC;gBACXrG,KAAK,EAAE,CAAC;gBACRC,aAAa,EAAE,KAAK;gBACpBqG,IAAI,EAAER;cACR,CAAC;YACH;YAEA,OAAO;cACL9G,IAAI,EAAE4H,MAAM,CAAChE,IAAI,CAAC5D,IAAG,IAAK,sBAAsB,CAAC;cACjDqH,QAAQ,EAAEG,MAAM,CAAC5D,IAAI,CAACyD,QAAQ,KAAK,CAAC;cACpCrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;cAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;cAC1CqG,IAAI,EAAE1D,IAAI,CAAC0D,IAAG,IAAKR;YACrB,CAAC;UACH,CAAC,CAAC;UAEF,MAAMpH,aAAa,CAACgI,cAAc,CAAC;UAEnC,IAAI9D,IAAI,CAACxC,EAAE,EAAE;YACX,IAAI;cACFmB,OAAO,CAACqE,GAAG,CAAC,4CAA4ChD,IAAI,CAACxC,EAAE,EAAE,CAAC;cAClE,MAAMyG,YAAW,GAAI,MAAMlI,oBAAoB,CAACiE,IAAI,CAACxC,EAAE,CAAC;cACxDmB,OAAO,CAACqE,GAAG,CAAC,gCAAgCiB,YAAY,EAAE,CAAC;YAC7D,EAAE,OAAOC,WAAW,EAAE;cACpBvF,OAAO,CAACD,KAAK,CAAC,qCAAqC,EAAEwF,WAAW,CAAC;YACnE;UACF;UAEAzG,SAAS,CAACmB,KAAK,CAACuF,MAAM,CAAC/B,KAAK,EAAE,CAAC,CAAC;UAChCvE,SAAS,CAACe,KAAI,GAAIkF,cAAc;UAEhCnF,OAAO,CAACqE,GAAG,CAAC,iDAAiD,CAAC;QAEhE,EAAE,OAAOtE,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;UACnD,MAAMvC,KAAK,CAAC,4DAA4D,CAAC;QAC3E;MACF;IACF,CAAC;IAED,MAAMiI,YAAW,GAAI,MAAOhC,KAAK,IAAK;MACpC,IAAI;QACF,MAAMpC,IAAG,GAAIvC,SAAS,CAACmB,KAAK,CAACwD,KAAK,CAAC;QAEnC,IAAIpC,IAAI,CAAC1C,iBAAgB,IAAK,CAAC,EAAE;UAC/B,MAAMnB,KAAK,CAAC,4CAA4C,CAAC;UACzD;QACF;QAEA6D,IAAI,CAAC1C,iBAAiB,EAAE;QAExB,MAAMiG,QAAO,GAAI1F,SAAS,CAACe,KAAK,CAAC2D,IAAI,CAACiB,IAAG,IAAKA,IAAI,CAACpH,IAAG,KAAM4D,IAAI,CAAC5D,IAAI,CAAC;QACtE,MAAM8G,WAAU,GAAI,IAAIpB,IAAI,CAAC,CAAC,CAACqB,WAAW,CAAC,CAAC;QAE5C,IAAII,QAAQ,EAAE;UACZA,QAAQ,CAACE,QAAO,IAAK,CAAC;UACtB,IAAI,CAACF,QAAQ,CAACG,IAAG,IAAK,IAAI5B,IAAI,CAACoB,WAAW,IAAI,IAAIpB,IAAI,CAACyB,QAAQ,CAACG,IAAI,CAAC,EAAE;YACrEH,QAAQ,CAACG,IAAG,GAAIR,WAAW;UAC7B;QACF,OAAO;UACL,MAAMS,WAAU,GAAI;YAClBvH,IAAI,EAAE4D,IAAI,CAAC5D,IAAG,IAAK,qBAAqB;YACxCqH,QAAQ,EAAE,CAAC;YACXrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;YAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;YAC1CqG,IAAI,EAAER;UACR,CAAC;UAEDrF,SAAS,CAACe,KAAK,CAAC8D,IAAI,CAACiB,WAAW,CAAC;QACnC;QAEA,MAAMG,cAAa,GAAIjG,SAAS,CAACe,KAAK,CAACmF,GAAG,CAAC/D,IAAG,KAAM;UAClD5D,IAAI,EAAE4H,MAAM,CAAChE,IAAI,CAAC5D,IAAG,IAAK,sBAAsB,CAAC;UACjDqH,QAAQ,EAAEG,MAAM,CAAC5D,IAAI,CAACyD,QAAQ,KAAK,CAAC;UACpCrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;UAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;UAC1CqG,IAAI,EAAE1D,IAAI,CAAC0D,IAAG,IAAKR;QACrB,CAAC,CAAC,CAAC;QAEH,MAAMzH,aAAa,CAACgC,SAAS,CAACmB,KAAK,CAAC;QACpC,MAAM9C,aAAa,CAACgI,cAAc,CAAC;QAEnCjG,SAAS,CAACe,KAAI,GAAIkF,cAAc;QAEhC,MAAM3H,KAAK,CAAC,gCAAgC6D,IAAI,CAAC5D,IAAI,GAAG,CAAC;MAE3D,EAAE,OAAOsC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjD,MAAMvC,KAAK,CAAC,4DAA4D,CAAC;MAC3E;IACF,CAAC;;IAED;IACA,MAAMkI,qBAAoB,GAAIA,CAAA,KAAM;MAClClF,mBAAmB,CAACP,KAAI,GAAI,CAACO,mBAAmB,CAACP,KAAK;MACtD,IAAI,CAACO,mBAAmB,CAACP,KAAK,EAAE;QAC9B0F,oBAAoB,CAAC,CAAC;MACxB;IACF,CAAC;IAED,MAAMC,oBAAmB,GAAI,MAAOjE,KAAK,IAAK;MAC5C,MAAMC,IAAG,GAAID,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAClC,IAAIF,IAAI,EAAE;QACR,MAAMG,MAAK,GAAI,IAAIC,UAAU,CAAC,CAAC;QAC/BD,MAAM,CAACE,MAAK,GAAI,MAAOC,CAAC,IAAK;UAC3B,MAAMS,eAAc,GAAI,MAAMrF,aAAa,CAAC4E,CAAC,CAACL,MAAM,CAACO,MAAM,CAAC;UAC5D9B,cAAc,CAACL,KAAK,CAACrB,KAAI,GAAI+D,eAAe;QAC9C,CAAC;QACDZ,MAAM,CAACM,aAAa,CAACT,IAAI,CAAC;MAC5B;IACF,CAAC;IAED,MAAMiE,mBAAkB,GAAI,MAAAA,CAAA,KAAY;MACtC,IAAI;QACF,IAAI,CAACvF,cAAc,CAACL,KAAK,CAACpB,EAAE,EAAE;UAC5ByB,cAAc,CAACL,KAAK,CAACpB,EAAC,GAAIsE,IAAI,CAACC,GAAG,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;QACpF;;QAEA;QACAlD,cAAc,CAACL,KAAK,CAACqB,SAAQ,GAAI,IAAI;QAErC,IAAIb,gBAAgB,CAACR,KAAK,EAAE;UAC1B,MAAMwD,KAAI,GAAIlD,gBAAgB,CAACN,KAAK,CAACyD,SAAS,CAACrC,IAAG,IAAKA,IAAI,CAACxC,EAAC,KAAMyB,cAAc,CAACL,KAAK,CAACpB,EAAE,CAAC;UAC3F,IAAI4E,KAAI,KAAM,CAAC,CAAC,EAAE;YAChBlD,gBAAgB,CAACN,KAAK,CAACwD,KAAK,IAAI;cAAE,GAAGnD,cAAc,CAACL;YAAM,CAAC;UAC7D;UACAQ,gBAAgB,CAACR,KAAI,GAAI,KAAK;UAC9BS,mBAAmB,CAACT,KAAI,GAAI,CAAC,CAAC;UAC9B,MAAMzC,KAAK,CAAC,uCAAuC,CAAC;QACtD,OAAO;UACL,MAAMmG,YAAW,GAAIpD,gBAAgB,CAACN,KAAK,CAAC2D,IAAI,CAACvC,IAAG,IAClDA,IAAI,CAAC5D,IAAI,CAACoG,WAAW,CAAC,MAAMvD,cAAc,CAACL,KAAK,CAACxC,IAAI,CAACoG,WAAW,CAAC,CACpE,CAAC;UAED,IAAIF,YAAY,EAAE;YAChB,MAAMnB,SAAQ,GAAI,MAAMjF,OAAO,CAC7B,wCAAwC+C,cAAc,CAACL,KAAK,CAACxC,IAAI,yBAAyB,EAC1F;cAAEqG,KAAK,EAAE;YAAsC,CACjD,CAAC;YAED,IAAItB,SAAS,EAAE;cACb,MAAMiB,KAAI,GAAIlD,gBAAgB,CAACN,KAAK,CAACyD,SAAS,CAACrC,IAAG,IAAKA,IAAI,CAACxC,EAAC,KAAM8E,YAAY,CAAC9E,EAAE,CAAC;cACnF,IAAI4E,KAAI,KAAM,CAAC,CAAC,EAAE;gBAChBnD,cAAc,CAACL,KAAK,CAACpB,EAAC,GAAI8E,YAAY,CAAC9E,EAAE;gBACzC0B,gBAAgB,CAACN,KAAK,CAACwD,KAAK,IAAI;kBAAE,GAAGnD,cAAc,CAACL;gBAAM,CAAC;gBAC3D,MAAMzC,KAAK,CAAC,uCAAuC,CAAC;cACtD;YACF,OAAO;cACL;YACF;UACF,OAAO;YACL+C,gBAAgB,CAACN,KAAK,CAAC8D,IAAI,CAAC;cAAE,GAAGzD,cAAc,CAACL;YAAM,CAAC,CAAC;YACxD,MAAMzC,KAAK,CAAC,kCAAkC,CAAC;UACjD;QACF;;QAEA;QACA,MAAMwG,QAAO,GAAI,CACf,GAAGlF,SAAS,CAACmB,KAAK,CAACmB,MAAM,CAACC,IAAG,IAAK,CAACA,IAAI,CAACC,SAAS,CAAC,EAClD,GAAGf,gBAAgB,CAACN,KAAI,CACzB;QAED,MAAMnD,aAAa,CAACkH,QAAQ,CAAC;QAC7B2B,oBAAoB,CAAC,CAAC;MACxB,EAAE,OAAO5F,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;QAC3D,MAAMvC,KAAK,CAAC,oEAAoE,CAAC;MACnF;IACF,CAAC;IAED,MAAMmI,oBAAmB,GAAIA,CAAA,KAAM;MACjCrF,cAAc,CAACL,KAAI,GAAI;QACrBxC,IAAI,EAAE,EAAE;QACRI,WAAW,EAAE,EAAE;QACfY,KAAK,EAAE,CAAC;QACRC,aAAa,EAAE,KAAK;QACpBC,iBAAiB,EAAE,CAAC;QACpBC,KAAK,EAAE,EAAE;QACTC,EAAE,EAAE;MACN,CAAC;MACD4B,gBAAgB,CAACR,KAAI,GAAI,KAAK;MAC9BS,mBAAmB,CAACT,KAAI,GAAI,CAAC,CAAC;IAChC,CAAC;IAED,MAAM6F,mBAAkB,GAAKrC,KAAK,IAAK;MACrCnD,cAAc,CAACL,KAAI,GAAI;QAAE,GAAGM,gBAAgB,CAACN,KAAK,CAACwD,KAAK;MAAE,CAAC;MAC3DhD,gBAAgB,CAACR,KAAI,GAAI,IAAI;MAC7BS,mBAAmB,CAACT,KAAI,GAAIwD,KAAK;MACjCjD,mBAAmB,CAACP,KAAI,GAAI,IAAI;IAClC,CAAC;IAED,MAAM8F,qBAAoB,GAAI,MAAOtC,KAAK,IAAK;MAC7C,MAAMjB,SAAQ,GAAI,MAAMjF,OAAO,CAAC,uDAAuD,EAAE;QACvFuG,KAAK,EAAE,yBAAyB;QAChCK,WAAW,EAAE,UAAU;QACvBC,UAAU,EAAE;MACd,CAAC,CAAC;MAEF,IAAI5B,SAAS,EAAE;QACb,IAAI;UACF,IAAIiB,KAAI,GAAI,KAAKA,KAAI,IAAKlD,gBAAgB,CAACN,KAAK,CAACiB,MAAM,EAAE;YACvDlB,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAE0D,KAAK,CAAC;YACpD,MAAMjG,KAAK,CAAC,8CAA8C,CAAC;YAC3D;UACF;UAEA,MAAM6D,IAAG,GAAId,gBAAgB,CAACN,KAAK,CAACwD,KAAK,CAAC;UAC1CzD,OAAO,CAACqE,GAAG,CAAC,qCAAqCZ,KAAK,YAAYpC,IAAI,CAAC5D,IAAI,QAAQ4D,IAAI,CAACxC,EAAE,EAAE,CAAC;UAE7F,IAAI,CAACwC,IAAI,EAAE;YACTrB,OAAO,CAACD,KAAK,CAAC,8DAA8D,EAAE0D,KAAK,CAAC;YACpF,MAAMjG,KAAK,CAAC,8CAA8C,CAAC;YAC3D;UACF;UAEA,MAAM8G,QAAO,GAAIjD,IAAI,CAAC5D,IAAG,IAAK,sBAAsB;UACpD,MAAM8G,WAAU,GAAI,IAAIpB,IAAI,CAAC,CAAC,CAACqB,WAAW,CAAC,CAAC;UAE5C,IAAI,CAACC,KAAK,CAACC,OAAO,CAACxF,SAAS,CAACe,KAAK,CAAC,EAAE;YACnCD,OAAO,CAAC2E,IAAI,CAAC,gEAAgE,CAAC;YAC9EzF,SAAS,CAACe,KAAI,GAAI,EAAE;UACtB;UAEA,MAAM2E,QAAO,GAAI1F,SAAS,CAACe,KAAK,CAAC2D,IAAI,CAACiB,IAAG,IACvCA,IAAG,IAAK,OAAOA,IAAG,KAAM,QAAO,IAAKA,IAAI,CAACpH,IAAG,KAAM6G,QACpD,CAAC;UAED,IAAIM,QAAQ,EAAE;YACZA,QAAQ,CAACE,QAAO,IAAK,CAAC;YACtB,IAAI,CAACF,QAAQ,CAACG,IAAG,IAAK,IAAI5B,IAAI,CAACoB,WAAW,IAAI,IAAIpB,IAAI,CAACyB,QAAQ,CAACG,IAAI,CAAC,EAAE;cACrEH,QAAQ,CAACG,IAAG,GAAIR,WAAW;YAC7B;UACF,OAAO;YACL,MAAMS,WAAU,GAAI;cAClBvH,IAAI,EAAE6G,QAAQ;cACdQ,QAAQ,EAAE,CAAC;cACXrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;cAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;cAC1CqG,IAAI,EAAER;YACR,CAAC;YAEDrF,SAAS,CAACe,KAAK,CAAC8D,IAAI,CAACiB,WAAW,CAAC;UACnC;UAEA,MAAMG,cAAa,GAAIjG,SAAS,CAACe,KAAK,CAACmF,GAAG,CAAC/D,IAAG,IAAK;YACjD,IAAI,CAACA,IAAG,IAAK,OAAOA,IAAG,KAAM,QAAQ,EAAE;cACrC,OAAO;gBACL5D,IAAI,EAAE,sBAAsB;gBAC5BqH,QAAQ,EAAE,CAAC;gBACXrG,KAAK,EAAE,CAAC;gBACRC,aAAa,EAAE,KAAK;gBACpBqG,IAAI,EAAER;cACR,CAAC;YACH;YAEA,OAAO;cACL9G,IAAI,EAAE4H,MAAM,CAAChE,IAAI,CAAC5D,IAAG,IAAK,sBAAsB,CAAC;cACjDqH,QAAQ,EAAEG,MAAM,CAAC5D,IAAI,CAACyD,QAAQ,KAAK,CAAC;cACpCrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;cAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;cAC1CqG,IAAI,EAAE1D,IAAI,CAAC0D,IAAG,IAAKR;YACrB,CAAC;UACH,CAAC,CAAC;UAEF,MAAMpH,aAAa,CAACgI,cAAc,CAAC;UAEnC,IAAI9D,IAAI,CAACxC,EAAE,EAAE;YACX,IAAI;cACFmB,OAAO,CAACqE,GAAG,CAAC,4CAA4ChD,IAAI,CAACxC,EAAE,EAAE,CAAC;cAClE,MAAMyG,YAAW,GAAI,MAAMlI,oBAAoB,CAACiE,IAAI,CAACxC,EAAE,CAAC;cACxDmB,OAAO,CAACqE,GAAG,CAAC,gCAAgCiB,YAAY,EAAE,CAAC;YAC7D,EAAE,OAAOC,WAAW,EAAE;cACpBvF,OAAO,CAACD,KAAK,CAAC,qCAAqC,EAAEwF,WAAW,CAAC;YACnE;UACF;UAEAhF,gBAAgB,CAACN,KAAK,CAACuF,MAAM,CAAC/B,KAAK,EAAE,CAAC,CAAC;UACvCvE,SAAS,CAACe,KAAI,GAAIkF,cAAc;;UAEhC;UACA,MAAMnB,QAAO,GAAI,CACf,GAAGlF,SAAS,CAACmB,KAAK,CAACmB,MAAM,CAACC,IAAG,IAAK,CAACA,IAAI,CAACC,SAAS,CAAC,EAClD,GAAGf,gBAAgB,CAACN,KAAI,CACzB;UAED,MAAMnD,aAAa,CAACkH,QAAQ,CAAC;UAE7BhE,OAAO,CAACqE,GAAG,CAAC,oDAAoD,CAAC;QAEnE,EAAE,OAAOtE,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;UAC5D,MAAMvC,KAAK,CAAC,qEAAqE,CAAC;QACpF;MACF;IACF,CAAC;IAED,MAAMwI,mBAAkB,GAAI,MAAOvC,KAAK,IAAK;MAC3C,IAAI;QACF,MAAMpC,IAAG,GAAId,gBAAgB,CAACN,KAAK,CAACwD,KAAK,CAAC;QAE1C,IAAIpC,IAAI,CAAC1C,iBAAgB,IAAK,CAAC,EAAE;UAC/B,MAAMnB,KAAK,CAAC,qDAAqD,CAAC;UAClE;QACF;QAEA6D,IAAI,CAAC1C,iBAAiB,EAAE;QAExB,MAAMiG,QAAO,GAAI1F,SAAS,CAACe,KAAK,CAAC2D,IAAI,CAACiB,IAAG,IAAKA,IAAI,CAACpH,IAAG,KAAM4D,IAAI,CAAC5D,IAAI,CAAC;QACtE,MAAM8G,WAAU,GAAI,IAAIpB,IAAI,CAAC,CAAC,CAACqB,WAAW,CAAC,CAAC;QAE5C,IAAII,QAAQ,EAAE;UACZA,QAAQ,CAACE,QAAO,IAAK,CAAC;UACtB,IAAI,CAACF,QAAQ,CAACG,IAAG,IAAK,IAAI5B,IAAI,CAACoB,WAAW,IAAI,IAAIpB,IAAI,CAACyB,QAAQ,CAACG,IAAI,CAAC,EAAE;YACrEH,QAAQ,CAACG,IAAG,GAAIR,WAAW;UAC7B;QACF,OAAO;UACL,MAAMS,WAAU,GAAI;YAClBvH,IAAI,EAAE4D,IAAI,CAAC5D,IAAG,IAAK,qBAAqB;YACxCqH,QAAQ,EAAE,CAAC;YACXrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;YAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;YAC1CqG,IAAI,EAAER;UACR,CAAC;UAEDrF,SAAS,CAACe,KAAK,CAAC8D,IAAI,CAACiB,WAAW,CAAC;QACnC;QAEA,MAAMG,cAAa,GAAIjG,SAAS,CAACe,KAAK,CAACmF,GAAG,CAAC/D,IAAG,KAAM;UAClD5D,IAAI,EAAE4H,MAAM,CAAChE,IAAI,CAAC5D,IAAG,IAAK,sBAAsB,CAAC;UACjDqH,QAAQ,EAAEG,MAAM,CAAC5D,IAAI,CAACyD,QAAQ,KAAK,CAAC;UACpCrG,KAAK,EAAEwG,MAAM,CAAC5D,IAAI,CAAC5C,KAAK,KAAK,CAAC;UAC9BC,aAAa,EAAEwG,OAAO,CAAC7D,IAAI,CAAC3C,aAAa,CAAC;UAC1CqG,IAAI,EAAE1D,IAAI,CAAC0D,IAAG,IAAKR;QACrB,CAAC,CAAC,CAAC;;QAEH;QACA,MAAMP,QAAO,GAAI,CACf,GAAGlF,SAAS,CAACmB,KAAK,CAACmB,MAAM,CAACC,IAAG,IAAK,CAACA,IAAI,CAACC,SAAS,CAAC,EAClD,GAAGf,gBAAgB,CAACN,KAAI,CACzB;QAED,MAAMnD,aAAa,CAACkH,QAAQ,CAAC;QAC7B,MAAM7G,aAAa,CAACgI,cAAc,CAAC;QAEnCjG,SAAS,CAACe,KAAI,GAAIkF,cAAc;QAEhC,MAAM3H,KAAK,CAAC,gCAAgC6D,IAAI,CAAC5D,IAAI,GAAG,CAAC;MAE3D,EAAE,OAAOsC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;QAC1D,MAAMvC,KAAK,CAAC,4DAA4D,CAAC;MAC3E;IACF,CAAC;;IAED;IACA,MAAMyI,eAAc,GAAI,MAAAA,CAAA,KAAY;MAClC,IAAI;QACF,MAAMzI,KAAK,CAAC,uCAAuC,CAAC;QAEpD,IAAIsB,SAAS,CAACmB,KAAK,CAACiB,MAAK,GAAI,EAAE,EAAE;UAC/B,MAAM1D,KAAK,CAAC,wFAAwF,CAAC;UACrG;QACF;QAEA,MAAM0I,YAAW,GAAIpH,SAAS,CAACmB,KAAK,CAACmF,GAAG,CAAC/D,IAAG,KAAM;UAChDxC,EAAE,EAAEwC,IAAI,CAACxC,EAAE;UACXpB,IAAI,EAAE4D,IAAI,CAAC5D,IAAI;UACfI,WAAW,EAAEwD,IAAI,CAACxD,WAAW;UAC7BY,KAAK,EAAE4C,IAAI,CAAC5C,KAAK;UACjBC,aAAa,EAAE2C,IAAI,CAAC3C,aAAa;UACjCE,KAAK,EAAEyC,IAAI,CAACzC;QACd,CAAC,CAAC,CAAC;QAEHoB,OAAO,CAACqE,GAAG,CAAC,6BAA6B6B,YAAY,CAAChF,MAAM,eAAe,CAAC;QAE5E,MAAMiF,MAAK,GAAI,MAAM5J,QAAQ,CAAC2J,YAAY,CAAC;QAC3C,MAAME,GAAE,GAAI,GAAGC,MAAM,CAACC,QAAQ,CAACC,MAAM,SAASJ,MAAM,EAAE;QACtD5G,SAAS,CAACU,KAAI,GAAImG,GAAG;QAErB,MAAMxG,OAAM,GAAIpD,sBAAsB,CAAC4J,GAAG,EAAExI,YAAY,CAACqC,KAAK,CAACxC,IAAI,CAAC;QACpE,MAAM+I,WAAU,GAAI,sCAAsCC,kBAAkB,CAAC7G,OAAO,CAAC,EAAE;QACvFyG,MAAM,CAACK,IAAI,CAACF,WAAW,EAAE,QAAQ,CAAC;MACpC,EAAE,OAAOzG,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;QACxD,MAAMvC,KAAK,CAAC,+BAA+BuC,KAAK,CAACH,OAAM,IAAK,mBAAmB,kFAAkF,CAAC;MACpK;IACF,CAAC;IAED,MAAM+G,QAAO,GAAI,MAAAA,CAAA,KAAY;MAC3B,IAAI;QACF,MAAMC,cAAa,GAAI,uCAAuC;QAC9DpH,iBAAiB,CAACS,KAAI,GAAI,IAAI;QAE9B,IAAInB,SAAS,CAACmB,KAAK,CAACiB,MAAK,GAAI,EAAE,EAAE;UAC/B,MAAM1D,KAAK,CAAC,wFAAwF,CAAC;UACrGgC,iBAAiB,CAACS,KAAI,GAAI,KAAK;UAC/B;QACF;QAEA,MAAMiG,YAAW,GAAIpH,SAAS,CAACmB,KAAK,CAACmF,GAAG,CAAC/D,IAAG,KAAM;UAChDxC,EAAE,EAAEwC,IAAI,CAACxC,EAAE;UACXpB,IAAI,EAAE4D,IAAI,CAAC5D,IAAI;UACfI,WAAW,EAAEwD,IAAI,CAACxD,WAAW;UAC7BY,KAAK,EAAE4C,IAAI,CAAC5C,KAAK;UACjBC,aAAa,EAAE2C,IAAI,CAAC3C,aAAa;UACjCE,KAAK,EAAEyC,IAAI,CAACzC;QACd,CAAC,CAAC,CAAC;QAEH,MAAMuH,MAAK,GAAI,MAAM5J,QAAQ,CAAC2J,YAAY,CAAC;QAC3C,MAAME,GAAE,GAAI,GAAGC,MAAM,CAACC,QAAQ,CAACC,MAAM,SAASJ,MAAM,EAAE;QACtD5G,SAAS,CAACU,KAAI,GAAImG,GAAG;QAErB,IAAI;UACF,MAAMS,SAAS,CAACC,SAAS,CAACC,SAAS,CAACX,GAAG,CAAC;UACxC5G,iBAAiB,CAACS,KAAI,GAAI,IAAI;UAC9BuB,UAAU,CAAC,MAAM;YACfhC,iBAAiB,CAACS,KAAI,GAAI,KAAK;UACjC,CAAC,EAAE,IAAI,CAAC;QACV,EAAE,OAAO+G,cAAc,EAAE;UACvBhH,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEiH,cAAc,CAAC;UACjE,MAAMxJ,KAAK,CAAC,+EAA8E,GAAI4I,GAAG,CAAC;QACpG;MACF,EAAE,OAAOrG,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,yCAAyC,EAAEA,KAAK,CAAC;QAC/DP,iBAAiB,CAACS,KAAI,GAAI,KAAK;QAC/B,MAAMzC,KAAK,CAAC,+BAA+BuC,KAAK,CAACH,OAAM,IAAK,mBAAmB,kFAAkF,CAAC;MACpK;IACF,CAAC;;IAED;IACA,MAAMqH,UAAS,GAAI5K,QAAQ,CAAC,MAAM;MAChC,OAAO6C,SAAS,CAACe,KAAK,CAACiH,MAAM,CAAC,CAACC,KAAK,EAAE9F,IAAI,KAAK;QAC7C,OAAO8F,KAAI,GAAK9F,IAAI,CAACyD,QAAO,GAAIzD,IAAI,CAAC5C,KAAM;MAC7C,CAAC,EAAE,CAAC,CAAC;IACP,CAAC,CAAC;IAEF,MAAM2I,WAAU,GAAK3I,KAAK,IAAK;MAC7B,IAAI4I,KAAK,CAACpC,MAAM,CAACxG,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM;MACvC,MAAM6I,KAAI,GAAIrC,MAAM,CAACxG,KAAK,CAAC,CAAC8I,OAAO,CAAC,CAAC,CAAC;MACtC,MAAM,CAACC,OAAO,EAAEC,OAAO,IAAIH,KAAK,CAACI,KAAK,CAAC,GAAG,CAAC;MAC3C,MAAMC,gBAAe,GAAIH,OAAO,CAACI,OAAO,CAAC,uBAAuB,EAAE,GAAG,CAAC;MACtE,OAAO,GAAGD,gBAAgB,IAAIF,OAAO,EAAE;IACzC,CAAC;IAED,MAAMI,UAAS,GAAKC,OAAO,IAAK;MAC9B,IAAI,CAACA,OAAO,EAAE,OAAO,KAAK;MAC1B,MAAM/C,IAAG,GAAI,IAAI5B,IAAI,CAAC2E,OAAO,CAAC;MAC9B,IAAIT,KAAK,CAACtC,IAAI,CAACgD,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,gBAAgB;MAClD,OAAO,IAAIC,IAAI,CAACC,cAAc,CAAC,OAAO,EAAE;QACtCC,GAAG,EAAE,SAAS;QACdC,KAAK,EAAE,SAAS;QAChBC,IAAI,EAAE,SAAS;QACfC,IAAI,EAAE,SAAS;QACfC,MAAM,EAAE;MACV,CAAC,CAAC,CAACC,MAAM,CAACxD,IAAI,CAAC;IACjB,CAAC;IAED,MAAMyD,iBAAgB,GAAInM,QAAQ,CAAC,MAAM;MACvC,IAAIoM,KAAI,GAAIvJ,SAAS,CAACe,KAAK;MAC3B,IAAI,CAACwE,KAAK,CAACC,OAAO,CAAC+D,KAAK,CAAC,EAAE;QACzBzI,OAAO,CAAC2E,IAAI,CAAC,oDAAoD,CAAC;QAClE,OAAO,EAAE;MACX;MACA,IAAIxF,UAAU,CAACc,KAAK,EAAE;QACpB,MAAMyI,IAAG,GAAIvJ,UAAU,CAACc,KAAK,CAAC4D,WAAW,CAAC,CAAC;QAC3C4E,KAAI,GAAIA,KAAK,CAACrH,MAAM,CAACC,IAAG,IAAK;UAC3B,OAAOA,IAAG,IAAKA,IAAI,CAAC5D,IAAG,IAAK,OAAO4D,IAAI,CAAC5D,IAAG,KAAM,QAAO,IACjD4D,IAAI,CAAC5D,IAAI,CAACoG,WAAW,CAAC,CAAC,CAAC8E,QAAQ,CAACD,IAAI,CAAC;QAC/C,CAAC,CAAC;MACJ;MACA,IAAIrJ,cAAc,CAACY,KAAK,EAAE;QACxB,IAAIZ,cAAc,CAACY,KAAI,KAAM,QAAQ,EAAE;UACrCwI,KAAI,GAAIA,KAAK,CAACrH,MAAM,CAACC,IAAG,IAAK6D,OAAO,CAAC7D,IAAG,IAAKA,IAAI,CAAC3C,aAAa,CAAC,CAAC;QACnE,OAAO,IAAIW,cAAc,CAACY,KAAI,KAAM,UAAU,EAAE;UAC9CwI,KAAI,GAAIA,KAAK,CAACrH,MAAM,CAACC,IAAG,IAAKA,IAAG,IAAKA,IAAI,CAAC3C,aAAY,KAAM,KAAK,CAAC;QACpE;MACF;MACA,IAAIU,MAAM,CAACa,KAAK,EAAE;QAChBwI,KAAI,GAAI,CAAC,GAAGA,KAAK,CAAC;QAClB,QAAQrJ,MAAM,CAACa,KAAK;UAClB,KAAK,MAAM;YACTwI,KAAK,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;cACnB,IAAI,CAACD,CAAA,IAAK,CAACA,CAAC,CAACpL,IAAI,EAAE,OAAO,CAAC;cAC3B,IAAI,CAACqL,CAAA,IAAK,CAACA,CAAC,CAACrL,IAAI,EAAE,OAAO,CAAC,CAAC;cAC5B,OAAOoL,CAAC,CAACpL,IAAI,CAACsL,aAAa,CAACD,CAAC,CAACrL,IAAI,CAAC;YACrC,CAAC,CAAC;YACF;UACF,KAAK,eAAe;YAClBgL,KAAK,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;cACnB,MAAME,IAAG,GAAKH,CAAA,IAAK,OAAOA,CAAC,CAAC/D,QAAO,KAAM,QAAQ,GAAI+D,CAAC,CAAC/D,QAAO,GAAI,CAAC;cACnE,MAAMmE,IAAG,GAAKH,CAAA,IAAK,OAAOA,CAAC,CAAChE,QAAO,KAAM,QAAQ,GAAIgE,CAAC,CAAChE,QAAO,GAAI,CAAC;cACnE,OAAOmE,IAAG,GAAID,IAAI;YACpB,CAAC,CAAC;YACF;UACF,KAAK,cAAc;YACjBP,KAAK,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;cACnB,MAAME,IAAG,GAAKH,CAAA,IAAK,OAAOA,CAAC,CAAC/D,QAAO,KAAM,QAAQ,GAAI+D,CAAC,CAAC/D,QAAO,GAAI,CAAC;cACnE,MAAMmE,IAAG,GAAKH,CAAA,IAAK,OAAOA,CAAC,CAAChE,QAAO,KAAM,QAAQ,GAAIgE,CAAC,CAAChE,QAAO,GAAI,CAAC;cACnE,OAAOkE,IAAG,GAAIC,IAAI;YACpB,CAAC,CAAC;YACF;UACF,KAAK,YAAY;YACfR,KAAK,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;cACnB,MAAMI,MAAK,GAAKL,CAAA,IAAK,OAAOA,CAAC,CAACpK,KAAI,KAAM,QAAQ,GAAIoK,CAAC,CAACpK,KAAI,GAAI,CAAC;cAC/D,MAAM0K,MAAK,GAAKL,CAAA,IAAK,OAAOA,CAAC,CAACrK,KAAI,KAAM,QAAQ,GAAIqK,CAAC,CAACrK,KAAI,GAAI,CAAC;cAC/D,OAAO0K,MAAK,GAAID,MAAM;YACxB,CAAC,CAAC;YACF;UACF,KAAK,WAAW;YACdT,KAAK,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;cACnB,MAAMI,MAAK,GAAKL,CAAA,IAAK,OAAOA,CAAC,CAACpK,KAAI,KAAM,QAAQ,GAAIoK,CAAC,CAACpK,KAAI,GAAI,CAAC;cAC/D,MAAM0K,MAAK,GAAKL,CAAA,IAAK,OAAOA,CAAC,CAACrK,KAAI,KAAM,QAAQ,GAAIqK,CAAC,CAACrK,KAAI,GAAI,CAAC;cAC/D,OAAOyK,MAAK,GAAIC,MAAM;YACxB,CAAC,CAAC;YACF;UACF,KAAK,WAAW;YACdV,KAAK,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;cACnB,MAAMM,KAAI,GAAIP,CAAA,IAAKA,CAAC,CAAC9D,IAAG,GAAI,IAAI5B,IAAI,CAAC0F,CAAC,CAAC9D,IAAI,IAAI,IAAI5B,IAAI,CAAC,CAAC,CAAC;cAC1D,MAAMkG,KAAI,GAAIP,CAAA,IAAKA,CAAC,CAAC/D,IAAG,GAAI,IAAI5B,IAAI,CAAC2F,CAAC,CAAC/D,IAAI,IAAI,IAAI5B,IAAI,CAAC,CAAC,CAAC;cAC1D,OAAOkG,KAAI,GAAID,KAAK;YACtB,CAAC,CAAC;YACF;UACF,KAAK,UAAU;YACbX,KAAK,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;cACnB,MAAMM,KAAI,GAAIP,CAAA,IAAKA,CAAC,CAAC9D,IAAG,GAAI,IAAI5B,IAAI,CAAC0F,CAAC,CAAC9D,IAAI,IAAI,IAAI5B,IAAI,CAAC,CAAC,CAAC;cAC1D,MAAMkG,KAAI,GAAIP,CAAA,IAAKA,CAAC,CAAC/D,IAAG,GAAI,IAAI5B,IAAI,CAAC2F,CAAC,CAAC/D,IAAI,IAAI,IAAI5B,IAAI,CAAC,CAAC,CAAC;cAC1D,OAAOiG,KAAI,GAAIC,KAAK;YACtB,CAAC,CAAC;YACF;UACF;YACE;QACJ;MACF;MACA,OAAOZ,KAAK;IACd,CAAC,CAAC;IAEF,MAAMa,aAAY,GAAIA,CAAA,KAAM;MAC1B;MACA,MAAMC,IAAG,GAAI,CACX,CAAC,kBAAkB,EAAE,WAAW,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,gBAAgB,EAAE,UAAU,CAAC,EACxG,GAAGf,iBAAiB,CAACvI,KAAK,CAACmF,GAAG,CAAC/D,IAAG,IAAK,CACrCA,IAAI,CAAC5D,IAAI,EACT4D,IAAI,CAAC3C,aAAY,GAAI,cAAa,GAAI,cAAc,EACpD2C,IAAI,CAACyD,QAAQ,EACb,IAAIsC,WAAW,CAAC/F,IAAI,CAAC5C,KAAK,CAAC,EAAE,EAC7BoJ,UAAU,CAACxG,IAAI,CAAC0D,IAAI,CAAC,EACrB,IAAIqC,WAAW,CAAC/F,IAAI,CAACyD,QAAO,GAAIzD,IAAI,CAAC5C,KAAK,CAAC,EAAC,CAC7C,CAAC,EACF,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI2I,WAAW,CAACH,UAAU,CAAChH,KAAK,CAAC,EAAE,EAC9D;;MAED;MACA,MAAMuJ,EAAC,GAAI7M,IAAI,CAAC8M,KAAK,CAACC,YAAY,CAACH,IAAI,CAAC;MACxC,MAAMI,EAAC,GAAIhN,IAAI,CAAC8M,KAAK,CAACG,QAAQ,CAAC,CAAC;MAChCjN,IAAI,CAAC8M,KAAK,CAACI,iBAAiB,CAACF,EAAE,EAAEH,EAAE,EAAE,QAAQ,CAAC;;MAE9C;MACA,MAAMM,WAAU,GAAInN,IAAI,CAACoN,KAAK,CAACJ,EAAE,EAAE;QAAEK,QAAQ,EAAE,MAAM;QAAE5J,IAAI,EAAE;MAAQ,CAAC,CAAC;MACvE,MAAM6J,IAAG,GAAI,IAAIC,IAAI,CAAC,CAACJ,WAAW,CAAC,EAAE;QAAE1J,IAAI,EAAE;MAAoE,CAAC,CAAC;MACnH1D,MAAM,CAACuN,IAAI,EAAE,UAAU,IAAI9G,IAAI,CAAC,CAAC,CAACgH,kBAAkB,CAAC,CAAC,OAAO,CAAC;IAChE,CAAC;IAED,MAAMC,WAAU,GAAIA,CAAA,KAAM;MACxB;MACA,MAAMC,GAAE,GAAI,IAAIzN,KAAK,CAAC,CAAC;;MAEvB;MACAyN,GAAG,CAACC,WAAW,CAAC,EAAE,CAAC;MACnBD,GAAG,CAACE,IAAI,CAAC,mBAAmB,EAAE,EAAE,EAAE,EAAE,CAAC;MACrCF,GAAG,CAACC,WAAW,CAAC,EAAE,CAAC;MACnBD,GAAG,CAACE,IAAI,CAAC,UAAU,IAAIpH,IAAI,CAAC,CAAC,CAACgH,kBAAkB,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;;MAE7D;MACA,MAAMK,SAAQ,GAAIhC,iBAAiB,CAACvI,KAAK,CAACmF,GAAG,CAAC/D,IAAG,IAAK,CACpDA,IAAI,CAAC5D,IAAI,EACT4D,IAAI,CAAC3C,aAAY,GAAI,cAAa,GAAI,cAAc,EACpD2C,IAAI,CAACyD,QAAQ,EACb,IAAIsC,WAAW,CAAC/F,IAAI,CAAC5C,KAAK,CAAC,EAAE,EAC7BoJ,UAAU,CAACxG,IAAI,CAAC0D,IAAI,CAAC,EACrB,IAAIqC,WAAW,CAAC/F,IAAI,CAACyD,QAAO,GAAIzD,IAAI,CAAC5C,KAAK,CAAC,EAAC,CAC7C,CAAC;;MAEF;MACA4L,GAAG,CAACI,SAAS,CAAC;QACZC,IAAI,EAAE,CAAC,CAAC,kBAAkB,EAAE,WAAW,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,gBAAgB,EAAE,UAAU,CAAC,CAAC;QAChHC,IAAI,EAAEH,SAAS;QACfI,IAAI,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,IAAIxD,WAAW,CAACH,UAAU,CAAChH,KAAK,CAAC,EAAE,CAAC,CAAC;QACtE4K,MAAM,EAAE,EAAE;QACVC,KAAK,EAAE,SAAS;QAChBC,UAAU,EAAE;UAAEC,SAAS,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE;QAAE,CAAC;QACxCC,UAAU,EAAE;UAAED,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;UAAEE,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;UAAEC,SAAS,EAAE;QAAO;MACpF,CAAC,CAAC;;MAEF;MACAd,GAAG,CAACe,IAAI,CAAC,UAAU,IAAIjI,IAAI,CAAC,CAAC,CAACgH,kBAAkB,CAAC,CAAC,MAAM,CAAC;IAC3D,CAAC;IAED,MAAMkB,gBAAe,GAAKC,KAAK,IAAK;MAClC,OAAO,CAAC,GAAG,IAAIC,GAAG,CAACD,KAAK,CAAC,CAAC;IAC5B,CAAC;IAED,OAAO;MACL1N,YAAY;MACZK,gBAAgB;MAChBwD,kBAAkB;MAClBC,YAAY;MACZ1E,gBAAgB;MAChBuF,iBAAiB;MACjBrE,WAAW;MACXK,eAAe;MACfkE,iBAAiB;MACjBC,eAAe;MACfE,kBAAkB;MAClBC,eAAe;MACfC,gBAAgB;MAChBtE,OAAO;MACPM,SAAS;MACTC,YAAY;MACZC,SAAS;MACT+D,cAAc;MACdE,aAAa;MACbC,YAAY;MACZe,YAAY;MACZC,cAAc;MACduB,YAAY;MACZzC,aAAa;MACb9D,SAAS;MACT+H,UAAU;MACV9H,UAAU;MACVC,MAAM;MACNC,cAAc;MACdmJ,iBAAiB;MACjBpB,WAAW;MACX9H,iBAAiB;MACjBgK,aAAa;MACbc,WAAW;MACX7K,SAAS;MACTC,iBAAiB;MACjByG,eAAe;MACfU,QAAQ;MACRlH,eAAe;MACf4L,gBAAgB;MAChBxL,UAAU;MACVC,gBAAgB;MAChBI,YAAY;MACZ2H,UAAU;MACVvH,cAAc;MACdC,gBAAgB;MAChBC,mBAAmB;MACnBC,gBAAgB;MAChBC,mBAAmB;MACnBgF,qBAAqB;MACrBE,oBAAoB;MACpBC,mBAAmB;MACnBF,oBAAoB;MACpBG,mBAAmB;MACnBC,qBAAqB;MACrBC;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}